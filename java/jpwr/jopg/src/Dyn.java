/* 
 * ProviewR   Open Source Process Control.
 * Copyright (C) 2005-2021 SSAB EMEA AB.
 *
 * This file is part of ProviewR.
 *
 * This program is free software; you can redistribute it and/or 
 * modify it under the terms of the GNU General Public License as 
 * published by the Free Software Foundation, either version 2 of 
 * the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful 
 * but WITHOUT ANY WARRANTY; without even the implied warranty of 
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the 
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License 
 * along with ProviewR. If not, see <http://www.gnu.org/licenses/>
 *
 * Linking ProviewR statically or dynamically with other modules is
 * making a combined work based on ProviewR. Thus, the terms and
 * conditions of the GNU General Public License cover the whole 
 * combination.
 *
 * In addition, as a special exception, the copyright holders of
 * ProviewR give you permission to, from the build function in the
 * ProviewR Configurator, combine ProviewR with modules generated by the
 * ProviewR PLC Editor to a PLC program, regardless of the license
 * terms of these modules. You may copy and distribute the resulting
 * combined work under the terms of your choice, provided that every 
 * copy of the combined work is accompanied by a complete copy of 
 * the source code of ProviewR (the version used to produce the
 * combined work), being distributed under the terms of the GNU 
 * General Public License plus this exception.
 */


package jpwr.jopg;
import jpwr.rt.*;
import java.io.*;
import java.util.*;

public class Dyn {

    public static final int DYN__NO_PROPAGATE			= 20001;
    public static final int eValueInput_Success			= 0;
    public static final int eValueInput_Error			= 1;
    public static final int eValueInput_SyntaxError	       	= 2;
    public static final int eValueInput_MinValueExceeded       	= 3;
    public static final int eValueInput_MaxValueExceeded       	= 4;

    public static final int eCurveDataType_XYArrays    		= 0;
    public static final int eCurveDataType_PointArray  		= 1;
    public static final int eCurveDataType_TableObject  	= 2;

    public static final int mInstance_1				= 1 << 0;
    public static final int mInstance_2				= 1 << 1;
    public static final int mInstance_3				= 1 << 2;
    public static final int mInstance_4				= 1 << 3;
    public static final int mInstance_5				= 1 << 4;
    public static final int mInstance_6				= 1 << 5;
    public static final int mInstance_7				= 1 << 6;
    public static final int mInstance_8				= 1 << 7;
    public static final int mInstance_9				= 1 << 8;
    public static final int mInstance_10			= 1 << 9;
    public static final int mInstance_11			= 1 << 10;
    public static final int mInstance_12			= 1 << 11;
    public static final int mInstance_13			= 1 << 12;
    public static final int mInstance_14			= 1 << 13;
    public static final int mInstance_15			= 1 << 14;
    public static final int mInstance_16			= 1 << 15;
    public static final int mInstance_17			= 1 << 16;
    public static final int mInstance_18			= 1 << 17;
    public static final int mInstance_19			= 1 << 18;
    public static final int mInstance_20			= 1 << 19;
    public static final int mInstance_21			= 1 << 20;
    public static final int mInstance_22			= 1 << 21;
    public static final int mInstance_23			= 1 << 22;
    public static final int mInstance_24			= 1 << 23;
    public static final int mInstance_25			= 1 << 24;
    public static final int mInstance_26			= 1 << 25;
    public static final int mInstance_27			= 1 << 26;
    public static final int mInstance_28			= 1 << 27;
    public static final int mInstance_29			= 1 << 28;
    public static final int mInstance_30			= 1 << 29;
    public static final int mInstance_31			= 1 << 30;
    public static final int mInstance_32			= 1 << 31;

    public static final int mDynType1_No			= 0;
    public static final int mDynType1_Inherit      		= 1 << 0;
    public static final int mDynType1_Tone			= 1 << 1;
    public static final int mDynType1_DigLowColor		= 1 << 2;
    public static final int mDynType1_DigColor      		= 1 << 3;
    public static final int mDynType1_DigError      		= 1 << 4;
    public static final int mDynType1_DigWarning		= 1 << 5;
    public static final int mDynType1_DigFlash      		= 1 << 6;
    public static final int mDynType1_Invisible 		= 1 << 7;
    public static final int mDynType1_DigBorder     		= 1 << 8;
    public static final int mDynType1_DigText        		= 1 << 9;
    public static final int mDynType1_Value			= 1 << 10;
    public static final int mDynType1_AnalogColor		= 1 << 11;
    public static final int mDynType1_Rotate			= 1 << 12;
    public static final int mDynType1_Move			= 1 << 13;
    public static final int mDynType1_AnalogShift		= 1 << 14;
    public static final int mDynType1_DigShift      		= 1 << 15;
    public static final int mDynType1_Animation     		= 1 << 16;
    public static final int mDynType1_Bar			= 1 << 17;
    public static final int mDynType1_Trend			= 1 << 18;
    public static final int mDynType1_SliderBackground 		= 1 << 19;
    public static final int mDynType1_Video			= 1 << 20;
    public static final int mDynType1_FillLevel			= 1 << 21;
    public static final int mDynType1_FastCurve			= 1 << 22;
    public static final int mDynType1_AnalogText	       	= 1 << 23;
    public static final int mDynType1_Table			= 1 << 24;
    public static final int mDynType1_StatusColor   		= 1 << 25;
    public static final int mDynType1_HostObject    		= 1 << 26;
    public static final int mDynType1_DigSound    		= 1 << 27;
    public static final int mDynType1_XY_Curve    		= 1 << 28;
    public static final int mDynType1_DigCommand    		= 1 << 29;
    public static final int mDynType1_Pie	    		= 1 << 30;
    public static final int mDynType1_BarChart      		= 1 << 31;

    public static final int mDynType2_No			= 0;
    public static final int mDynType2_Axis			= 1 << 0;
    public static final int mDynType2_DigTextColor     		= 1 << 1;
    public static final int mDynType2_TimeoutColor     		= 1 << 2;
    public static final int mDynType2_DigFourShift     		= 1 << 3;
    public static final int mDynType2_ScrollingText            	= 1 << 4;
    public static final int mDynType2_ColorThemeLightness       = 1 << 5;
    public static final int mDynType2_DigBackgroundColor        = 1 << 6;
    public static final int mDynType2_DigSwap		        = 1 << 7;
    public static final int mDynType2_DigScript		        = 1 << 8;
    public static final int mDynType2_RefUpdate		        = 1 << 9;

    public static final int mActionType1_No			= 0;
    public static final int mActionType1_Inherit		= 1 << 0;
    public static final int mActionType1_PopupMenu   		= 1 << 1;
    public static final int mActionType1_SetDig     		= 1 << 2;
    public static final int mActionType1_ResetDig		= 1 << 3;
    public static final int mActionType1_ToggleDig   		= 1 << 4;
    public static final int mActionType1_StoDig     		= 1 << 5;
    public static final int mActionType1_Command		= 1 << 6;
    public static final int mActionType1_CommandDoubleClick 	= 1 << 7;
    public static final int mActionType1_Confirm		= 1 << 8;
    public static final int mActionType1_IncrAnalog		= 1 << 9;
    public static final int mActionType1_RadioButton		= 1 << 10;
    public static final int mActionType1_Slider     		= 1 << 11;
    public static final int mActionType1_ValueInput  		= 1 << 12;
    public static final int mActionType1_TipText    		= 1 << 13;
    public static final int mActionType1_Help       		= 1 << 14;
    public static final int mActionType1_OpenGraph		= 1 << 15;
    public static final int mActionType1_OpenURL		= 1 << 16;
    public static final int mActionType1_InputFocus		= 1 << 17;
    public static final int mActionType1_CloseGraph		= 1 << 18;
    public static final int mActionType1_PulldownMenu 		= 1 << 19;
    public static final int mActionType1_OptionMenu 		= 1 << 20;
    public static final int mActionType1_SetValue 		= 1 << 21;
    public static final int mActionType1_MethodToolbar 		= 1 << 22;
    public static final int mActionType1_MethodPulldownMenu    	= 1 << 23;
    public static final int mActionType1_Script		    	= 1 << 24;
    public static final int mActionType1_CatchSignal	     	= 1 << 25;
    public static final int mActionType1_EmitSignal        	= 1 << 26;

    public static final int mActionType2_No			= 0;
    
  //! Priority order for dyntypes and actiontypes. Lower value gives higher priority.
    public static final int eDynPrio_RefUpdate		       	= 0;
    public static final int eDynPrio_DigSound			= 1;
    public static final int eDynPrio_HostObject			= 2;
    public static final int eDynPrio_Invisible			= 3;
    public static final int eDynPrio_DigFlash			= 4;
    public static final int eDynPrio_TimeoutColor	       	= 5;
    public static final int eDynPrio_DigError			= 6;
    public static final int eDynPrio_DigWarning			= 7;
    public static final int eDynPrio_AnalogColor	       	= 8;
    public static final int eDynPrio_DigColor			= 9;
    public static final int eDynPrio_DigLowColor	       	= 10;
    public static final int eDynPrio_DigBackgroundColor	       	= 11;
    public static final int eDynPrio_DigTextColor	       	= 12;
    public static final int eDynPrio_DigBorder			= 13;
    public static final int eDynPrio_DigText			= 14;
    public static final int eDynPrio_FillLevel			= 15;
    public static final int eDynPrio_Value			= 16;
    public static final int eDynPrio_ValueInput			= 17;
    public static final int eDynPrio_Rotate			= 18;
    public static final int eDynPrio_Move			= 19;
    public static final int eDynPrio_AnalogShift	       	= 20;
    public static final int eDynPrio_DigShift			= 21;
    public static final int eDynPrio_DigFourShift	       	= 22;
    public static final int eDynPrio_Animation			= 23;
    public static final int eDynPrio_Bar			= 24;
    public static final int eDynPrio_Trend			= 25;
    public static final int eDynPrio_FastCurve			= 26;
    public static final int eDynPrio_XY_Curve			= 27;
    public static final int eDynPrio_AnalogText			= 28;
    public static final int eDynPrio_Table			= 29;
    public static final int eDynPrio_SliderBackground	       	= 30;
    public static final int eDynPrio_Video			= 31;
    public static final int eDynPrio_StatusColor	       	= 32;
    public static final int eDynPrio_PopupMenu			= 33;
    public static final int eDynPrio_Confirm			= 34;
    public static final int eDynPrio_SetDig			= 35;
    public static final int eDynPrio_ResetDig			= 36;
    public static final int eDynPrio_ToggleDig			= 37;
    public static final int eDynPrio_StoDig			= 38;
    public static final int eDynPrio_Help			= 39;
    public static final int eDynPrio_OpenGraph			= 40;
    public static final int eDynPrio_OpenURL			= 41;
    public static final int eDynPrio_CommandDoubleClick	       	= 42;
    public static final int eDynPrio_IncrAnalog			= 43;
    public static final int eDynPrio_RadioButton	       	= 44;
    public static final int eDynPrio_Slider			= 45;
    public static final int eDynPrio_TipText			= 46;
    public static final int eDynPrio_PulldownMenu	       	= 47;
    public static final int eDynPrio_OptionMenu			= 48;
    public static final int eDynPrio_InputFocus			= 49;
    public static final int eDynPrio_DigCommand			= 50;
    public static final int eDynPrio_SetValue			= 51;
    public static final int eDynPrio_Pie			= 52;
    public static final int eDynPrio_BarChart			= 53;
    public static final int eDynPrio_Axis			= 54;
    public static final int eDynPrio_MethodToolbar	       	= 55;
    public static final int eDynPrio_MethodPulldownMenu	       	= 56;
    public static final int eDynPrio_ScrollingText	       	= 57;
    public static final int eDynPrio_ColorThemeLightness       	= 58;
    public static final int eDynPrio_DigSwap		       	= 59;
    public static final int eDynPrio_DigScript		       	= 60;
    public static final int eDynPrio_CatchSignal           	= 61;
    public static final int eDynPrio_EmitSignal     	       	= 62;
    public static final int eDynPrio_Script  			= 9998;
    public static final int eDynPrio_Command  			= 9999;
    public static final int eDynPrio_CloseGraph 		= 10000;

    public static final int eSave_Dyn		       		= 1;
    public static final int eSave_DigLowColor	       		= 2;
    public static final int eSave_DigColor	       		= 3;
    public static final int eSave_DigError	       		= 7;
    public static final int eSave_DigWarning	       		= 8;
    public static final int eSave_Invisible	       		= 9;
    public static final int eSave_DigBorder	       		= 10;
    public static final int eSave_DigText	       		= 11;
    public static final int eSave_Value				= 12;
    public static final int eSave_ValueInput	       		= 13;
    public static final int eSave_Rotate	       		= 14;
    public static final int eSave_Move		       		= 15;
    public static final int eSave_AnalogShift	       		= 17;
    public static final int eSave_DigShift	       		= 18;
    public static final int eSave_Animation	       		= 19;
    public static final int eSave_Bar		       		= 22;
    public static final int eSave_Trend				= 23;
    public static final int eSave_SliderBackground     		= 24;
    public static final int eSave_Video				= 25;
    public static final int eSave_DigFlash	       		= 26;
    public static final int eSave_FillLevel	       		= 27;
    public static final int eSave_FastCurve   			= 28;
    public static final int eSave_AnalogText	    		= 29;
    public static final int eSave_Table	       			= 30;
    public static final int eSave_StatusColor         		= 31;
    public static final int eSave_HostObject         		= 32;
    public static final int eSave_DigSound	      		= 33;
    public static final int eSave_XY_Curve	      		= 34;
    public static final int eSave_DigCommand	       		= 35;
    public static final int eSave_Pie	             		= 36;
    public static final int eSave_BarChart	       		= 37;
    public static final int eSave_Axis	             		= 38;
    public static final int eSave_DigTextColor	             	= 39;
    public static final int eSave_TimeoutColor	             	= 40;
    public static final int eSave_DigFourShift	             	= 41;
    public static final int eSave_ScrollingText             	= 42;
    public static final int eSave_ColorThemeLightness        	= 43;
    public static final int eSave_DigBackgroundColor        	= 44;
    public static final int eSave_DigSwap	        	= 45;
    public static final int eSave_DigScript	        	= 46;
    public static final int eSave_RefUpdate	        	= 47;
    public static final int eSave_PopupMenu	       		= 50;
    public static final int eSave_SetDig	       		= 51;
    public static final int eSave_ResetDig	       		= 52;
    public static final int eSave_ToggleDig	       		= 53;
    public static final int eSave_StoDig	       		= 54;
    public static final int eSave_Command	       		= 55;
    public static final int eSave_CommandDC	       		= 56;
    public static final int eSave_Confirm	       		= 57;
    public static final int eSave_IncrAnalog	       		= 58;
    public static final int eSave_RadioButton	       		= 59;
    public static final int eSave_Slider	       		= 60;
    public static final int eSave_AnalogColor	       		= 61;
    public static final int eSave_TipText	       		= 62;
    public static final int eSave_Help		       		= 63;
    public static final int eSave_OpenGraph	       		= 64;
    public static final int eSave_OpenURL	       		= 65;
    public static final int eSave_InputFocus	       		= 66;
    public static final int eSave_CloseGraph	       		= 67;
    public static final int eSave_PulldownMenu         		= 68;
    public static final int eSave_OptionMenu           		= 69;
    public static final int eSave_SetValue	       		= 70;
    public static final int eSave_MethodToolbar	       		= 71;
    public static final int eSave_MethodPulldownMenu	       	= 72;
    public static final int eSave_Script		       	= 73;
    public static final int eSave_CatchSignal		       	= 74;
    public static final int eSave_EmitSignal		       	= 75;
    public static final int eSave_End		       		= 99;
    public static final int eSave_Dyn_dyn_type1	       		= 100;
    public static final int eSave_Dyn_action_type1      	= 101;
    public static final int eSave_Dyn_access	       		= 102;
    public static final int eSave_Dyn_cycle	       		= 103;
    public static final int eSave_Dyn_ref_object      		= 104;
    public static final int eSave_Dyn_dyn_type2	       		= 105;
    public static final int eSave_Dyn_action_type2     		= 106;
    public static final int eSave_DigLowColor_attribute		= 200;
    public static final int eSave_DigLowColor_color    		= 201;
    public static final int eSave_DigColor_attribute   		= 300;
    public static final int eSave_DigColor_color       		= 301;
    public static final int eSave_DigColor_instance    		= 302;
    public static final int eSave_DigColor_instance_mask 	= 303;
    public static final int eSave_DigError_attribute   		= 700;
    public static final int eSave_DigError_use_colortheme    	= 701;
    public static final int eSave_DigWarning_attribute  	= 800;
    public static final int eSave_DigWarning_use_colortheme  	= 801;
    public static final int eSave_Invisible_attribute 		= 900;
    public static final int eSave_Invisible_dimmed     		= 901;
    public static final int eSave_Invisible_instance   		= 902;
    public static final int eSave_Invisible_instance_mask 	= 903;
    public static final int eSave_DigBorder_attribute  		= 1000;
    public static final int eSave_DigBorder_color      		= 1001;
    public static final int eSave_DigText_attribute    		= 1100;
    public static final int eSave_DigText_low_text     		= 1101;
    public static final int eSave_DigText_instance     		= 1102;
    public static final int eSave_DigText_instance_mask 	= 1103;
    public static final int eSave_Value_attribute      		= 1200;
    public static final int eSave_Value_format	       		= 1201;
    public static final int eSave_Value_instance      		= 1202;
    public static final int eSave_Value_instance_mask 		= 1203;
    public static final int eSave_Value_zero_blank     		= 1204;
    public static final int eSave_Value_decimals_attr          	= 1205;
    public static final int eSave_Value_decimals_decr          	= 1206;
    public static final int eSave_ValueInput_attribute      	= 1300;
    public static final int eSave_ValueInput_format		= 1301;
    public static final int eSave_ValueInput_min_value      	= 1302;
    public static final int eSave_ValueInput_max_value      	= 1303;
    public static final int eSave_ValueInput_clear      	= 1304;
    public static final int eSave_ValueInput_popup      	= 1305;
    public static final int eSave_ValueInput_unselect      	= 1306;
    public static final int eSave_ValueInput_minvalue_attr   	= 1307;
    public static final int eSave_ValueInput_maxvalue_attr   	= 1308;
    public static final int eSave_ValueInput_escape_store    	= 1309;
    public static final int eSave_ValueInput_keyboard_type    	= 1310;
    public static final int eSave_ValueInput_update_open    	= 1311;
    public static final int eSave_Rotate_attribute		= 1400;
    public static final int eSave_Rotate_x0			= 1401;
    public static final int eSave_Rotate_y0			= 1402;
    public static final int eSave_Rotate_factor             	= 1403;
    public static final int eSave_Move_move_x_attribute     	= 1500;
    public static final int eSave_Move_move_y_attribute    	= 1501;
    public static final int eSave_Move_x_offset	       		= 1502;
    public static final int eSave_Move_y_offset	        	= 1503;
    public static final int eSave_Move_x_factor	       		= 1504;
    public static final int eSave_Move_scale_x_attribute     	= 1505;
    public static final int eSave_Move_scale_y_attribute    	= 1506;
    public static final int eSave_Move_scale_x_factor      	= 1507;
    public static final int eSave_Move_scale_type      		= 1508;
    public static final int eSave_Move_y_factor	       		= 1509;
    public static final int eSave_Move_scale_y_factor      	= 1510;
    public static final int eSave_AnalogShift_attribute     	= 1700;
    public static final int eSave_DigShift_attribute		= 1800;
    public static final int eSave_Animation_attribute       	= 1900;
    public static final int eSave_Animation_sequence		= 1901;
    public static final int eSave_Bar_attribute	   		= 2200;
    public static final int eSave_Bar_minvalue_attr	   	= 2201;
    public static final int eSave_Bar_maxvalue_attr	   	= 2202;
    public static final int eSave_Trend_attribute1	   	= 2300;
    public static final int eSave_Trend_attribute2	   	= 2301;
    public static final int eSave_Trend_minvalue_attr1     	= 2302;
    public static final int eSave_Trend_maxvalue_attr1     	= 2303;
    public static final int eSave_Trend_minvalue_attr2      	= 2304;
    public static final int eSave_Trend_maxvalue_attr2      	= 2305;
    public static final int eSave_Trend_hold_attr	      	= 2306;
    public static final int eSave_Trend_timerange_attr	      	= 2307;
    public static final int eSave_Trend_mark1_attr	      	= 2308;
    public static final int eSave_Trend_mark2_attr	      	= 2309;
    public static final int eSave_Trend_mark1_color	      	= 2310;
    public static final int eSave_Trend_mark2_color	      	= 2311;
    public static final int eSave_DigFlash_attribute		= 2600;
    public static final int eSave_DigFlash_color		= 2601;
    public static final int eSave_DigFlash_color2		= 2602;
    public static final int eSave_FillLevel_attribute       	= 2700;
    public static final int eSave_FillLevel_color		= 2701;
    public static final int eSave_FillLevel_direction       	= 2702;
    public static final int eSave_FillLevel_min_value       	= 2703;
    public static final int eSave_FillLevel_max_value       	= 2704;
    public static final int eSave_FillLevel_minvalue_attr    	= 2705;
    public static final int eSave_FillLevel_maxvalue_attr    	= 2706;
    public static final int eSave_FastCurve_fast_object   	= 2800;
    public static final int eSave_FastCurve_curve_index1   	= 2801;
    public static final int eSave_FastCurve_curve_index2   	= 2802;
    public static final int eSave_AnalogText_super   		= 2900;
    public static final int eSave_Table_attribute1	   	= 3000;
    public static final int eSave_Table_format1	   		= 3001;
    public static final int eSave_Table_sel_attribute1      	= 3002;
    public static final int eSave_Table_attribute2	   	= 3003;
    public static final int eSave_Table_format2	   		= 3004;
    public static final int eSave_Table_sel_attribute2      	= 3005;
    public static final int eSave_Table_attribute3	   	= 3006;
    public static final int eSave_Table_format3	   		= 3007;
    public static final int eSave_Table_sel_attribute3      	= 3008;
    public static final int eSave_Table_attribute4	   	= 3009;
    public static final int eSave_Table_format4	   		= 3010;
    public static final int eSave_Table_sel_attribute4      	= 3011;
    public static final int eSave_Table_attribute5	   	= 3012;
    public static final int eSave_Table_format5	   		= 3013;
    public static final int eSave_Table_sel_attribute5      	= 3014;
    public static final int eSave_Table_attribute6	   	= 3015;
    public static final int eSave_Table_format6	   		= 3016;
    public static final int eSave_Table_sel_attribute6      	= 3017;
    public static final int eSave_Table_attribute7	   	= 3018;
    public static final int eSave_Table_format7	   		= 3019;
    public static final int eSave_Table_sel_attribute7      	= 3020;
    public static final int eSave_Table_attribute8	   	= 3021;
    public static final int eSave_Table_format8	   		= 3022;
    public static final int eSave_Table_sel_attribute8      	= 3023;
    public static final int eSave_Table_attribute9	   	= 3024;
    public static final int eSave_Table_format9	   		= 3025;
    public static final int eSave_Table_sel_attribute9      	= 3026;
    public static final int eSave_Table_attribute10	   	= 3027;
    public static final int eSave_Table_format10	   	= 3028;
    public static final int eSave_Table_sel_attribute10     	= 3029;
    public static final int eSave_Table_attribute11	   	= 3030;
    public static final int eSave_Table_format11	   	= 3031;
    public static final int eSave_Table_sel_attribute11     	= 3032;
    public static final int eSave_Table_attribute12	   	= 3033;
    public static final int eSave_Table_format12	   	= 3034;
    public static final int eSave_Table_sel_attribute12     	= 3035;
    public static final int eSave_StatusColor_attribute     	= 3100;
    public static final int eSave_StatusColor_nostatus_color 	= 3101;
    public static final int eSave_StatusColor_use_colortheme 	= 3102;
    public static final int eSave_HostObject_object     	= 3200;
    public static final int eSave_DigSound_attribute     	= 3300;
    public static final int eSave_DigSound_soundobject     	= 3301;
    public static final int eSave_DigSound_level     		= 3302;
    public static final int eSave_DigSound_interval     	= 3303;
    public static final int eSave_DigSound_instance		= 3304;
    public static final int eSave_DigSound_instance_mask    	= 3305;
    public static final int eSave_XY_Curve_x_attr      		= 3400;
    public static final int eSave_XY_Curve_y_attr      		= 3401;
    public static final int eSave_XY_Curve_y_min_value 		= 3402;
    public static final int eSave_XY_Curve_y_max_value 		= 3403;
    public static final int eSave_XY_Curve_x_min_value 		= 3404;
    public static final int eSave_XY_Curve_x_max_value 		= 3405;
    public static final int eSave_XY_Curve_y_minvalue_attr 	= 3406;
    public static final int eSave_XY_Curve_y_maxvalue_attr 	= 3407;
    public static final int eSave_XY_Curve_x_minvalue_attr 	= 3408;
    public static final int eSave_XY_Curve_x_maxvalue_attr 	= 3409;
    public static final int eSave_XY_Curve_noofpoints 		= 3410;
    public static final int eSave_XY_Curve_noofpoints_attr 	= 3411;
    public static final int eSave_XY_Curve_update_attr 		= 3412;
    public static final int eSave_XY_Curve_datatype 		= 3413;
    public static final int eSave_XY_Curve_instance		= 3414;
    public static final int eSave_XY_Curve_instance_mask    	= 3415;
    public static final int eSave_XY_Curve_curve_color    	= 3416;
    public static final int eSave_XY_Curve_fill_color    	= 3417;
    public static final int eSave_XY_Curve_horizontal_padding  	= 3418;
    public static final int eSave_XY_Curve_x_mark1_attr    	= 3419;
    public static final int eSave_XY_Curve_x_mark2_attr    	= 3420;
    public static final int eSave_XY_Curve_y_mark1_attr    	= 3421;
    public static final int eSave_XY_Curve_y_mark2_attr    	= 3422;
    public static final int eSave_XY_Curve_mark1_color    	= 3423;
    public static final int eSave_XY_Curve_mark2_color    	= 3424;
    public static final int eSave_DigCommand_attribute      	= 3500;
    public static final int eSave_DigCommand_command      	= 3501;
    public static final int eSave_DigCommand_instance        	= 3502;
    public static final int eSave_DigCommand_instance_mask 	= 3503;
    public static final int eSave_DigCommand_level 		= 3504;
    public static final int eSave_Pie_attribute1      		= 3600;
    public static final int eSave_Pie_attribute2      		= 3601;
    public static final int eSave_Pie_attribute3      		= 3602;
    public static final int eSave_Pie_attribute4      		= 3603;
    public static final int eSave_Pie_attribute5      		= 3604;
    public static final int eSave_Pie_attribute6      		= 3605;
    public static final int eSave_Pie_attribute7      		= 3606;
    public static final int eSave_Pie_attribute8      		= 3607;
    public static final int eSave_Pie_attribute9      		= 3608;
    public static final int eSave_Pie_attribute10      		= 3609;
    public static final int eSave_Pie_attribute11      		= 3610;
    public static final int eSave_Pie_attribute12      		= 3611;
    public static final int eSave_Pie_fix_range      		= 3612;
    public static final int eSave_BarChart_attribute1      	= 3700;
    public static final int eSave_BarChart_attribute2      	= 3701;
    public static final int eSave_BarChart_attribute3      	= 3702;
    public static final int eSave_BarChart_attribute4      	= 3703;
    public static final int eSave_BarChart_attribute5      	= 3704;
    public static final int eSave_BarChart_attribute6      	= 3705;
    public static final int eSave_BarChart_attribute7      	= 3706;
    public static final int eSave_BarChart_attribute8      	= 3707;
    public static final int eSave_BarChart_attribute9      	= 3708;
    public static final int eSave_BarChart_attribute10      	= 3709;
    public static final int eSave_BarChart_attribute11      	= 3710;
    public static final int eSave_BarChart_attribute12      	= 3711;
    public static final int eSave_BarChart_fix_range      	= 3712;
    public static final int eSave_Axis_minvalue_attr      	= 3800;
    public static final int eSave_Axis_maxvalue_attr      	= 3801;
    public static final int eSave_Axis_keep_settings      	= 3802;
    public static final int eSave_DigTextColor_attribute        = 3900;
    public static final int eSave_DigTextColor_color		= 3901;
    public static final int eSave_TimeoutColor_time             = 4000;
    public static final int eSave_TimeoutColor_color		= 4001;
    public static final int eSave_DigFourShift_attribute1      	= 4100;
    public static final int eSave_DigFourShift_attribute2      	= 4101;
    public static final int eSave_DigFourShift_attribute3      	= 4102;
    public static final int eSave_ScrollingText_attribute      	= 4200;
    public static final int eSave_ScrollingText_direction      	= 4201;
    public static final int eSave_ScrollingText_speed      	= 4202;
    public static final int eSave_ScrollingText_bounce      	= 4203;
    public static final int eSave_DigBackgroundColor_attribute  = 4400;
    public static final int eSave_DigBackgroundColor_color      = 4401;
    public static final int eSave_DigBackgroundColor_instance   = 4402;
    public static final int eSave_DigBackgroundColor_instance_mask = 4403;
    public static final int eSave_DigSwap_attribute  		= 4500;
    public static final int eSave_DigSwap_reset_value  		= 4501;
    public static final int eSave_DigScript_attribute  		= 4600;
    public static final int eSave_DigScript_script  		= 4601;
    public static final int eSave_DigScript_script_len         	= 4602;
    public static final int eSave_DigScript_level  		= 4603;
    public static final int eSave_RefUpdate_attribute  		= 4700;
    public static final int eSave_RefUpdate_whole_graph        	= 4701;
    public static final int eSave_PopupMenu_ref_object      	= 5000;
    public static final int eSave_SetDig_attribute		= 5100;
    public static final int eSave_SetDig_instance		= 5101;
    public static final int eSave_SetDig_instance_mask      	= 5102;
    public static final int eSave_ResetDig_attribute		= 5200;
    public static final int eSave_ResetDig_instance		= 5201;
    public static final int eSave_ResetDig_instance_mask    	= 5202;
    public static final int eSave_ToggleDig_attribute       	= 5300;
    public static final int eSave_StoDig_attribute		= 5400;
    public static final int eSave_Command_command		= 5500;
    public static final int eSave_CommandDC_command		= 5600;
    public static final int eSave_Confirm_text	       		= 5700;
    public static final int eSave_Confirm_on_set	       	= 5701;
    public static final int eSave_Confirm_on_reset	       	= 5702;
    public static final int eSave_IncrAnalog_attribute      	= 5800;
    public static final int eSave_IncrAnalog_increment      	= 5801;
    public static final int eSave_IncrAnalog_min_value      	= 5802;
    public static final int eSave_IncrAnalog_max_value      	= 5803;
    public static final int eSave_RadioButton_attribute     	= 5900;
    public static final int eSave_Slider_attribute	       	= 6000;
    public static final int eSave_Slider_minvalue_attr     	= 6001;
    public static final int eSave_Slider_maxvalue_attr     	= 6002;
    public static final int eSave_Slider_insensitive_attr    	= 6003;
    public static final int eSave_Slider_release_attr    	= 6004;
    public static final int eSave_AnalogColor_attribute      	= 6100;
    public static final int eSave_AnalogColor_limit        	= 6101;
    public static final int eSave_AnalogColor_limit_type     	= 6102;
    public static final int eSave_AnalogColor_color       	= 6103;
    public static final int eSave_AnalogColor_instance      	= 6104;
    public static final int eSave_AnalogColor_instance_mask 	= 6105;
    public static final int eSave_AnalogColor_border	 	= 6106;
    public static final int eSave_AnalogColor_common_attr     	= 6107;
    public static final int eSave_TipText_text              	= 6200;
    public static final int eSave_Help_topic        		= 6300;
    public static final int eSave_Help_bookmark             	= 6400;
    public static final int eSave_OpenGraph_graph_object    	= 6401;
    public static final int eSave_OpenURL_url               	= 6500;
    public static final int eSave_InputFocus_initial_focus	= 6600;
    public static final int eSave_InputFocus_next_horizontal	= 6601;
    public static final int eSave_InputFocus_next_vertical	= 6602;
    public static final int eSave_InputFocus_next_tab		= 6603;
    public static final int eSave_PulldownMenu_button_mask	= 6800;
    public static final int eSave_PulldownMenu_items_text0	= 6801;
    public static final int eSave_PulldownMenu_items_text1	= 6802;
    public static final int eSave_PulldownMenu_items_text2	= 6803;
    public static final int eSave_PulldownMenu_items_text3	= 6804;
    public static final int eSave_PulldownMenu_items_text4	= 6805;
    public static final int eSave_PulldownMenu_items_text5	= 6806;
    public static final int eSave_PulldownMenu_items_text6	= 6807;
    public static final int eSave_PulldownMenu_items_text7	= 6808;
    public static final int eSave_PulldownMenu_items_text8	= 6809;
    public static final int eSave_PulldownMenu_items_text9	= 6810;
    public static final int eSave_PulldownMenu_items_text10	= 6811;
    public static final int eSave_PulldownMenu_items_text11	= 6812;
    public static final int eSave_PulldownMenu_items_text12	= 6813;
    public static final int eSave_PulldownMenu_items_text13	= 6814;
    public static final int eSave_PulldownMenu_items_text14	= 6815;
    public static final int eSave_PulldownMenu_items_text15	= 6816;
    public static final int eSave_PulldownMenu_items_text16	= 6817;
    public static final int eSave_PulldownMenu_items_text17	= 6818;
    public static final int eSave_PulldownMenu_items_text18	= 6819;
    public static final int eSave_PulldownMenu_items_text19	= 6820;
    public static final int eSave_PulldownMenu_items_text20	= 6821;
    public static final int eSave_PulldownMenu_items_text21	= 6822;
    public static final int eSave_PulldownMenu_items_text22	= 6823;
    public static final int eSave_PulldownMenu_items_text23	= 6824;
    public static final int eSave_PulldownMenu_items_text24	= 6825;
    public static final int eSave_PulldownMenu_items_text25	= 6826;
    public static final int eSave_PulldownMenu_items_text26	= 6827;
    public static final int eSave_PulldownMenu_items_text27	= 6828;
    public static final int eSave_PulldownMenu_items_text28	= 6829;
    public static final int eSave_PulldownMenu_items_text29	= 6830;
    public static final int eSave_PulldownMenu_items_text30	= 6831;
    public static final int eSave_PulldownMenu_items_text31	= 6832;
    public static final int eSave_PulldownMenu_items_dyn0	= 6833;
    public static final int eSave_PulldownMenu_items_dyn1	= 6834;
    public static final int eSave_PulldownMenu_items_dyn2	= 6835;
    public static final int eSave_PulldownMenu_items_dyn3	= 6836;
    public static final int eSave_PulldownMenu_items_dyn4	= 6837;
    public static final int eSave_PulldownMenu_items_dyn5	= 6838;
    public static final int eSave_PulldownMenu_items_dyn6	= 6839;
    public static final int eSave_PulldownMenu_items_dyn7	= 6840;
    public static final int eSave_PulldownMenu_items_dyn8	= 6841;
    public static final int eSave_PulldownMenu_items_dyn9	= 6842;
    public static final int eSave_PulldownMenu_items_dyn10	= 6843;
    public static final int eSave_PulldownMenu_items_dyn11	= 6844;
    public static final int eSave_PulldownMenu_items_dyn12	= 6845;
    public static final int eSave_PulldownMenu_items_dyn13	= 6846;
    public static final int eSave_PulldownMenu_items_dyn14	= 6847;
    public static final int eSave_PulldownMenu_items_dyn15	= 6848;
    public static final int eSave_PulldownMenu_items_dyn16	= 6849;
    public static final int eSave_PulldownMenu_items_dyn17	= 6850;
    public static final int eSave_PulldownMenu_items_dyn18	= 6851;
    public static final int eSave_PulldownMenu_items_dyn19	= 6852;
    public static final int eSave_PulldownMenu_items_dyn20	= 6853;
    public static final int eSave_PulldownMenu_items_dyn21	= 6854;
    public static final int eSave_PulldownMenu_items_dyn22	= 6855;
    public static final int eSave_PulldownMenu_items_dyn23	= 6856;
    public static final int eSave_PulldownMenu_items_dyn24	= 6857;
    public static final int eSave_PulldownMenu_items_dyn25	= 6858;
    public static final int eSave_PulldownMenu_items_dyn26	= 6859;
    public static final int eSave_PulldownMenu_items_dyn27	= 6860;
    public static final int eSave_PulldownMenu_items_dyn28	= 6861;
    public static final int eSave_PulldownMenu_items_dyn29	= 6862;
    public static final int eSave_PulldownMenu_items_dyn30	= 6863;
    public static final int eSave_PulldownMenu_items_dyn31	= 6864;
    public static final int eSave_OptionMenu_button_mask	= 6900;
    public static final int eSave_OptionMenu_items_text0	= 6901;
    public static final int eSave_OptionMenu_items_text1	= 6902;
    public static final int eSave_OptionMenu_items_text2	= 6903;
    public static final int eSave_OptionMenu_items_text3	= 6904;
    public static final int eSave_OptionMenu_items_text4	= 6905;
    public static final int eSave_OptionMenu_items_text5	= 6906;
    public static final int eSave_OptionMenu_items_text6	= 6907;
    public static final int eSave_OptionMenu_items_text7	= 6908;
    public static final int eSave_OptionMenu_items_text8	= 6909;
    public static final int eSave_OptionMenu_items_text9	= 6910;
    public static final int eSave_OptionMenu_items_text10	= 6911;
    public static final int eSave_OptionMenu_items_text11	= 6912;
    public static final int eSave_OptionMenu_items_text12	= 6913;
    public static final int eSave_OptionMenu_items_text13	= 6914;
    public static final int eSave_OptionMenu_items_text14	= 6915;
    public static final int eSave_OptionMenu_items_text15	= 6916;
    public static final int eSave_OptionMenu_items_text16	= 6917;
    public static final int eSave_OptionMenu_items_text17	= 6918;
    public static final int eSave_OptionMenu_items_text18	= 6919;
    public static final int eSave_OptionMenu_items_text19	= 6920;
    public static final int eSave_OptionMenu_items_text20	= 6921;
    public static final int eSave_OptionMenu_items_text21	= 6922;
    public static final int eSave_OptionMenu_items_text22	= 6923;
    public static final int eSave_OptionMenu_items_text23	= 6924;
    public static final int eSave_OptionMenu_items_text24	= 6925;
    public static final int eSave_OptionMenu_items_text25	= 6926;
    public static final int eSave_OptionMenu_items_text26	= 6927;
    public static final int eSave_OptionMenu_items_text27	= 6928;
    public static final int eSave_OptionMenu_items_text28	= 6929;
    public static final int eSave_OptionMenu_items_text29	= 6930;
    public static final int eSave_OptionMenu_items_text30	= 6931;
    public static final int eSave_OptionMenu_items_text31	= 6932;
    public static final int eSave_OptionMenu_items_enum0	= 6933;
    public static final int eSave_OptionMenu_items_enum1	= 6934;
    public static final int eSave_OptionMenu_items_enum2	= 6935;
    public static final int eSave_OptionMenu_items_enum3	= 6936;
    public static final int eSave_OptionMenu_items_enum4	= 6937;
    public static final int eSave_OptionMenu_items_enum5	= 6938;
    public static final int eSave_OptionMenu_items_enum6	= 6939;
    public static final int eSave_OptionMenu_items_enum7	= 6940;
    public static final int eSave_OptionMenu_items_enum8	= 6941;
    public static final int eSave_OptionMenu_items_enum9	= 6942;
    public static final int eSave_OptionMenu_items_enum10	= 6943;
    public static final int eSave_OptionMenu_items_enum11	= 6944;
    public static final int eSave_OptionMenu_items_enum12	= 6945;
    public static final int eSave_OptionMenu_items_enum13	= 6946;
    public static final int eSave_OptionMenu_items_enum14	= 6947;
    public static final int eSave_OptionMenu_items_enum15	= 6948;
    public static final int eSave_OptionMenu_items_enum16	= 6949;
    public static final int eSave_OptionMenu_items_enum17	= 6950;
    public static final int eSave_OptionMenu_items_enum18	= 6951;
    public static final int eSave_OptionMenu_items_enum19	= 6952;
    public static final int eSave_OptionMenu_items_enum20	= 6953;
    public static final int eSave_OptionMenu_items_enum21	= 6954;
    public static final int eSave_OptionMenu_items_enum22	= 6955;
    public static final int eSave_OptionMenu_items_enum23	= 6956;
    public static final int eSave_OptionMenu_items_enum24	= 6957;
    public static final int eSave_OptionMenu_items_enum25	= 6958;
    public static final int eSave_OptionMenu_items_enum26	= 6959;
    public static final int eSave_OptionMenu_items_enum27	= 6960;
    public static final int eSave_OptionMenu_items_enum28	= 6961;
    public static final int eSave_OptionMenu_items_enum29	= 6962;
    public static final int eSave_OptionMenu_items_enum30	= 6963;
    public static final int eSave_OptionMenu_items_enum31	= 6964;
    public static final int eSave_OptionMenu_attribute		= 6965;
    public static final int eSave_OptionMenu_text_attribute	= 6966;
    public static final int eSave_OptionMenu_size_attribute	= 6967;
    public static final int eSave_OptionMenu_update_attribute 	= 6968;
    public static final int eSave_OptionMenu_optionmenu_type 	= 6969;
    public static final int eSave_SetValue_attribute		= 7000;
    public static final int eSave_SetValue_value		= 7001;
    public static final int eSave_SetValue_instance		= 7002;
    public static final int eSave_SetValue_instance_mask     	= 7003;
    public static final int eSave_MethodToolbar_method_object   = 7100;
    public static final int eSave_MethodToolbar_toolbar_type    = 7101;
    public static final int eSave_MethodPulldownMenu_method_object = 7200;
    public static final int eSave_MethodPulldownMenu_menu_type  = 7201;
    public static final int eSave_Script_script_len		= 7300;
    public static final int eSave_Script_script			= 7301;
    public static final int eSave_CatchSignal_signal_name   	= 7400;
    public static final int eSave_EmitSignal_signal_name   	= 7500;
    public static final int eSave_EmitSignal_global   		= 7501;

    public static final int eAnimSequence_Inherit      	= 0;
    public static final int eAnimSequence_Cycle		= 1;
    public static final int eAnimSequence_Dig		= 2;
    public static final int eAnimSequence_ForwBack	= 3;

    public static final int eLimitType_Gt		= 0;
    public static final int eLimitType_Lt		= 1;
    public static final int eLimitType_Ge		= 2;
    public static final int eLimitType_Le		= 3;
    public static final int eLimitType_Eq		= 4;

    public static final int ePwrStatus_No		= 0;
    public static final int ePwrStatus_Success		= 1;
    public static final int ePwrStatus_Warning		= 2;
    public static final int ePwrStatus_Error		= 3;
    public static final int ePwrStatus_Fatal		= 4;

    public static final int eMethodsMenuType_Object	= 0;
    public static final int eMethodsMenuType_Help	= 1;
    public static final int eMethodsMenuType_Simulate	= 2;

    public static final int eMethodToolbarType_Object	= 0;
    public static final int eMethodToolbarType_Simulate	= 1;

    public static final boolean debug = false;

    Vector<DynElem> elements = new Vector<DynElem>();
    GraphIfc graph;
    GlowArrayElem object;
    int dyn_type1;
    int dyn_type2;
    int action_type1;
    int action_type2;
    int access;
    int cycle;
    int total_dyn_type1;
    int total_dyn_type2;
    int total_action_type1;
    int total_action_type2;

    boolean repaintNow;
    boolean ignoreColor;
    boolean resetColor;
    boolean ignoreBgColor;
    boolean resetBgColor;

    public Dyn(GraphIfc graph) {
	this.graph = graph;
    }

    public Dyn(Dyn x) {
	this.graph = x.graph;
	this.dyn_type1 = x.dyn_type1;
	this.dyn_type2 = x.dyn_type2;
	this.total_dyn_type1 = x.total_dyn_type1;
	this.total_dyn_type2 = x.total_dyn_type2;
	this.action_type1 = x.action_type1;
	this.action_type2 = x.action_type2;
	this.total_action_type1 = x.total_action_type1;
	this.total_action_type2 = x.total_action_type2;
	this.access = x.access;
	this.cycle = x.cycle;

	for ( int i = 0; i < x.elements.size(); i++) {
	    DynElem e = null;
	    switch( x.elements.get(i).dyn_type1) {
	    case Dyn.mDynType1_DigLowColor:
		e = new DynDigLowColor((DynDigLowColor) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigColor:
		e = new DynDigColor((DynDigColor) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigError:
		e = new DynDigError((DynDigError) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigWarning:
		e = new DynDigWarning((DynDigWarning) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigFlash:
		e = new DynDigFlash((DynDigFlash) x.elements.get(i)); break;
	    case Dyn.mDynType1_Invisible:
		e = new DynInvisible((DynInvisible) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigBorder:
		e = new DynDigBorder((DynDigBorder) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigText:
		e = new DynDigText((DynDigText) x.elements.get(i)); break;
	    case Dyn.mDynType1_Value:
		e = new DynValue((DynValue) x.elements.get(i)); break;
	    case Dyn.mDynType1_AnalogColor:
		e = new DynAnalogColor((DynAnalogColor) x.elements.get(i)); break;
	    case Dyn.mDynType1_Rotate:
		e = new DynRotate((DynRotate) x.elements.get(i)); break;
	    case Dyn.mDynType1_Move:
		e = new DynMove((DynMove) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigShift:
		e = new DynDigShift((DynDigShift) x.elements.get(i)); break;
	    case Dyn.mDynType1_AnalogShift:
		e = new DynAnalogShift((DynAnalogShift) x.elements.get(i)); break;
	    case Dyn.mDynType1_Video:
		e = new DynVideo((DynVideo) x.elements.get(i)); break;
	    case Dyn.mDynType1_Animation:
		e = new DynAnimation((DynAnimation) x.elements.get(i)); break;
	    case Dyn.mDynType1_Bar:
		e = new DynBar((DynBar) x.elements.get(i)); break;
	    case Dyn.mDynType1_Trend:
		e = new DynTrend((DynTrend) x.elements.get(i)); break;
	    case Dyn.mDynType1_FillLevel:
		e = new DynFillLevel((DynFillLevel) x.elements.get(i)); break;
	    case Dyn.mDynType1_FastCurve:
		e = new DynFastCurve((DynFastCurve) x.elements.get(i)); break;
	    case Dyn.mDynType1_AnalogText:
		e = new DynAnalogText((DynAnalogText) x.elements.get(i)); break;
	    case Dyn.mDynType1_Table:
		e = new DynTable((DynTable) x.elements.get(i)); break;
	    case Dyn.mDynType1_StatusColor:
		e = new DynStatusColor((DynStatusColor) x.elements.get(i)); break;
	    case Dyn.mDynType1_HostObject:
		e = new DynHostObject((DynHostObject) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigSound:
		e = new DynDigSound((DynDigSound) x.elements.get(i)); break;
	    case Dyn.mDynType1_XY_Curve:
		e = new DynXY_Curve((DynXY_Curve) x.elements.get(i)); break;
	    case Dyn.mDynType1_DigCommand:
		e = new DynDigCommand((DynDigCommand) x.elements.get(i)); break;
	    case Dyn.mDynType1_Pie:
		e = new DynPie((DynPie) x.elements.get(i)); break;
	    case Dyn.mDynType1_BarChart:
		e = new DynBarChart((DynBarChart) x.elements.get(i)); break;
	    default: ;
	    }
	    switch( x.elements.get(i).dyn_type2) {
	    case Dyn.mDynType2_Axis:
		e = new DynAxis((DynAxis) x.elements.get(i)); break;
	    case Dyn.mDynType2_DigTextColor:
		e = new DynDigTextColor((DynDigTextColor) x.elements.get(i)); break;
	    case Dyn.mDynType2_TimeoutColor:
		e = new DynTimeoutColor((DynTimeoutColor) x.elements.get(i)); break;
	    case Dyn.mDynType2_DigFourShift:
		e = new DynDigFourShift((DynDigFourShift) x.elements.get(i)); break;
	    case Dyn.mDynType2_ScrollingText:
		e = new DynScrollingText((DynScrollingText) x.elements.get(i)); break;
	    case Dyn.mDynType2_ColorThemeLightness:
		e = new DynColorThemeLightness((DynColorThemeLightness) x.elements.get(i)); break;
	    case Dyn.mDynType2_DigBackgroundColor:
		e = new DynDigBackgroundColor((DynDigBackgroundColor) x.elements.get(i)); break;
	    case Dyn.mDynType2_DigSwap:
		e = new DynDigSwap((DynDigSwap) x.elements.get(i)); break;
	    case Dyn.mDynType2_DigScript:
		e = new DynDigScript((DynDigScript) x.elements.get(i)); break;
	    case Dyn.mDynType2_RefUpdate:
		e = new DynRefUpdate((DynRefUpdate) x.elements.get(i)); break;
	    default: ;
	    }
	    switch( x.elements.get(i).action_type1) {
	    case Dyn.mActionType1_PopupMenu:
		e = new DynPopupMenu((DynPopupMenu) x.elements.get(i)); break;
	    case Dyn.mActionType1_SetDig:
		e = new DynSetDig((DynSetDig) x.elements.get(i)); break;
	    case Dyn.mActionType1_ResetDig:
		e = new DynResetDig((DynResetDig) x.elements.get(i)); break;
	    case Dyn.mActionType1_ToggleDig:
		e = new DynToggleDig((DynToggleDig) x.elements.get(i)); break;
	    case Dyn.mActionType1_StoDig:
		e = new DynStoDig((DynStoDig) x.elements.get(i)); break;
	    case Dyn.mActionType1_Command:
		e = new DynCommand((DynCommand) x.elements.get(i)); break;
	    case Dyn.mActionType1_CommandDoubleClick: 
		e = new DynCommandDoubleClick((DynCommandDoubleClick) x.elements.get(i)); break;
	    case Dyn.mActionType1_Confirm:
		e = new DynConfirm((DynConfirm) x.elements.get(i)); break;
	    case Dyn.mActionType1_IncrAnalog:
		e = new DynIncrAnalog((DynIncrAnalog) x.elements.get(i)); break;
	    case Dyn.mActionType1_RadioButton:
		e = new DynRadioButton((DynRadioButton) x.elements.get(i)); break;
	    case Dyn.mActionType1_Slider:
		e = new DynSlider((DynSlider) x.elements.get(i)); break;
	    case Dyn.mActionType1_ValueInput:
		e = new DynValueInput((DynValueInput) x.elements.get(i)); break;
	    case Dyn.mActionType1_TipText:
		e = new DynTipText((DynTipText) x.elements.get(i)); break;
	    case Dyn.mActionType1_Help:
		e = new DynHelp((DynHelp) x.elements.get(i)); break;
	    case Dyn.mActionType1_OpenGraph:
		e = new DynOpenGraph((DynOpenGraph) x.elements.get(i)); break;
	    case Dyn.mActionType1_OpenURL:
		e = new DynOpenURL((DynOpenURL) x.elements.get(i)); break;
	    case Dyn.mActionType1_InputFocus:
		e = new DynInputFocus((DynInputFocus) x.elements.get(i)); break;
	    case Dyn.mActionType1_CloseGraph:
		e = new DynCloseGraph((DynCloseGraph) x.elements.get(i)); break;
	    case Dyn.mActionType1_PulldownMenu:
		e = new DynPulldownMenu((DynPulldownMenu) x.elements.get(i)); break;
	    case Dyn.mActionType1_OptionMenu:
		e = new DynOptionMenu((DynOptionMenu) x.elements.get(i)); break;
	    case Dyn.mActionType1_SetValue:
		e = new DynSetValue((DynSetValue) x.elements.get(i)); break;
	    case Dyn.mActionType1_MethodToolbar:
		e = new DynMethodToolbar((DynMethodToolbar) x.elements.get(i)); break;
	    case Dyn.mActionType1_MethodPulldownMenu:
		e = new DynMethodPulldownMenu((DynMethodPulldownMenu) x.elements.get(i)); break;
	    case Dyn.mActionType1_Script:
		e = new DynScript((DynScript) x.elements.get(i)); break;
	    case Dyn.mActionType1_EmitSignal:
		e = new DynEmitSignal((DynEmitSignal) x.elements.get(i)); break;
	    case Dyn.mActionType1_CatchSignal:
		e = new DynCatchSignal((DynCatchSignal) x.elements.get(i)); break;
	    default: ;
	    }
	    switch( x.elements.get(i).action_type2) {
	    default: ;
	    }
	    if ( e != null) {
		e.dyn = this;
		elements.add(e);
	    }
	}
    }

    DynElem copy_element( DynElem x) {
	DynElem e = null;

	if ( x.action_type1 != 0) {
	    switch ( x.action_type1) {
	    case mActionType1_PopupMenu:
		e = (DynElem) new DynPopupMenu((DynPopupMenu) x);
		break;
	    case mActionType1_SetDig:
		e = (DynElem) new DynSetDig((DynSetDig) x);
		break;
	    case mActionType1_ResetDig:
		e = (DynElem) new DynResetDig((DynResetDig) x);
		break;
	    case mActionType1_ToggleDig:
		e = (DynElem) new DynToggleDig((DynToggleDig) x);
		break;
	    case mActionType1_StoDig:
		e = (DynElem) new DynStoDig((DynStoDig) x);
		break;
	    case mActionType1_Command:
		e = (DynElem) new DynCommand((DynCommand) x);
		break;
	    case mActionType1_CommandDoubleClick:
		e = (DynElem) new DynCommandDoubleClick((DynCommandDoubleClick) x);
		break;
	    case mActionType1_Confirm:
		e = (DynElem) new DynConfirm((DynConfirm) x);
		break;
	    case mActionType1_IncrAnalog:
		e = (DynElem) new DynIncrAnalog((DynIncrAnalog) x);
		break;
	    case mActionType1_RadioButton:
		e = (DynElem) new DynRadioButton((DynRadioButton) x);
		break;
	    case mActionType1_Slider:
		e = (DynElem) new DynSlider((DynSlider) x);
		break;
	    case mActionType1_ValueInput:
		e = (DynElem) new DynValueInput((DynValueInput) x);
		break;
	    case mActionType1_TipText:
		e = (DynElem) new DynTipText((DynTipText) x);
		break;
	    case mActionType1_Help:
		e = (DynElem) new DynHelp((DynHelp ) x);
		break;
	    case mActionType1_OpenGraph:
		e = (DynElem) new DynOpenGraph((DynOpenGraph) x);
		break;
	    case mActionType1_OpenURL:
		e = (DynElem) new DynOpenURL((DynOpenURL) x);
		break;
	    case mActionType1_InputFocus:
		e = (DynElem) new DynInputFocus((DynInputFocus) x);
		break;
	    case mActionType1_CloseGraph:
		e = (DynElem) new DynCloseGraph((DynCloseGraph) x);
		break;
	    case mActionType1_PulldownMenu:
		e = (DynElem) new DynPulldownMenu((DynPulldownMenu) x);
		break;
	    case mActionType1_OptionMenu:
		e = (DynElem) new DynOptionMenu((DynOptionMenu) x);
		break;
	    case mActionType1_SetValue:
		e = (DynElem) new DynSetValue((DynSetValue) x);
		break;
	    case mActionType1_MethodToolbar:
		e = (DynElem) new DynMethodToolbar((DynMethodToolbar) x);
		break;
	    case mActionType1_MethodPulldownMenu:
		e = (DynElem) new DynMethodPulldownMenu((DynMethodPulldownMenu) x);
		break;
	    case mActionType1_Script:
		e = (DynElem) new DynScript((DynScript) x);
		break;
	    case mActionType1_CatchSignal:
		e = (DynElem) new DynCatchSignal((DynCatchSignal) x);
		break;
	    case mActionType1_EmitSignal:
		e = (DynElem) new DynEmitSignal((DynEmitSignal) x);
		break;
	    default: ;
	    }
	}
	else if ( x.action_type2 != 0) {
	    switch ( x.action_type2) {
	    default: ;
	    }
	}
	else if ( x.dyn_type1 != 0) {
	    switch ( x.dyn_type1) {
	    case mDynType1_DigLowColor:
		e = (DynElem) new DynDigLowColor((DynDigLowColor) x);
		break;
	    case mDynType1_DigColor:
		e = (DynElem) new DynDigColor((DynDigColor) x);
		break;
	    case mDynType1_DigWarning:
		e = (DynElem) new DynDigWarning((DynDigWarning) x);
		break;
	    case mDynType1_DigError:
		e = (DynElem) new DynDigError((DynDigError) x);
		break;
	    case mDynType1_DigFlash:
		e = (DynElem) new DynDigFlash((DynDigFlash) x);
		break;
	    case mDynType1_Invisible:
		e = (DynElem) new DynInvisible((DynInvisible) x);
		break;
	    case mDynType1_DigBorder:
		e = (DynElem) new DynDigBorder((DynDigBorder) x);
		break;
	    case mDynType1_DigText:
		e = (DynElem) new DynDigText((DynDigText) x);
		break;
	    case mDynType1_Value:
		e = (DynElem) new DynValue((DynValue) x);
		break;
	    case mDynType1_AnalogColor:
		e = (DynElem) new DynAnalogColor((DynAnalogColor) x);
		break;
	    case mDynType1_Rotate:
		e = (DynElem) new DynRotate((DynRotate) x);
		break;
	    case mDynType1_Move:
		e = (DynElem) new DynMove((DynMove) x);
		break;
	    case mDynType1_AnalogShift:
		e = (DynElem) new DynAnalogShift((DynAnalogShift) x);
		break;
	    case mDynType1_DigShift:
		e = (DynElem) new DynDigShift((DynDigShift) x);
		break;
	    case mDynType1_Animation:
		e = (DynElem) new DynAnimation((DynAnimation) x);
		break;
	    case mDynType1_Video:
		e = (DynElem) new DynVideo((DynVideo) x);
		break;
	    case mDynType1_Bar:
		e = (DynElem) new DynBar((DynBar) x);
		break;
	    case mDynType1_Trend:
		e = (DynElem) new DynTrend((DynTrend) x);
		break;
	    case mDynType1_XY_Curve:
		e = (DynElem) new DynXY_Curve((DynXY_Curve) x);
		break;
	    case mDynType1_DigCommand:
		e = (DynElem) new DynDigCommand((DynDigCommand) x);
		break;
	    case mDynType1_FillLevel:
		e = (DynElem) new DynFillLevel((DynFillLevel) x);
		break;
	    case mDynType1_FastCurve:
		e = (DynElem) new DynFastCurve((DynFastCurve) x);
		break;
	    case mDynType1_AnalogText:
		e = (DynElem) new DynAnalogText((DynAnalogText) x);
		break;
	    case mDynType1_Table:
		e = (DynElem) new DynTable((DynTable) x);
		break;
	    case mDynType1_StatusColor:
		e = (DynElem) new DynStatusColor((DynStatusColor) x);
		break;
	    case mDynType1_Pie:
		e = (DynElem) new DynPie((DynPie) x);
		break;
	    case mDynType1_BarChart:
		e = (DynElem) new DynBarChart((DynBarChart) x);
		break;
	    case mDynType1_HostObject:
		e = (DynElem) new DynHostObject((DynHostObject) x);
		break;
	    case mDynType1_DigSound:
		e = (DynElem) new DynDigSound((DynDigSound) x);
		break;
	    default: ;
	    }
	}
	else if ( x.dyn_type2 != 0) {
	    switch ( x.dyn_type2) {
	    case mDynType2_Axis:
		e = (DynElem) new DynAxis((DynAxis) x);
		break;
	    case mDynType2_DigTextColor:
		e = (DynElem) new DynDigTextColor((DynDigTextColor) x);
		break;
	    case mDynType2_TimeoutColor:
		e = (DynElem) new DynTimeoutColor((DynTimeoutColor) x);
		break;
	    case mDynType2_DigFourShift:
		e = (DynElem) new DynDigFourShift((DynDigFourShift) x);
		break;
	    case mDynType2_ScrollingText:
		e = (DynElem) new DynScrollingText((DynScrollingText) x);
		break;
	    case mDynType2_ColorThemeLightness:
		e = (DynElem) new DynColorThemeLightness((DynColorThemeLightness) x);
		break;
	    case mDynType2_DigBackgroundColor:
		e = (DynElem) new DynDigBackgroundColor((DynDigBackgroundColor) x);
		break;
	    case mDynType2_DigSwap:
		e = (DynElem) new DynDigSwap((DynDigSwap) x);
		break;
	    case mDynType2_DigScript:
		e = (DynElem) new DynDigScript((DynDigScript) x);
		break;
	    case mDynType2_RefUpdate:
		e = (DynElem) new DynRefUpdate((DynRefUpdate) x);
		break;
	    default: ;
	    }
	}

	if ( e != null)
	    e.dyn = this;
	return e;
    }

    public void merge( Dyn x) {
	DynElem elem, xelem;
	DynElem e;

	dyn_type1 = dyn_type1 | x.dyn_type1;
	total_dyn_type1 = total_dyn_type1 | x.total_dyn_type1;
	action_type1 = action_type1 | x.action_type1;
	total_action_type1 = total_action_type1 | x.total_action_type1;
  
	for ( int i = 0; i < x.elements.size(); i++) {
	    xelem = x.elements.get(i);

	    for ( int j = 0; j < elements.size(); j++) {
		elem = elements.get(j);
		if ( elem.dyn_type1 == xelem.dyn_type1 && 
		     elem.dyn_type2 == xelem.dyn_type2 && 		     
		     elem.action_type1 == xelem.action_type1 &&
		     elem.action_type2 == xelem.action_type2) {
		    // Element exists in both, use element in x, i.e. remove current element
		    elements.remove(j);
		    break;
		}
	    }
	    // Insert copy of x element
	    e = copy_element( xelem);
	    if ( e != null) {
		elements.add( e);
	    }
	}
    }

    public void open( BufferedReader reader) {
	String line;
	StringTokenizer token;
	boolean end_found = false;
	DynElem elem;

	try {
	    while( (line = reader.readLine()) != null) {
		token = new StringTokenizer(line);
		int key = Integer.valueOf(token.nextToken());
		if ( Dyn.debug) System.out.println( "Dyn : " + line);

		elem = null;
		switch ( key) {
		case Dyn.eSave_Dyn: 
		    break;
		case Dyn.eSave_Dyn_dyn_type1: 
		    dyn_type1 = Integer.valueOf(token.nextToken());
		    break;
		case Dyn.eSave_Dyn_dyn_type2: 
		    dyn_type2 = Integer.valueOf(token.nextToken());
		    break;
		case Dyn.eSave_Dyn_action_type1: 
		    action_type1 = Integer.valueOf(token.nextToken());
		    break;
		case Dyn.eSave_Dyn_action_type2: 
		    action_type2 = Integer.valueOf(token.nextToken());
		    break;
		case Dyn.eSave_Dyn_access: 
		    access = Integer.valueOf(token.nextToken());
		    break;
		case Dyn.eSave_Dyn_cycle: 
		    cycle = Integer.valueOf(token.nextToken());
		    break;
		case Dyn.eSave_DigLowColor: 
		    elem = (DynElem) new DynDigLowColor(this); 
		    break;
		case Dyn.eSave_DigColor: 
		    elem = (DynElem) new DynDigColor(this); 
		    break;
		case Dyn.eSave_DigWarning: 
		    elem = (DynElem) new DynDigWarning(this); 
		    break;
		case Dyn.eSave_DigError: 
		    elem = (DynElem) new DynDigError(this); 
		    break;
		case Dyn.eSave_DigFlash: 
		    elem = (DynElem) new DynDigFlash(this); 
		    break;
		case Dyn.eSave_Invisible: 
		    elem = (DynElem) new DynInvisible(this); 
		    break;
		case Dyn.eSave_DigBorder: 
		    elem = (DynElem) new DynDigBorder(this); 
		    break;
		case Dyn.eSave_DigText: 
		    elem = (DynElem) new DynDigText(this); 
		    break;
		case Dyn.eSave_Value: 
		    elem = (DynElem) new DynValue(this); 
		    break;
		case Dyn.eSave_ValueInput: 
		    elem = (DynElem) new DynValueInput(this); 
		    break;
		case Dyn.eSave_AnalogColor: 
		    elem = (DynElem) new DynAnalogColor(this); 
		    break;
		case Dyn.eSave_Rotate: 
		    elem = (DynElem) new DynRotate(this); 
		    break;
		case Dyn.eSave_Move: 
		    elem = (DynElem) new DynMove(this); 
		    break;
		case Dyn.eSave_AnalogShift: 
		    elem = (DynElem) new DynAnalogShift(this); 
		    break;
		case Dyn.eSave_DigShift: 
		    elem = (DynElem) new DynDigShift(this); 
		    break;
		case Dyn.eSave_DigFourShift: 
		    elem = (DynElem) new DynDigFourShift(this); 
		    break;
		case Dyn.eSave_ScrollingText: 
		    elem = (DynElem) new DynScrollingText(this); 
		    break;
		case Dyn.eSave_ColorThemeLightness: 
		    elem = (DynElem) new DynColorThemeLightness(this); 
		    break;
		case Dyn.eSave_DigBackgroundColor: 
		    elem = (DynElem) new DynDigBackgroundColor(this); 
		    break;
		case Dyn.eSave_DigSwap: 
		    elem = (DynElem) new DynDigSwap(this); 
		    break;
		case Dyn.eSave_DigScript: 
		    elem = (DynElem) new DynDigScript(this); 
		    break;
		case Dyn.eSave_RefUpdate: 
		    elem = (DynElem) new DynRefUpdate(this); 
		    break;
		case Dyn.eSave_Animation: 
		    elem = (DynElem) new DynAnimation(this); 
		    break;
		case Dyn.eSave_Video: 
		    elem = (DynElem) new DynVideo(this); 
		    break;
		case Dyn.eSave_Bar: 
		    elem = (DynElem) new DynBar(this); 
		    break;
		case Dyn.eSave_Trend: 
		    elem = (DynElem) new DynTrend(this); 
		    break;
		case Dyn.eSave_FillLevel: 
		    elem = (DynElem) new DynFillLevel(this); 
		    break;
		case Dyn.eSave_FastCurve: 
		    elem = (DynElem) new DynFastCurve(this); 
		    break;
		case Dyn.eSave_AnalogText: 
		    elem = (DynElem) new DynAnalogText(this); 
		    break;
		case Dyn.eSave_Table: 
		    elem = (DynElem) new DynTable(this); 
		    break;
		case Dyn.eSave_StatusColor: 
		    elem = (DynElem) new DynStatusColor(this); 
		    break;
		case Dyn.eSave_Pie: 
		    elem = (DynElem) new DynPie(this); 
		    break;
		case Dyn.eSave_BarChart: 
		    elem = (DynElem) new DynBarChart(this); 
		    break;
		case Dyn.eSave_Axis: 
		    elem = (DynElem) new DynAxis(this); 
		    break;
		case Dyn.eSave_DigTextColor: 
		    elem = (DynElem) new DynDigTextColor(this); 
		    break;
		case Dyn.eSave_TimeoutColor: 
		    elem = (DynElem) new DynTimeoutColor(this); 
		    break;
		case Dyn.eSave_HostObject: 
		    elem = (DynElem) new DynHostObject(this); 
		    break;
		case Dyn.eSave_DigSound: 
		    elem = (DynElem) new DynDigSound(this); 
		    break;
		case Dyn.eSave_XY_Curve: 
		    elem = (DynElem) new DynXY_Curve(this); 
		    break;
		case Dyn.eSave_DigCommand: 
		    elem = (DynElem) new DynDigCommand(this); 
		    break;
		case Dyn.eSave_PopupMenu: 
		    elem = (DynElem) new DynPopupMenu(this); 
		    break;
		case Dyn.eSave_SetDig: 
		    elem = (DynElem) new DynSetDig(this); 
		    break;
		case Dyn.eSave_ResetDig: 
		    elem = (DynElem) new DynResetDig(this); 
		    break;
		case Dyn.eSave_ToggleDig: 
		    elem = (DynElem) new DynToggleDig(this); 
		    break;
		case Dyn.eSave_StoDig: 
		    elem = (DynElem) new DynStoDig(this); 
		    break;
		case Dyn.eSave_Command: 
		    elem = (DynElem) new DynCommand(this); 
		    break;
		case Dyn.eSave_CommandDC: 
		    elem = (DynElem) new DynCommandDoubleClick(this); 
		    break;
		case Dyn.eSave_Confirm: 
		    elem = (DynElem) new DynConfirm(this); 
		    break;
		case Dyn.eSave_IncrAnalog: 
		    elem = (DynElem) new DynIncrAnalog(this); 
		    break;
		case Dyn.eSave_RadioButton: 
		    elem = (DynElem) new DynRadioButton(this); 
		    break;
		case Dyn.eSave_Slider: 
		    elem = (DynElem) new DynSlider(this); 
		    break;
		case Dyn.eSave_TipText: 
		    elem = (DynElem) new DynTipText(this); 
		    break;
		case Dyn.eSave_Help: 
		    elem = (DynElem) new DynHelp(this); 
		    break;
		case Dyn.eSave_OpenGraph: 
		    elem = (DynElem) new DynOpenGraph(this); 
		    break;
		case Dyn.eSave_OpenURL: 
		    elem = (DynElem) new DynOpenURL(this); 
		    break;
		case Dyn.eSave_InputFocus: 
		    elem = (DynElem) new DynInputFocus(this); 
		    break;
		case Dyn.eSave_CloseGraph: 
		    elem = (DynElem) new DynCloseGraph(this); 
		    break;
		case Dyn.eSave_PulldownMenu: 
		    elem = (DynElem) new DynPulldownMenu(this); 
		    break;
		case Dyn.eSave_OptionMenu: 
		    elem = (DynElem) new DynOptionMenu(this); 
		    break;
		case Dyn.eSave_SetValue: 
		    elem = (DynElem) new DynSetValue(this); 
		    break;
		case Dyn.eSave_MethodToolbar: 
		    elem = (DynElem) new DynMethodToolbar(this); 
		    break;
		case Dyn.eSave_MethodPulldownMenu: 
		    elem = (DynElem) new DynMethodPulldownMenu(this); 
		    break;
		case Dyn.eSave_Script: 
		    elem = (DynElem) new DynScript(this); 
		    break;
		case Dyn.eSave_CatchSignal: 
		    elem = (DynElem) new DynCatchSignal(this); 
		    break;
		case Dyn.eSave_EmitSignal: 
		    elem = (DynElem) new DynEmitSignal(this); 
		    break;
		case Dyn.eSave_End:
		    end_found = true;
		    break;
		default:
		    System.out.println( "Syntax error in Dyn");
		    break;
		}
		if ( elem != null) {
		    elements.add(elem);
		    elem.open(reader);
		}

		if ( end_found)
		    break;
	    }
		
	} catch ( Exception e) {
	    System.out.println( "IOException GrowRect");
	}
    }

    int getColor1(GrowNode object, int color) {
	if ( color == Glow.eDrawType_Inherit) {
	    return object.getClassTraceColor1();
	}
	return color;
    }
    int getColor2(GrowNode object, int color) {
	if ( color == Glow.eDrawType_Inherit) {
	    return object.getClassTraceColor2();
	}
	return color;
    }

    int getDynType1(GrowNode object) {
	if ( object != null && (dyn_type1 & Dyn.mDynType1_Inherit) != 0)
	    return object.getClassDynType1();
	return dyn_type1;
    }

    int getDynType2(GrowNode object) {
	if ( object != null && (dyn_type1 & Dyn.mDynType1_Inherit) != 0)
	    return object.getClassDynType2();
	return dyn_type2;
    }

    int getActionType1(GrowNode object) {
	if ( object != null && (action_type1 & Dyn.mActionType1_Inherit) != 0)
	    return object.getClassActionType1();
	return action_type1;
    }

    int getActionType2(GrowNode object) {
	if ( object != null && (action_type1 & Dyn.mDynType1_Inherit) != 0)
	    return object.getClassActionType2();
	return action_type2;
    }

    String getHostObject() {
	for ( int i = 0; i < elements.size(); i++) {
	    if ( (elements.get(i).dyn_type1 & Dyn.mDynType1_HostObject) != 0)
		return ((DynHostObject)elements.get(i)).hostobject;
	}
	return "";
    }

    boolean getDig( int p, int a_typeid, int bitmask, int db) {
	switch ( a_typeid) {
	case Pwr.eType_Boolean: {
	    boolean value = false;
	    switch ( db) {
	    case GraphIfc.eDatabase_Gdh:
		value = graph.getGdh().getObjectRefInfoBoolean( p);
		break;
	    case GraphIfc.eDatabase_Local:
		value = graph.getLdb().getObjectRefInfoBoolean( p);
		break;
	    }	
	    return value;
	}
	case Pwr.eType_Int32:
	case Pwr.eType_UInt32:
	case Pwr.eType_Int64:
	case Pwr.eType_UInt64: {
	    int value = 0;
	    switch ( db) {
	    case GraphIfc.eDatabase_Gdh:
		value = graph.getGdh().getObjectRefInfoInt( p);
		break;
	    case GraphIfc.eDatabase_Local:
		value = graph.getLdb().getObjectRefInfoInt( p);
		break;
	    }	
	    return value != 0;
	}
	case GraphIfc.eType_Bit: {
	    int value = 0;
	    switch ( db) {
	    case GraphIfc.eDatabase_Gdh:
		value = graph.getGdh().getObjectRefInfoInt( p);
		break;
	    case GraphIfc.eDatabase_Local:
		value = graph.getLdb().getObjectRefInfoInt( p);
		break;
	    }
	    return (value & bitmask) != 0;
	}
	case Pwr.eType_Float32:
	case Pwr.eType_Float64: {
	    float value = 0;
	    switch ( db) {
	    case GraphIfc.eDatabase_Gdh:
		value = graph.getGdh().getObjectRefInfoFloat( p);
		break;
	    case GraphIfc.eDatabase_Local:
		value = graph.getLdb().getObjectRefInfoFloat( p);
		break;
	    }	
	    return value > Float.MIN_VALUE;
	}
	case Pwr.eType_String: {
	    switch ( db) {
	    case GraphIfc.eDatabase_Gdh: {
		String value = graph.getGdh().getObjectRefInfoString( p, a_typeid);
		return !value.equals("");
	    }	
	    }
	    return false;
	}
	default:
	    return false;
	}
    }

    int getBit( String str, int attr_type) {
	if ( attr_type == GraphIfc.eType_Bit) {
	    // Get bit number from parsed name
	    int idx1, idx2;
	    int bitnum;

	    if ( (idx1 = str.indexOf('[')) != -1 &&
		 (idx2 = str.indexOf(']')) != -1 &&
		 idx2 > idx1) {
		try {
		    bitnum = new Integer(str.substring(idx1+1, idx2)).intValue();
		}
		catch( NumberFormatException e) {
		    return 0;
		}
		if ( bitnum >= 0 && bitnum < 32) {
		    return 1 << bitnum;
		}
	    }
	}
	return 0;
    }

    public void setTotal( GlowArrayElem object) {
	if ( object == null) {
	    total_dyn_type1 = dyn_type1;
	    total_dyn_type2 = dyn_type2;
	    total_action_type1 = action_type1;
	    total_action_type2 = action_type2;
	}
	else {
	    if ( (dyn_type1 & Dyn.mDynType1_Inherit) != 0) {
		int inherit_dyn_type1 = object.getClassDynType1();
		int inherit_dyn_type2 = object.getClassDynType2();
		total_dyn_type1 = dyn_type1 | inherit_dyn_type1;
		total_dyn_type2 = dyn_type2 | inherit_dyn_type2;
	    }
	    else {
		total_dyn_type1 = dyn_type1;
		total_dyn_type2 = dyn_type2;
	    }
	    
	    if ( (action_type1 & Dyn.mActionType1_Inherit) != 0) {
		int inherit_action_type1 = object.getClassActionType1();
		int inherit_action_type2 = object.getClassActionType2();
		total_action_type1 = action_type1 | inherit_action_type1;
		total_action_type2 = action_type2 | inherit_action_type2;
	    }
	    else {
		total_action_type1 = action_type1;
		total_action_type2 = action_type2;
	    }
	}
    }

    public DynParsedAttrName parseAttrName(String name) {
	return parseAttrName( name, 0);
    }
    public DynParsedAttrName parseAttrName(String name, int options) {
	if ( name == null)
	    return null;
	if ( (total_dyn_type1 & Dyn.mDynType1_HostObject) != 0) {
	    int idx = name.indexOf("$hostobject");
	    if ( idx != -1) {
		String hostobject = getHostObject();
		String n = name.substring(0, idx) + hostobject + name.substring(idx+11);
		return graph.parseAttrName( n);
	    }	    
	}

	return graph.parseAttrName( name, options);
    }

    public int connect(GlowArrayElem object) {

	if ( (dyn_type1 & Dyn.mDynType1_Inherit) != 0) {
	    int inherit_dyn_type1 = object.getClassDynType1();
	    int inherit_dyn_type2 = object.getClassDynType2();
	    total_dyn_type1 = dyn_type1 | inherit_dyn_type1;
	    total_dyn_type2 = dyn_type2 | inherit_dyn_type2;
	}
	else {
	    total_dyn_type1 = dyn_type1;
	    total_dyn_type2 = dyn_type2;
	}

	if ( (action_type1 & Dyn.mActionType1_Inherit) != 0) {
	    int inherit_action_type1 = object.getClassActionType1();
	    int inherit_action_type2 = object.getClassActionType2();
	    total_action_type1 = action_type1 | inherit_action_type1;
	    total_action_type2 = action_type2 | inherit_action_type2;
	}
	else {
	    total_action_type1 = action_type1;
	    total_action_type2 = action_type2;
	}

	if ( cycle == Glow.eCycle_Inherit)
	    cycle = object.getClassCycle();

	for ( int i = 0; i < elements.size(); i++) {
	    elements.get(i).connect(object);
	}
	return 1;
    }


    public void disconnect() {
	for ( int i = 0; i < elements.size(); i++) {
	    elements.get(i).disconnect();
	}
    }

    public void scan(GlowArrayElem object) {
	repaintNow = false;
	ignoreColor = false;
	resetColor = false;
	ignoreBgColor = false;
	resetBgColor = false;

	for ( int i = 0; i < elements.size(); i++) {
	    elements.get(i).scan(object);
	}	
	if ( repaintNow)
	    object.draw();
    }

    int action(GlowArrayElem object, GlowEvent event) {
	int sts;
	for ( int i = 0; i < elements.size(); i++) {
	    sts = elements.get(i).action(object, event);
	    if ( sts == Dyn.DYN__NO_PROPAGATE || sts == Glow.GLOW__TERMINATED ||
		 sts == Glow.GLOW__SUBTERMINATED)
		return sts;
	}
	return 1;
    }

    public void confirmedAction( int event, Object object) {
	if ( elements == null)
	    return;

	GlowEvent e = new GlowEvent();
	e.event = event;	
	e.object = (GlowArrayElem)object;
	action_type1 &= ~mActionType1_Confirm;
	for ( int i = 0; i < elements.size(); i++)
	    elements.get(i).action((GlowArrayElem)object,  e);
	action_type1 |= mActionType1_Confirm;
    }    

    public int instance_to_number( int instance) {
	int inst = 1;
	int m = instance;
	while( m > 1) {
	    m = m >> 1;
	    inst++;
	}
	return inst;
    }

    public class DynElem {
	Dyn dyn;
	int dyn_type1;
	int dyn_type2;
	int action_type1;
	int action_type2;
	int prio;
	int instance_mask;
	int instance;

	DynElem(Dyn dyn, int dyn_type1, int dyn_type2, int action_type1, int action_type2, int prio) {
	    this.dyn = dyn;
	    this.dyn_type1 = dyn_type1;
	    this.dyn_type2 = dyn_type2;
	    this.action_type1 = action_type1;
	    this.action_type2 = action_type2;
	    this.prio = prio;
	}
	DynElem( DynElem x) {
	    this.dyn = x.dyn;
	    this.dyn_type1 = x.dyn_type1;
	    this.dyn_type2 = x.dyn_type2;
	    this.action_type1 = x.action_type1;
	    this.action_type2 = x.action_type2;
	    this.instance_mask = x.instance_mask;
	    this.instance = x.instance;
	}
	public int getDynType1() {return dyn_type1;}
	public void open( BufferedReader reader) {}
	public int connect(GlowArrayElem object) {return 0;}
	public void disconnect() {}
	public void scan(GlowArrayElem object) {}
	public int action(GlowArrayElem object, GlowEvent event) {return 0;}
    }

    public class DynDigLowColor extends DynElem {
	String attribute;
	int color;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	
	public DynDigLowColor( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigLowColor, 0, 0, 0, Dyn.eDynPrio_DigLowColor);
	}

	public DynDigLowColor( DynDigLowColor x) {
	    super(x);
	    color = x.color;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    color = dyn.getColor1(object, color);
	    if ( color < 0 || color >= Glow.eDrawType__)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Local:
		ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigLowColor: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor)
		    return;
	    }
	    else
		firstScan = false;
	
	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( !value) {
		    if ( color >= Glow.eDrawTone__)
			object.setFillColor( color);
		    else
			object.setColorTone( color);
		}
		else {
		    if ( color >= Glow.eDrawTone__)
			object.resetFillColor();
		    object.resetColorTone();
		}
		dyn.repaintNow = true;
	    }
	    else {
		if ( !value)
		    object.setFillColor( color);
		else 
		    object.resetFillColor();		
		dyn.repaintNow = true;
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigLowColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigLowColor: 
			break;
		    case Dyn.eSave_DigLowColor_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigLowColor_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigLowColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigLowColor");
	    }
	}

    }

    public class DynDigColor extends DynElem {
	String attribute;
	int color;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;

	public DynDigColor( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigColor, 0, 0, 0, Dyn.eDynPrio_DigColor);
	}

	public DynDigColor( DynDigColor x) {
	    super(x);
	    color = x.color;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    color = dyn.getColor2(object, color);
	    if ( color < 0 || color >= Glow.eDrawType__)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigColor: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor) {
		    // No change since last time
		    if ( value)
			dyn.ignoreColor = true;
		    return;
		}
	    }
	    else
		firstScan = false;
	
	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( value) {
		    if ( color >= Glow.eDrawTone__) {
			if ( dyn.resetColor)
			    object.resetFillColor();
			object.setFillColor(color);
		    }
		    else
			object.setColorTone( color);
		    dyn.ignoreColor = true;
		}
		else {
		    if ( color >= Glow.eDrawTone__)
			object.resetFillColor();
		    object.resetColorTone();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    else {
		if ( value) {
		    object.setFillColor( color);
		    dyn.ignoreColor = true;
		}
		else {
		    object.resetFillColor();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigColor: 
			break;
		    case Dyn.eSave_DigColor_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigColor_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigColor_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigColor_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigColor");
	    }
	}

    }

    public class DynDigWarning extends DynElem {
	String attribute;
        int use_colortheme;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	

	public DynDigWarning( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigWarning, 0, 0, 0, Dyn.eDynPrio_DigWarning);
	}

	public DynDigWarning( DynDigWarning x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigWarning: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor) {
		    // No change since last time
		    if ( value)
			dyn.ignoreColor = true;
		    return;
		}
	    }
	    else
		firstScan = false;
	
	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( value) {
		    object.setColorTone( Glow.eDrawTone_Yellow);
 		    dyn.ignoreColor = true;
		}
		else {
		    object.resetFillColor();
		    object.resetColorTone();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    else {
		if (  value) {
		    object.setFillColor( (use_colortheme != 0) ? Glow.eDrawType_CustomColor41 : Glow.eDrawType_ColorYellow);
		    dyn.ignoreColor = true;
		}
		else {
		    object.resetFillColor();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynWarning : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigWarning: 
			break;
		    case Dyn.eSave_DigWarning_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigWarning_use_colortheme:
			use_colortheme = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigWarning");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigWarning");
	    }
	}

    }

    public class DynDigError extends DynElem {
	String attribute;
	int use_colortheme;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;

	public DynDigError( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigError, 0, 0, 0, Dyn.eDynPrio_DigError);
	}

	public DynDigError( DynDigError x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigError: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor) {
		    // No change since last time
		    if ( value)
			dyn.ignoreColor = true;
		    return;
		}
	    }
	    else
		firstScan = false;
	
	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( value) {
		    object.setColorTone( Glow.eDrawTone_Red);
 		    dyn.ignoreColor = true;
		}
		else {
		    object.resetFillColor();
		    object.resetColorTone();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    else {
		if (  value) {
		    object.setFillColor( (use_colortheme != 0) ? Glow.eDrawType_CustomColor11 : Glow.eDrawType_ColorRed);
		    dyn.ignoreColor = true;
		}
		else {
		    object.resetFillColor();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynError : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigError: 
			break;
		    case Dyn.eSave_DigError_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigError_use_colortheme:
			use_colortheme = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigError");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigError");
	    }
	}

    }

    public class DynDigFlash extends DynElem {
	String attribute;
	int color;
	int color2;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	boolean on;

	public DynDigFlash( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigFlash, 0, 0, 0, Dyn.eDynPrio_DigFlash);
	}

	public DynDigFlash( DynDigFlash x) {
	    super(x);
	    color = x.color;
	    color2 = x.color2;
	    on = x.on;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigFlash: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor) {
		    // No change since last time
		    if ( !value)
			return;
		}
	    }
	    else
		firstScan = false;
	
	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( value) {
		    if ( on) {
			if ( color >= Glow.eDrawTone__)
			    object.setColorTone(color);
			else
			    object.setFillColor(color);
			dyn.ignoreColor = true;
		    }
		    else {
			object.resetFillColor();
			object.resetColorTone();
			dyn.resetColor = true;
		    }
		    on = !on;
		}
		else {
		    object.resetFillColor();
		    object.resetColorTone();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    else {
		if (  value) {
		    if ( on) {
			object.setFillColor(color);
			dyn.ignoreColor = true;
		    }
		    else {
			if ( color2 == Glow.eDrawType_Inherit) {
			    object.resetFillColor();
			    dyn.resetColor = true;
			}
			else {
			    object.setFillColor(color2);
			    dyn.ignoreColor = true;
			}
		    }
		    on = !on;
		}
		else {
		    object.resetFillColor();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigFlash : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigFlash: 
			break;
		    case Dyn.eSave_DigFlash_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigFlash_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigFlash_color2: 
			color2 = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigFlash");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigFlash");
	    }
	}

    }

    public class DynInvisible extends DynElem {
	String attribute;
	int dimmed;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	boolean cmd;
	String command;

	public DynInvisible( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Invisible, 0, 0, 0, Dyn.eDynPrio_Invisible);
	}

	public DynInvisible( DynInvisible x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {

	    if ( attribute != null && attribute.toLowerCase().startsWith("$cmd(")) {
		cmd = true;
		int idx = attribute.lastIndexOf(')');
		if ( idx != -1 && idx > 5)
		    command = attribute.substring(5, idx);
		else
		    command = attribute.substring(5);
		command = graph.getCommand(command);
	    }
	    else {
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		if ( pname == null || pname.name.equals("")) 
		    return 1;

		GdhrRefObjectInfo ret = null;
		
		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		case GraphIfc.eDatabase_Local:
		    ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("DigFlash: " + attribute);
		    return 1;
		}

		p = ret.id;
		subid = ret.refid;
		inverted = pname.inverted;
		a_typeid = pname.type;
		bitmask = pname.bitmask;
		database = pname.database;
		attrFound = true;
	    }
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	public void scan( GlowArrayElem o) {

	    if ( cmd) {
		if ( firstScan) {
		    int sts = dyn.graph.command(command);
		    System.out.println( "DynInvisible: " + command + ", value: " + sts);
		    if ( sts == 0) {
			if ( dimmed == 0)
			    o.setVisibility( Glow.eVis_Invisible);
			else
			    o.setVisibility( Glow.eVis_Dimmed);
		    }
		    firstScan = false;
		}
		return;
	    }

	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( a_typeid == Pwr.eType_String)
		value = !value;

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor) {
		    // No change since last time
		    if ( !value)
			return;
		}
	    }
	    else
		firstScan = false;

	    if ( value) {
		if ( dimmed == 0)
		    o.setVisibility( Glow.eVis_Invisible);
		else
		    o.setVisibility( Glow.eVis_Dimmed);
	    }
	    else {
		o.setVisibility( Glow.eVis_Visible);
	    }
	    dyn.repaintNow = true;
	    oldValue = value;
	}
	
	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynInvisible : " + line);

		    switch ( key) {
		    case Dyn.eSave_Invisible: 
			break;
		    case Dyn.eSave_Invisible_attribute: 
			if ( token.hasMoreTokens())
			    attribute = line.substring(4);
			break;
		    case Dyn.eSave_Invisible_dimmed: 
			dimmed = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Invisible_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Invisible_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynInvisible");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynInvisible");
	    }
	}

    }

    public class DynDigTextColor extends DynElem {
	String attribute;
	int color;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	
	public DynDigTextColor( Dyn dyn) {
	    super(dyn, Dyn.mDynType2_DigTextColor, 0, 0, 0, Dyn.eDynPrio_DigTextColor);
	}

	public DynDigTextColor( DynDigTextColor x) {
	    super(x);
	    color = x.color;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    color = dyn.getColor1(object, color);
	    if ( color < 0 || color >= Glow.eDrawType__)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Local:
		ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigTextColor: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor)
		    return;
	    }
	    else
		firstScan = false;
	
	    if ( value)
		object.setTextColor( color);
	    else 
		object.resetTextColor();		
	    dyn.repaintNow = true;

	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigTextColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigTextColor: 
			break;
		    case Dyn.eSave_DigTextColor_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigTextColor_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigTextColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigTextColor");
	    }
	}

    }


    public class DynDigBorder extends DynElem {
	String attribute;
	int color;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;

	public DynDigBorder( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigBorder, 0, 0, 0, Dyn.eDynPrio_DigBorder);
	}

	public DynDigBorder( DynDigBorder x) {
	    super(x);
	    color = x.color;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigBorder: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value) {
		    // No change since last time
		    return;
		}
	    }
	    else
		firstScan = false;
	
	    if ( value) {
		object.setBorderColor(color);
	    }
	    else {
		object.resetBorderColor();
	    }
	    dyn.repaintNow = true;
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigBorder : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigBorder: 
			break;
		    case Dyn.eSave_DigBorder_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigBorder_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigBorder");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigBorder");
	    }
	}

    }

    public class DynDigText extends DynElem {
	String attribute;
	String low_text;
	String high_text;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;

	public DynDigText( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigText, 0, 0, 0, Dyn.eDynPrio_DigText);
	}

	public DynDigText( DynDigText x) {
	    super(x);
	    attribute = x.attribute;
	    low_text = x.low_text;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    if ( low_text == null)
		return 1;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigText: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    high_text = object.getAnnotation(1);
	    if ( high_text == null)
		high_text = new String();
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}
	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value)
		    return;
	    }
	    else
		firstScan = false;
	
	    if ( value)
		object.setAnnotation(1, high_text);
	    else
		object.setAnnotation(1, low_text);
	    dyn.repaintNow = true;
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigText : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigText: 
			break;
		    case Dyn.eSave_DigText_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigText_low_text: 
			if ( token.hasMoreTokens())
			    low_text = line.substring(5);
			break;
		    case Dyn.eSave_DigText_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigText_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigText");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigText");
	    }
	}

    }

    public class DynValue extends DynElem {
	String attribute;
	String format;
	int zero_blank;
	String decimals_attr;
	int decimals_decr;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	public boolean oldValueB;
	public float oldValueF;
	public int oldValueI;
	public String oldValueS;
	GlowCFormat	cFormat;
	StringBuffer sb = new StringBuffer();

	public DynValue( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Value, 0, 0, 0, Dyn.eDynPrio_Value);
	}

	public DynValue( DynValue x) {
	    super(x);
	    attribute = x.attribute;
	    zero_blank = x.zero_blank;
	    format = x.format;
	}

	public String read_decimals( Dyn dyn, String attr, int decr, String format) {
	    int 	decimals;

	    DynParsedAttrName pname = dyn.parseAttrName(attr);
	    if ( pname == null || pname.name.equals("")) 
		return format;
	    
	    switch ( pname.type) {
	    case Pwr.eType_Int32:
	    case Pwr.eType_UInt32:
	    case Pwr.eType_Enum:
	    case Pwr.eType_Mask:
		break;
	    default:
		return format;
	    }

	    CdhrInt ret = dyn.graph.getGdh().getObjectInfoInt( pname.name);
	    if ( ret.evenSts()) return format;

	    decimals = ret.value - decr;
	    if ( decimals < 0)
		decimals = 0;
	    if ( decimals >= 10)
		return format;

	    if ( format == null)
		return "%." + decimals + "f";

	    // Print format, of replace digit between . and f
	    int s = format.indexOf( 'f');
	    if ( s == -1)
		return "%." + decimals + "f";
	    else {
		if ( s < 2 || format.charAt(s-2) != '.')
		    return "%." + decimals + "f";
		else
		    return format.substring( 0, s-1) + decimals + format.substring(s);
	    }
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( format == null && decimals_attr == null)
		return 1;

	    if ( decimals_attr != null && !decimals_attr.isEmpty()) {
		format = read_decimals( dyn, decimals_attr, decimals_decr, format);
		System.out.println( "read_decimals " + format);
	    }
	    if ( format == null)
		return 1;
	    cFormat = new GlowCFormat(format);


	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		//System.out.println("DynValue refobjectinfo " + pname.tname);
		ret = dyn.graph.refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Local:
		ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Value: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    //System.out.println( "DynValue.connect " + attribute + " " + ret.id + " " + pname.type);

		
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;

	    int annot_num = dyn.instance_to_number( instance);

	    switch ( a_typeid) {
	    case Pwr.eType_Float32: {
		float value0 = 0;
		switch ( database) {
		case GraphIfc.eDatabase_Gdh:
		    value0 = dyn.graph.getGdh().getObjectRefInfoFloat( p);
		    break;
		case GraphIfc.eDatabase_Local:
		    value0 = dyn.graph.getLdb().getObjectRefInfoFloat( p);
		    break;
		}
		if ( value0 != oldValueF  || firstScan) {
		    if ( cFormat != null) {
		      sb = cFormat.format( value0, sb);
	  	      object.setAnnotation(annot_num, new String(sb));
		    }
		    dyn.repaintNow = true;
		    oldValueF = value0;
		}
		break;
	    }
	    case Pwr.eType_Int32:
	    case Pwr.eType_UInt32:
	    case Pwr.eType_Int16:
	    case Pwr.eType_UInt16:
	    case Pwr.eType_Int8:
	    case Pwr.eType_UInt8: {
		int value0 = 0;
		switch ( database) {
		case GraphIfc.eDatabase_Gdh:
		    value0 = dyn.graph.getGdh().getObjectRefInfoInt( p);
		    break;
		case GraphIfc.eDatabase_Local:
		    value0 = dyn.graph.getLdb().getObjectRefInfoInt( p);
		    break;
		}

		if ( value0 != oldValueI || firstScan) {
		    sb = cFormat.format( value0, sb);
		    object.setAnnotation(annot_num, new String(sb));
		    dyn.repaintNow = true;
		    oldValueI = value0;
		}
		break;
	    }
	    case Pwr.eType_Boolean: {
		boolean value0 = false;
		switch ( database) {
		case GraphIfc.eDatabase_Gdh:
		    value0 = dyn.graph.getGdh().getObjectRefInfoBoolean( p);
		    break;
		case GraphIfc.eDatabase_Local:
		    value0 = dyn.graph.getLdb().getObjectRefInfoBoolean( p);
		    break;
		}

		if ( value0 != oldValueB || firstScan) {
		    sb = cFormat.format( value0, sb);
		    object.setAnnotation(annot_num, new String(sb));
		    dyn.repaintNow = true;
		    oldValueB = value0;
		}
		break;
	    }
	    case Pwr.eType_String:
	    case Pwr.eType_Objid:
	    case Pwr.eType_Time:
	    case Pwr.eType_DeltaTime: {
		String value0 = null;
		switch ( database) {
		case GraphIfc.eDatabase_Gdh:
		    value0 = dyn.graph.getGdh().getObjectRefInfoString( p, a_typeid);
		    break;
		case GraphIfc.eDatabase_Local:
		    value0 = dyn.graph.getLdb().getObjectRefInfoString( p, a_typeid);
		    break;
		}

		if ( firstScan || !value0.equals( oldValueS)) {
		    sb = cFormat.format( value0, sb);
		    object.setAnnotation(annot_num, new String(sb));
		    dyn.repaintNow = true;
		    oldValueS = value0;
		}
		break;
	    }
	    case Pwr.eType_Status:
	    case Pwr.eType_NetStatus: {
		int value0 = 0;
		switch ( database) {
		case GraphIfc.eDatabase_Gdh:
		    value0 = dyn.graph.getGdh().getObjectRefInfoInt( p);
		    break;
		case GraphIfc.eDatabase_Local:
		    value0 = dyn.graph.getLdb().getObjectRefInfoInt( p);
		    break;
		}
		if ( value0 != oldValueI || firstScan) {
		    switch ( cFormat.type()) {
		    case GlowCFormat.FRM_M: {
			CdhrString cstr = dyn.graph.getGdh().getMsg( value0);
			object.setAnnotation(annot_num, cstr.str);
			dyn.repaintNow = true;
			break;
		    }
		    case GlowCFormat.FRM_1M: {
			CdhrString cstr = dyn.graph.getGdh().getMsgText( value0);
			object.setAnnotation(annot_num, cstr.str);
			dyn.repaintNow = true;
			break;
		    }
		    }
		}
		oldValueI = value0;
		break;
	    }
	    }
	    if ( firstScan)
		firstScan = false;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynValue : " + line);

		    switch ( key) {
		    case Dyn.eSave_Value: 
			break;
		    case Dyn.eSave_Value_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_Value_format: 
			if ( token.hasMoreTokens())
			    format = token.nextToken();
			break;
		    case Dyn.eSave_Value_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Value_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Value_zero_blank: 
			zero_blank = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Value_decimals_attr: 
			if ( token.hasMoreTokens())
			    decimals_attr = token.nextToken();
			break;
		    case Dyn.eSave_Value_decimals_decr: 
			decimals_decr = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynValue");
			break;
		    }

		    if ( end_found)
			break;
		}
		
		if ( format != null)
		    cFormat = new GlowCFormat(format);

	    } catch ( Exception e) {
		System.out.println( "IOException DynValue");
	    }
	}

    }

    public int valueInputAction( Object object, String str) {
	if ( elements == null)
	    return Dyn.eValueInput_Error;

	DynValueInput e = (DynValueInput)object;

	boolean cmn_popped = false;
	GrowCmn ocmn = (GrowCmn)((DynElem)object).dyn.object.getCmn();
	if ( e.dyn.graph.getCmn() != ocmn) {
	    e.dyn.graph.cmnPop( ocmn);
	    cmn_popped = true;
	}
	

	try {
	    PwrtStatus sts = null;
	    double minval = 0;
	    double maxval = 0;
	    if ( e.minvalue_attr != null) {
		DynParsedAttrName pname = e.dyn.parseAttrName(e.minvalue_attr);
		if ( pname != null && pname.type == Pwr.eType_Float32) {
		    CdhrFloat ret = e.dyn.graph.getGdh().getObjectInfoFloat( pname.name);
		    if ( ret.evenSts()) {
			if ( cmn_popped)
			    e.dyn.graph.cmnPush();
			return Dyn.eValueInput_Error;
		    }
		    minval = ret.value;
		}
		else 
		    minval = e.min_value;
	    }
	    else
		minval = e.min_value;

	    if ( e.maxvalue_attr != null) {
		DynParsedAttrName pname = e.dyn.parseAttrName(e.maxvalue_attr);
		if ( pname == null || pname.name.equals("")) 
		    maxval = e.max_value;
		else {
		    if ( pname.type == Pwr.eType_Float32) {
			CdhrFloat ret = e.dyn.graph.getGdh().getObjectInfoFloat( pname.name);
			if ( ret.evenSts()) {
			    if ( cmn_popped)
				e.dyn.graph.cmnPush();
			    return Dyn.eValueInput_Error;
			}
			maxval = ret.value;
		    }
		    else
			maxval = e.max_value;
		}
	    }
	    else
		maxval = e.max_value;

	    switch ( e.a_typeid) {
	    case Pwr.eType_Float32: {
		float inputValue = Float.parseFloat( str.trim());
		if ( minval != 0 && maxval != 0 && inputValue < minval) {
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_MinValueExceeded;
		}
		if ( minval != 0 && maxval != 0 && inputValue > maxval) {
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_MaxValueExceeded;
		}
		
		DynParsedAttrName pname = e.dyn.parseAttrName(e.value_element.attribute);
		if ( pname == null || pname.name.equals(""))
		    break;
		    
		switch ( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = e.dyn.graph.getGdh().setObjectInfo( pname.name, inputValue);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = e.dyn.graph.getLdb().setObjectInfo( graph, pname.name, inputValue);
		    break;
		default:
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}
		if ( sts.evenSts()) {
		    System.out.println( "setObjectInfoError " + sts);
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}
		break;
	    }
	    case Pwr.eType_Int32:
	    case Pwr.eType_UInt32:
	    case Pwr.eType_Int16:
	    case Pwr.eType_UInt16:
	    case Pwr.eType_Int8:
	    case Pwr.eType_UInt8: {
		int inputValue = Integer.parseInt( str.trim(), 10);
		if ( minval != 0 && maxval != 0 && inputValue < minval) {
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_MinValueExceeded;
		}
		if ( minval != 0 && maxval != 0 && inputValue > maxval ) {
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_MaxValueExceeded;
		}

		DynParsedAttrName pname = e.dyn.parseAttrName(e.value_element.attribute);
		if ( pname == null || pname.name.equals(""))
		    break;
		    
		switch ( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = e.dyn.graph.getGdh().setObjectInfo( pname.name, inputValue);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = e.dyn.graph.getLdb().setObjectInfo( graph, pname.name, inputValue);
		    break;
		default:
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}
		if ( sts.evenSts()) {
		    System.out.println( "setObjectInfoError " + sts);
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}		
		break;
	    }
	    case Pwr.eType_Boolean: {
		int inputValueInt = Integer.parseInt( str.trim(), 10);
		boolean inputValue;
		if ( inputValueInt == 0)
		    inputValue = false;
		else if ( inputValueInt == 1)
		    inputValue = true;
		else
		    break;

		// valueElement.oldValueB = inputValue;

		DynParsedAttrName pname = e.dyn.parseAttrName(e.value_element.attribute);
		if ( pname == null || pname.name.equals(""))
		    break;
		    
		switch ( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = e.dyn.graph.getGdh().setObjectInfo( pname.name, inputValue);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = e.dyn.graph.getLdb().setObjectInfo( graph, pname.name, inputValue);
		    break;
		default:
		    return Dyn.eValueInput_Error;
		}
		if ( sts.evenSts()) {
		    System.out.println( "setObjectInfoError " + sts);
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}
		break;
	    }
	    case Pwr.eType_String: {
		// valueElement.oldValueS = str;

		DynParsedAttrName pname = e.dyn.parseAttrName(e.value_element.attribute);
		if ( pname == null || pname.name.equals(""))
		    break;
		    
		switch ( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = e.dyn.graph.getGdh().setObjectInfo( pname.name, str);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = e.dyn.graph.getLdb().setObjectInfo( graph, pname.name, str);
		    break;
		default:
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}
		if ( sts.evenSts()) {
		    System.out.println( "setObjectInfoError " + sts);
		    if ( cmn_popped)
			e.dyn.graph.cmnPush();
		    return Dyn.eValueInput_Error;
		}
		break;
	    }
	    }
	    if ( cmn_popped)
		e.dyn.graph.cmnPush();
	}
	catch(NumberFormatException ex) {
	    System.out.println( ex.toString() );
 	    return Dyn.eValueInput_SyntaxError;
	}	
	return Dyn.eValueInput_Success;
    }

    public class DynValueInput extends DynElem {
	String attribute;
	double min_value;
	double max_value;
	int clear;
	int popup;
	int unselect;
	String minvalue_attr;
	String maxvalue_attr;
	int escape_store;
	int keyboard_type;
	int update_open;
	DynValue value_element;
	int a_typeid;

	public DynValueInput( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_ValueInput, 0, Dyn.eDynPrio_ValueInput);
	}

	public DynValueInput( DynValueInput x) {
	    super(x);
	    min_value = x.min_value;
	    max_value = x.max_value;
	    clear = x.clear;
	    popup = x.popup;
	    unselect = x.unselect;
	    escape_store = x.escape_store;	    
	    minvalue_attr = x.minvalue_attr;
	    maxvalue_attr = x.maxvalue_attr;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    // Get the Value element
	    value_element = null;
	    for ( int j = 0; j < dyn.elements.size(); j++) {
		if ( dyn.elements.get(j).dyn_type1 == Dyn.mDynType1_Value) {
		    value_element = (DynValue)dyn.elements.get(j);
		    a_typeid = value_element.a_typeid;
		    break;
		}
	    }
	    
	    return 1;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Click:
		dyn.object = object;
		dyn.graph.openValueInputDialog( dyn, "Enter value", this);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynValueInput : " + line);

		    switch ( key) {
		    case Dyn.eSave_ValueInput: 
			break;
		    case Dyn.eSave_ValueInput_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_ValueInput_unselect: 
			unselect = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ValueInput_min_value: 
			min_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_ValueInput_max_value: 
			max_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_ValueInput_clear: 
			clear = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ValueInput_popup: 
			popup = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ValueInput_minvalue_attr: 
			if ( token.hasMoreTokens())
			    minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_ValueInput_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_ValueInput_escape_store: 
			escape_store = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ValueInput_keyboard_type: 
			keyboard_type = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ValueInput_update_open: 
			update_open = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynValueInput");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynValueInput");
	    }
	}

    }

    public class DynAnalogColor extends DynElem {
	String attribute;
	double limit;
	int limit_type;
	int color;
	int border;
	int common_attr = 1;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	float oldValueF;
	int oldValueI;
	boolean oldState;
	boolean isMainInstance = false;

	public DynAnalogColor( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_AnalogColor, 0, 0, 0, Dyn.eDynPrio_AnalogColor);
	}

	public DynAnalogColor( DynAnalogColor x) {
	    super(x);
	    attribute = x.attribute;
	    limit = x.limit;
	    limit_type = x.limit_type;
	    color = x.color;
	    border = x.border;
	    common_attr = x.common_attr;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    // Find the main instance
	    DynAnalogColor mainInstance = null;
	    for ( int i = dyn.elements.size() - 1; i >= 0; i--) {
		if ( dyn.elements.get(i).getDynType1() == Dyn.mDynType1_AnalogColor) {
		    mainInstance = (DynAnalogColor)dyn.elements.get(i);
		    break;
		}
	    }

	    if ( mainInstance != null) {
		common_attr = mainInstance.common_attr;
		if ( common_attr != 0) {
		    if ( !mainInstance.attrFound) {
			DynParsedAttrName pname = dyn.parseAttrName(mainInstance.attribute);
			if ( pname == null || pname.name.equals("")) 
			    return 1;

			GdhrRefObjectInfo ret = null;

			switch( pname.database) {
			case GraphIfc.eDatabase_Gdh:
			    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
			    break;
			default:
			    ret = null;
			}

			if ( ret == null || ret.evenSts()) {
			    System.out.println("AnalogColor: " + mainInstance.attribute);
			    return 1;
			}

			mainInstance.attrFound = true;
			mainInstance.p = ret.id;
			mainInstance.subid = ret.refid;
			mainInstance.a_typeid = pname.type;
			mainInstance.isMainInstance = true;
			mainInstance.database = pname.database;
		    }
		    if ( !isMainInstance) {
			p = mainInstance.p;
			attrFound = mainInstance.attrFound;
			a_typeid = mainInstance.a_typeid;
			database = mainInstance.database;
		    }
		}
		else {
		    DynParsedAttrName pname = dyn.parseAttrName(attribute);
		    if ( pname == null || pname.name.equals("")) 
			return 1;

		    GdhrRefObjectInfo ret = null;

		    switch( pname.database) {
		    case GraphIfc.eDatabase_Gdh:
			ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
			break;
		    default:
			ret = null;
		    }

		    if ( ret == null || ret.evenSts()) {
			System.out.println("AnalogColor: " + attribute);
			return 1;
		    }

		    attrFound = true;
		    p = ret.id;
		    subid = ret.refid;
		    a_typeid = pname.type;
		    isMainInstance = true;
		    database = pname.database;
		}
	    }
	    return 1;
	}


	public void disconnect() {
	    if ( common_attr != 0) {
		if ( attrFound && database != GraphIfc.eDatabase_Local)
		    dyn.graph.getGdh().unrefObjectInfo(subid);
	    }
	    else if ( isMainInstance && attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}
	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;

	    boolean state = false;
	    boolean set_color = false;
	    boolean reset_color = false;

	    if ( a_typeid == Pwr.eType_Float32) {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( p);
		int i;

		if ( !firstScan) {
		    if ( !dyn.resetColor && value == oldValueF) {
			if ( oldState)
			    dyn.ignoreColor = true;
			return;
		    }
		}
		else
		    firstScan = false;

		switch ( limit_type) {
		case Dyn.eLimitType_Gt:
		    state = value > limit;
		    break;
		case Dyn.eLimitType_Lt:
		    state = value < limit;
		    break;
		case Dyn.eLimitType_Ge:
		    state = value >= limit;
		    break;
		case Dyn.eLimitType_Le:
		    state = value >= limit;
		    break;
		case Dyn.eLimitType_Eq:
		    state = value == limit;
		    break;      
		}
		oldValueF = value;
	    }
	    else if ( a_typeid == Pwr.eType_Int32 || a_typeid == Pwr.eType_UInt32) {
		int value = dyn.graph.getGdh().getObjectRefInfoInt( p);
		int i;
		if ( !firstScan) {
		    if ( !dyn.resetColor && value == oldValueI) {
			if ( oldState)
			    dyn.ignoreColor = true;
			return;
		    }
		}
		else
		    firstScan = false;
  
		switch ( limit_type) {
		case Dyn.eLimitType_Gt:
		    state = value > limit;
		    break;
		case Dyn.eLimitType_Lt:
		    state = value < limit;
		    break;
		case Dyn.eLimitType_Ge:
		    state = value >= limit;
		    break;
		case Dyn.eLimitType_Le:
		    state = value >= limit;
		    break;
		case Dyn.eLimitType_Eq:
		    state = value == limit;
		    break;      
		}
		oldValueI = value;
	    }

	    if ( state != oldState || dyn.resetColor || firstScan) {
		if ( state) {
		    set_color = true;
		    dyn.ignoreColor = true;
		}
		else {
		    reset_color = true;
		    dyn.resetColor = true;
		}
		oldState = state;
	    }

	    else if ( state)
		dyn.ignoreColor = true;

	    if ( !set_color && !reset_color)
		return;

	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( set_color) {
		    if ( color >= Glow.eDrawTone__) {
			if ( border == 0)
			    object.setFillColor( color);
			else
			    object.setBorderColor( color);
		    }
		    else
			object.setColorTone( color);
		    dyn.ignoreColor = true;
		}
		else {
		    if ( color >= Glow.eDrawTone__) {
			if ( border == 0)
			    object.resetFillColor();
			else
			    object.resetBorderColor();
		    }
		    object.resetColorTone();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	    else {
		if ( set_color) {
		    if ( border == 0)
			object.setFillColor( color);
		    else
			object.setBorderColor( color);
		    dyn.ignoreColor = true;
		}
		else {
		    if ( border == 0)
			object.resetFillColor();
		    else
			object.resetBorderColor();
		    dyn.resetColor = true;
		}
		dyn.repaintNow = true;
	    }
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynAnalogColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_AnalogColor: 
			break;
		    case Dyn.eSave_AnalogColor_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_AnalogColor_limit: 
			limit = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_AnalogColor_limit_type: 
			limit_type = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_AnalogColor_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_AnalogColor_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_AnalogColor_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_AnalogColor_border: 
			border = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_AnalogColor_common_attr: 
			common_attr = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynAnalogColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynAnalogColor");
	    }
	}

    }

    public class DynRotate extends DynElem {
	String attribute;
	double x0;
	double y0;
	double factor;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	float oldValue;
	int rotation_point;

	public DynRotate( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Rotate, 0, 0, 0, Dyn.eDynPrio_Rotate);
	}

	public DynRotate( DynRotate x) {
	    super(x);
	    attribute = x.attribute;
	    x0 = x.x0;
	    y0 = x.y0;
	    factor = x.factor;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Rotate: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;

	    if ( x0 != 0 || y0 != 0)
		rotation_point = Glow.eRotationPoint_FixPoint;
	    else
		rotation_point = Glow.eRotationPoint_Zero;
	    
	    object.storeTransform();
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database != GraphIfc.eDatabase_Local)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}
	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    float value0 = dyn.graph.getGdh().getObjectRefInfoFloat( p);
	    if ( value0 != oldValue  || firstScan) {
		System.out.println("Rotate " + value0 * factor + " x0 " + x0 + " y0 " + y0   + " rp " + rotation_point);
		object.setRotation(value0 * factor, x0, y0, rotation_point);

		dyn.repaintNow = true;
		oldValue = value0;
	    }
	    if ( firstScan)
		firstScan = false;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynRotate : " + line);

		    switch ( key) {
		    case Dyn.eSave_Rotate: 
			break;
		    case Dyn.eSave_Rotate_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_Rotate_x0: 
			x0 = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_Rotate_y0: 
			y0 = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_Rotate_factor: 
			factor = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynRotate");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynRotate");
	    }
	}

    }

    public class DynMove extends DynElem {
	String move_x_attribute;
	String move_y_attribute;
	String scale_x_attribute;
	String scale_y_attribute;
	double x_factor;
	double y_factor;
	double x_offset;
	double y_offset;
	double scale_x_factor;
	double scale_y_factor;
	int scale_type;
	int move_x_p = -1;
	int move_x_database;
	int move_x_typeid;
	PwrtRefId move_x_subid;
	int move_y_p = -1;
	int move_y_database;
	int move_y_typeid;
	PwrtRefId move_y_subid;
	int scale_x_p = -1;
	int scale_x_database;
	int scale_x_typeid;
	PwrtRefId scale_x_subid;
	int scale_y_p = -1;
	int scale_y_database;
	int scale_y_typeid;
	PwrtRefId scale_y_subid;
	float move_x_old_value = 0;
	float move_y_old_value = 0;
	float scale_x_old_value = 0;
	float scale_y_old_value = 0;
	boolean firstScan = true;
	double x_orig;
	double y_orig;
	double width_orig;
	double height_orig;
	
	public DynMove( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Move, 0, 0, 0, Dyn.eDynPrio_Move);
	}

	public DynMove( DynMove x) {
	    super(x);
	    x_offset = x.x_offset;
	    y_offset = x.y_offset;
	    x_factor = x.x_factor;
	    y_factor = x.y_factor;
	    scale_type = x.scale_type;
	    move_x_attribute = x.move_x_attribute;
	    move_y_attribute = x.move_y_attribute;
	    scale_x_attribute = x.scale_x_attribute;
	    scale_y_attribute = x.scale_y_attribute;
	}


	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    GdhrRefObjectInfo ret = null;

	    DynParsedAttrName pname = dyn.parseAttrName(move_x_attribute);
	    if ( !(pname == null || pname.name.equals(""))) {

		switch ( pname.type) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64:
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32:
		    break;
		default:
		    System.out.println("Move: " + move_x_attribute);
		    return 1;
		}

		ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Move: " + move_x_attribute);
		    return 1;
		}

		move_x_p = ret.id;
		move_x_subid = ret.refid;
		move_x_typeid = pname.type;
	    }
		
	    pname = dyn.parseAttrName(move_y_attribute);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		switch ( pname.type) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64:
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32:
		    break;
		default:
		    System.out.println("Move: " + move_y_attribute);
		    return 1;
		}

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Move: " + move_y_attribute);
		    return 1;
		}

		move_y_p = ret.id;
		move_y_subid = ret.refid;
		move_y_typeid = pname.type;
	    }

	    pname = dyn.parseAttrName(scale_x_attribute);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		switch ( pname.type) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64:
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32:
		    break;
		default:
		    System.out.println("Move: " + scale_x_attribute);
		    return 1;
		}

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Move: " + scale_x_attribute);
		    return 1;
		}

		scale_x_p = ret.id;
		scale_x_subid = ret.refid;
		scale_x_typeid = pname.type;
	    }

	    pname = dyn.parseAttrName(scale_y_attribute);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		switch ( pname.type) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64:
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32:
		    break;
		default:
		    System.out.println("Move: " + scale_y_attribute);
		    return 1;
		}

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Move: " + scale_y_attribute);
		    return 1;
		}

		scale_y_p = ret.id;
		scale_y_subid = ret.refid;
		scale_y_typeid = pname.type;
	    }

	    if ( !object.transform_is_stored()) {
		object.store_transform();
		GlowGeometry geom = object.measure();
		x_orig = geom.ll_x;
		y_orig = geom.ll_y;
		width_orig = geom.ur_x - x_orig;
		height_orig = geom.ur_y - y_orig;
	    }

	    return 1;
	}

	public void disconnect() {
	    if ( move_x_p != -1 && move_x_database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(move_x_subid);
	    if ( move_y_p != -1 && move_y_database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(move_y_subid);
	    if ( scale_x_p != -1 && scale_x_database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(scale_x_subid);
	    if ( scale_y_p != -1 && scale_y_database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(scale_y_subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    boolean update = false;
  
	    float move_x_value = 0;
	    float move_y_value = 0;
	    float scale_x_value = 0;
	    float scale_y_value = 0;
	    if ( move_x_p != -1) {
		switch ( move_x_typeid) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64: {
		    move_x_value = dyn.graph.getGdh().getObjectRefInfoFloat( move_x_p);		   
		    break;
		}
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32: {
		    move_x_value = (float)dyn.graph.getGdh().getObjectRefInfoInt( move_x_p);
		    break;
		}
		default: ;
		}
	    }

	    if ( move_y_p != -1) {
		switch ( move_x_typeid) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64: {
		    move_y_value = dyn.graph.getGdh().getObjectRefInfoFloat( move_y_p);		   
		    break;
		}
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32: {
		    move_y_value = (float)dyn.graph.getGdh().getObjectRefInfoInt( move_y_p);
		    break;
		}
		default: ;
		}
	    }

	    if ( scale_x_p != -1) {
		switch ( scale_x_typeid) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64: {
		    scale_x_value = dyn.graph.getGdh().getObjectRefInfoFloat( scale_x_p);		   
		    break;
		}
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32: {
		    scale_x_value = (float)dyn.graph.getGdh().getObjectRefInfoInt( scale_x_p);
		    break;
		}
		default: ;
		}
	    }

	    if ( scale_y_p != -1) {
		switch ( scale_x_typeid) {
		case Pwr.eType_Float32:
		case Pwr.eType_Float64: {
		    scale_y_value = dyn.graph.getGdh().getObjectRefInfoFloat( scale_y_p);		   
		    break;
		}
		case Pwr.eType_Int32:
		case Pwr.eType_UInt32: {
		    scale_y_value = (float)dyn.graph.getGdh().getObjectRefInfoInt( scale_y_p);
		    break;
		}
		default: ;
		}
	    }


	    update = false;
	    if ( !firstScan) {
		if ( move_x_p != -1 && move_x_value != move_x_old_value)
		    update = true;
		else if ( move_y_p != -1 && move_y_value != move_y_old_value)
		    update = true;
		else if ( scale_x_p != -1 && scale_x_value != scale_x_old_value)
		    update = true;
		else if ( scale_y_p != -1 && scale_y_value != scale_y_old_value)
		    update = true;
		if ( !update)
		    return;

	    }
	    else
		firstScan = false;

	    double move_x = 0;
	    double move_y = 0;
	    double scale_x = 1;
	    double scale_y = 1;

	    if ( scale_x_p != -1 || scale_y_p != -1) {
		if ( scale_x_p != -1)
		    scale_x = scale_x_value * scale_x_factor;
		else
		    scale_x = 1;
		
		if ( scale_y_p != -1)
		    scale_y = scale_y_value * scale_y_factor;
	    }
	    else
		scale_y = 1;

      
	    if ( !(move_x_p != -1 || move_y_p != -1))
		object.set_scale( scale_x, scale_y, 0, 0,
				  scale_type);
	    if ( scale_x_p != -1)
		scale_x_old_value = scale_x_value;
	    if ( scale_y_p != -1)
		scale_y_old_value =  scale_y_value;


	    if ( move_x_p != -1 || move_y_p != -1) {
		if ( move_x_p != -1) {
		    double scale_offs = 0;
		    // Adjust position for different scaletypes
		    switch ( scale_type) {
		    case Glow.eScaleType_LowerRight:
		    case Glow.eScaleType_UpperRight:
			scale_offs = width_orig * ( 1 - scale_x);
			break;
		    case Glow.eScaleType_Center:
			scale_offs = width_orig * ( 1 - scale_x) / 2;
			break;
		    default: ;
		    }

		    move_x = x_orig + scale_offs + (move_x_value - x_offset) * x_factor;
		}
		else
		    move_x = x_orig;
		
		if ( move_y_p != -1) {
		    double scale_offs = 0;
		    // Adjust position for different scaletypes
		    switch ( scale_type) {
		    case Glow.eScaleType_UpperRight:
		    case Glow.eScaleType_UpperLeft:
			scale_offs = height_orig * ( 1 - scale_y);
			break;
		    case Glow.eScaleType_Center:
			scale_offs = height_orig * ( 1 - scale_y) / 2;
			break;
		    default: ;
		    }
		    
		    move_y = y_orig + scale_offs + (move_y_value - y_offset) * y_factor;
		}
		else
		    move_y = y_orig;
		
		if ( Math.abs(scale_x) < Double.MIN_VALUE)
		    scale_x = 10e-5;
		if ( Math.abs(scale_y) < Double.MIN_VALUE)
		    scale_y = 10e-5;
		
		object.set_scale_pos( move_x, move_y, 
				      scale_x, scale_y, 0, 0,
				      scale_type);
		if ( move_x_p != -1)
		    move_x_old_value = move_x_value;
		if ( move_y_p != -1)
		    move_y_old_value = move_y_value;
	    }
	    else {
		if ( move_x_p != -1)
		    move_x = (move_x_value - x_offset) * x_factor;
		else
		    move_x = 0;
	    
		if ( move_y_p != -1) {
		    move_y = (move_y_value - y_offset) * y_factor;
		}
		else
		    move_y = 0;
  
		object.set_position( move_x, move_y);
	    
		if ( move_x_p != -1)
		    move_x_old_value = move_x_value;
		if ( move_y_p != -1)
		    move_y_old_value = move_y_value;
	    }
	}


	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynMove : " + line);

		    switch ( key) {
		    case Dyn.eSave_Move: 
			break;
		    case Dyn.eSave_Move_move_x_attribute: 
			if ( token.hasMoreTokens())
			    move_x_attribute = token.nextToken();
			break;
		    case Dyn.eSave_Move_move_y_attribute: 
			if ( token.hasMoreTokens())
			    move_y_attribute = token.nextToken();
			break;
		    case Dyn.eSave_Move_scale_x_attribute: 
			if ( token.hasMoreTokens())
			    scale_x_attribute = token.nextToken();
			break;
		    case Dyn.eSave_Move_scale_y_attribute: 
			if ( token.hasMoreTokens())
			    scale_y_attribute = token.nextToken();
			break;
		    case Dyn.eSave_Move_x_offset: 
			x_offset = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_Move_y_offset: 
			y_offset = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_Move_x_factor: 
			x_factor = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_Move_y_factor: 
			y_factor = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_Move_scale_x_factor: 
			scale_x_factor = new Double(token.nextToken()).doubleValue();
			break;
 		    case Dyn.eSave_Move_scale_y_factor: 
			scale_y_factor = new Double(token.nextToken()).doubleValue();
			break;
 		    case Dyn.eSave_Move_scale_type: 
			scale_type = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynMove");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynMove");
	    }
	}

    }

    public class DynAnalogShift extends DynElem {
	String attribute;
 	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
        float oldValueF;
	int oldValueI;

	public DynAnalogShift( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_AnalogShift, 0, 0, 0, Dyn.eDynPrio_AnalogShift);
	}

	public DynAnalogShift( DynAnalogShift x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("AnalogShift: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;

	    int index = 0;

	    switch ( a_typeid) {
	    case Pwr.eType_Float32: {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( p);
		int i;

		if ( !firstScan) {
		    if ( value == oldValueF) {
			return;
		    }
		}
		else
		    firstScan = false;

		index = (int)( value + 0.5);
		oldValueF = value;

		break;
	    }
	    case Pwr.eType_Int32: {
		int value = dyn.graph.getGdh().getObjectRefInfoInt( p);
		int i;

		if ( !firstScan) {
		    if ( value == oldValueI) {
			return;
		    }
		}
		else
		    firstScan = false;

		index = value;
		oldValueI = value;

		break;
	    }
	    }
	    object.set_nodeclass_by_index(index);	    
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynAnalogShift : " + line);

		    switch ( key) {
		    case Dyn.eSave_AnalogShift: 
			break;
		    case Dyn.eSave_AnalogShift_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynAnalogShift");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynAnalogShift");
	    }
	}

    }

    public class DynDigShift extends DynElem {
	String attribute;
  	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	boolean oldValue;

	public DynDigShift( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigShift, 0, 0, 0, Dyn.eDynPrio_DigShift);
	}

	public DynDigShift( DynDigShift x) {
	    super(x);
	    attribute = x.attribute;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigShift: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value)
		    return;
	    }
	    else
		firstScan = false;
	
	    if ( value) {
		object.set_last_nodeclass();
	    }
	    else {
		object.set_root_nodeclass();
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigShift : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigShift: 
			break;
		    case Dyn.eSave_DigShift_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigShift");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigShift");
	    }
	}

    }

    public class DynDigFourShift extends DynElem {
	String attribute1;
	String attribute2;
	String attribute3;
  	PwrtRefId subid1;
	int p1;
	int database1;
	boolean inverted1;
	boolean attrFound1 = false;
	int bitmask1;
	int a_typeid1;
	boolean oldValue1;
  	PwrtRefId subid2;
	int p2;
	int database2;
	boolean inverted2;
	boolean attrFound2 = false;
	int bitmask2;
	int a_typeid2;
	boolean oldValue2;
  	PwrtRefId subid3;
	int p3;
	int database3;
	boolean inverted3;
	boolean attrFound3 = false;
	int bitmask3;
	int a_typeid3;
	boolean oldValue3;
	boolean firstScan = true;

	public DynDigFourShift( Dyn dyn) {
	    super(dyn, Dyn.mDynType2_DigFourShift, 0, 0, 0, Dyn.eDynPrio_DigFourShift);
	}

	public DynDigFourShift( DynDigFourShift x) {
	    super(x);
	    attribute1 = x.attribute1;
	    attribute2 = x.attribute2;
	    attribute3 = x.attribute3;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

 	    DynParsedAttrName pname = dyn.parseAttrName(attribute1);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigFourShift: " + attribute1);
		return 1;
	    }

	    p1 = ret.id;
	    subid1 = ret.refid;
	    inverted1 = pname.inverted;
	    a_typeid1 = pname.type;
	    bitmask1 = pname.bitmask;
	    database1 = pname.database;
	    attrFound1 = true;

 	    pname = dyn.parseAttrName(attribute2);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigFourShift: " + attribute2);
		return 1;
	    }

	    p2 = ret.id;
	    subid2 = ret.refid;
	    inverted2 = pname.inverted;
	    a_typeid2 = pname.type;
	    bitmask2 = pname.bitmask;
	    database2 = pname.database;
	    attrFound2 = true;

 	    pname = dyn.parseAttrName(attribute3);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigFourShift: " + attribute3);
		return 1;
	    }

	    p3 = ret.id;
	    subid3 = ret.refid;
	    inverted3 = pname.inverted;
	    a_typeid3 = pname.type;
	    bitmask3 = pname.bitmask;
	    database3 = pname.database;
	    attrFound3 = true;

	    return 1;
	}

	public void disconnect() {
	    if ( attrFound1 && database1 == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid1);
	    if ( attrFound2 && database2 == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid2);
	    if ( attrFound3 && database3 == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid3);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound1 || !attrFound2 || !attrFound3)
		return;
	    boolean value1 = dyn.getDig(p1, a_typeid1, bitmask1, database1);
	    boolean value2 = dyn.getDig(p2, a_typeid2, bitmask2, database2);
	    boolean value3 = dyn.getDig(p3, a_typeid3, bitmask3, database3);

	    if ( inverted1)
		value1 = !value1;
	    if ( inverted2)
		value2 = !value2;
	    if ( inverted3)
		value3 = !value3;

	    if ( !firstScan) {
		if ( oldValue1 == value1 && oldValue2 == value2 && oldValue3 == value3)
		    return;
	    }
	    else
		firstScan = false;
	
	    if ( value3)
		object.set_nodeclass_by_index(2);	    
 	    else if ( value2)
		object.set_nodeclass_by_index(1);
 	    else if ( value1)
		object.set_root_nodeclass();
	    else
		object.set_last_nodeclass();
	    oldValue1 = value1;
	    oldValue2 = value2;
	    oldValue3 = value3;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigFourShift : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigFourShift: 
			break;
		    case Dyn.eSave_DigFourShift_attribute1: 
			if ( token.hasMoreTokens())
			    attribute1 = token.nextToken();
			break;
		    case Dyn.eSave_DigFourShift_attribute2: 
			if ( token.hasMoreTokens())
			    attribute2 = token.nextToken();
			break;
		    case Dyn.eSave_DigFourShift_attribute3: 
			if ( token.hasMoreTokens())
			    attribute3 = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigFourShift");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigFourShift");
	    }
	}

    }

    public class DynScrollingText extends DynElem {
	String attribute;
	int direction;
	double speed;
	int bounce;
  	PwrtRefId subid;
	int a_typeid;
	int p;
	int database;
	boolean attrFound = false;
	String oldValue;
	boolean firstScan = true;
	double offset = 0;
	double osize;
	
	public DynScrollingText( Dyn dyn) {
	    super(dyn, Dyn.mDynType2_ScrollingText, 0, 0, 0, Dyn.eDynPrio_ScrollingText);
	}

	public DynScrollingText( DynScrollingText x) {
	    super(x);
	    attribute = x.attribute;
	    direction = x.direction;
	    speed = x.speed;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;
	    if ( !(pname.type == Pwr.eType_String || pname.type == Pwr.eType_Text))
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Local:
		ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Value: " + attribute);
		return 1;
	    }

	    GlowGeometry geom = object.measure();
	    switch( direction) {
	    case Glow.eDirection_Left:
	    case Glow.eDirection_Right:
		osize = geom.ur_x - geom.ll_x;
		break;
	    default:
		osize = geom.ur_y - geom.ll_y;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    a_typeid = pname.type;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    GlowDimensionD d = object.getAnnotationTextExtent( 1);
	    if ( d == null)
		return;

	    switch ( direction) {
	    case Glow.eDirection_Left: {
		offset -= speed * dyn.graph.getAnimationScanTime();
		if ( bounce != 0) {
 		    if ( d.width < osize) {
			if ( offset < 0) {
			    offset = -offset;
			    direction = Glow.eDirection_Right;
			}
		    }
		    else {
			if ( offset < osize - d.width) {
			    offset += (osize - d.width) - offset;
			    direction = Glow.eDirection_Right;
			}
		    }
		}
		else {
		    if ( offset < -d.width)
			offset = osize;
		}
		object.setAnnotationTextOffset( 1, offset, 0);
		break;
	    }
	    case Glow.eDirection_Right: {
		offset += speed * dyn.graph.getAnimationScanTime();
		if ( bounce != 0) {
		    if ( d.width < osize) {
			if ( offset > osize - d.width) {
			    offset -= offset - (osize -d.width);
			    direction = Glow.eDirection_Left;
			}
		    }
		    else {
			if ( offset > 0) {
			    offset = -offset;
			    direction = Glow.eDirection_Left;
			}
		    }
		}
		else {
		    if ( offset > osize)
			offset = -d.width;
		}
		object.setAnnotationTextOffset( 1, offset, 0);
		break;
	    }
	    case Glow.eDirection_Up: {
		offset += speed * dyn.graph.getAnimationScanTime();
		if ( bounce != 0) {
		    if ( offset > osize - d.height) {
			offset -= offset- (osize - d.height);
			direction = Glow.eDirection_Down;
		    }
		}
		else {
		    if ( offset > osize)
			offset = -d.height;
		}
		object.setAnnotationTextOffset( 1, 0, offset);
		break;
	    }
	    case Glow.eDirection_Down: {
		offset -= speed * dyn.graph.getAnimationScanTime();
		if ( bounce != 0) {
		    if ( offset < 0) {
			offset = -offset;
			direction = Glow.eDirection_Up;
		    }
		}
		else {
		    if ( offset < -d.height)
			offset = osize;
		}
		object.setAnnotationTextOffset( 1, 0, offset);
		break;
	    }
	    default: ;
	    }

	    String value0 = null;
	    switch ( database) {
	    case GraphIfc.eDatabase_Gdh:
		value0 = dyn.graph.getGdh().getObjectRefInfoString( p, a_typeid);
		break;
	    case GraphIfc.eDatabase_Local:
		value0 = dyn.graph.getLdb().getObjectRefInfoString( p, a_typeid);
		break;
	    }

	    if ( firstScan || !value0.equals( oldValue)) {
		object.setAnnotation(1, value0);
		dyn.repaintNow = true;
		oldValue = value0;
	    }
	    if ( firstScan)
		firstScan = false;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynScrollingText : " + line);

		    switch ( key) {
		    case Dyn.eSave_ScrollingText: 
			break;
		    case Dyn.eSave_ScrollingText_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_ScrollingText_direction: 
			direction = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ScrollingText_speed: 
			speed = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_ScrollingText_bounce: 
			bounce = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynScrollingText");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynScrollingText");
	    }
	}

    }
    public class DynColorThemeLightness extends DynElem {
	
	public DynColorThemeLightness( Dyn dyn) {
	    super(dyn, Dyn.mDynType2_ColorThemeLightness, 0, 0, 0, Dyn.eDynPrio_ColorThemeLightness);
	}

	public DynColorThemeLightness( DynColorThemeLightness x) {
	    super(x);
	}

 	public int connect(GlowArrayElem o) {
	    return 1;
	}

	public void disconnect() {
	}

	
	public void scan( GlowArrayElem o) {
	    ((GrowNode)o).setColorThemeLightness();
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynColorThemeLightness : " + line);

		    switch ( key) {
		    case Dyn.eSave_ColorThemeLightness: 
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynColorThemeLightness");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynColorThemeLightness");
	    }
	}

    }

    public class DynDigBackgroundColor extends DynElem {
	String attribute;
	int color;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;

	public DynDigBackgroundColor( Dyn dyn) {
	    super(dyn, 0, Dyn.mDynType2_DigBackgroundColor, 0, 0, Dyn.eDynPrio_DigBackgroundColor);
	}

	public DynDigBackgroundColor( DynDigBackgroundColor x) {
	    super(x);
	    color = x.color;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( color < 0 || color >= Glow.eDrawType__)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigBackgroundColor: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreBgColor)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value && !dyn.resetColor) {
		    // No change since last time
		    if ( value)
			dyn.ignoreBgColor = true;
		    return;
		}
	    }
	    else
		firstScan = false;
	
	    if ( value) {
		object.setBackgroundColor( color);
		dyn.ignoreBgColor = true;
	    }
	    else {
		object.resetBackgroundColor();
		dyn.resetBgColor = true;
	    }
	    dyn.repaintNow = true;
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigBackgroundColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigBackgroundColor: 
			break;
		    case Dyn.eSave_DigBackgroundColor_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigBackgroundColor_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigBackgroundColor_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigBackgroundColor_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigBackgroundColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigBackgroundColor");
	    }
	}

    }

    public class DynDigSwap extends DynElem {
	String attribute;
	int reset_value;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;

	public DynDigSwap( Dyn dyn) {
	    super(dyn, 0, Dyn.mDynType2_DigSwap, 0, 0, Dyn.eDynPrio_DigSwap);
	}

	public DynDigSwap( DynDigSwap x) {
	    super(x);
	    reset_value = x.reset_value;
	    attribute = x.attribute;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigSwap: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( !firstScan) {
		oldValue = value;
		firstScan = false;
		return;
	    }

	    if ( inverted)
		value = !value;

	    if ( oldValue == value) {
		// No change since last time
		return;
	    }
	
	    if ( value) {
		// Todo
		// dyn.graph.swap();
	    }
	    dyn.repaintNow = true;
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigSwap : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigSwap: 
			break;
		    case Dyn.eSave_DigSwap_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigSwap_reset_value: 
			reset_value = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigSwap");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigSwap");
	    }
	}

    }

    public class DynAnimation extends DynElem {
	String attribute;
	int sequence;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean oldValue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	int animation_count;
	int animation_direction;

	public DynAnimation( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Animation, 0, 0, 0, Dyn.eDynPrio_Animation);
	}

	public DynAnimation( DynAnimation x) {
	    super(x);
	    attribute = x.attribute;
	    sequence = x.sequence;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Animation: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;

	    System.out.println( "AnimSequence1: " + sequence);
	    if ( sequence == Dyn.eAnimSequence_Inherit)
		sequence = object.get_nodeclass_dyn_attr1();
	    System.out.println( "AnimSequence2: " + sequence);

	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    int max_count;
	    int sts;

	    if ( !attrFound)
		return;

	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);
	    if ( inverted)
		value = !value;

	    if ( firstScan) {
		animation_count = 0;
		animation_direction = 0;
		firstScan = false;
		if ( sequence == Dyn.eAnimSequence_Dig) {
		    if ( value)
			object.set_last_nodeclass();
		    oldValue = value;
		}
	    }

	    if ( sequence == Dyn.eAnimSequence_Dig) {
		if ( oldValue != value) {
		    // Start animation
		    if ( value) {
			animation_count = 0;
			animation_direction = 1;
		    }
		    else if ( !value) {
			animation_direction = 2;
			animation_count = 0;
		    }
		}

		if ( animation_direction != 0) {
		    max_count = object.get_animation_count();
		    animation_count++;
		    if ( animation_count >= max_count) {
			// Shift nodeclass
			if ( animation_direction == 1) {
			    // Shift forward

			    sts = object.set_next_nodeclass();
			    if ( (sts & 1) == 0) {
				// End of animation
				animation_count = 0;
				animation_direction = 0;
			    }
			    animation_count = 0;
			}
			else {
			    // Shift backward

			    sts = object.set_previous_nodeclass();
			    if ( (sts & 1) == 0) {
				// End of animation
				animation_count = 0;
				animation_direction = 0;
			    }
			    animation_count = 0;
			}
		    }
		}
	    }
	    else {
		if ( value) {
		    if ( animation_direction == 0) {
			// Animation has been stopped
			animation_count = 0;
			animation_direction = 1;
		    }

		    max_count = object.get_animation_count();
		    animation_count++;
		    if ( animation_count >= max_count) {
			// Shift nodeclass
			if ( animation_direction == 1) {
			    // Shift forward

			    sts = object.set_next_nodeclass();
			    if ((sts & 1) == 0) {
				if ( sequence == Dyn.eAnimSequence_Cycle) {
				    // Start from the beginning again
				    object.set_nodeclass_by_index( 1);
				}
				else {
				    // Change direction
				    animation_direction = 2;
				    object.set_previous_nodeclass();
				}
			    }
			    animation_count = 0;
			}
			else {
			    // Shift backward

			    sts = object.set_previous_nodeclass();
			    if ( (sts & 1) == 0) {
				// Change direction
				animation_direction = 1;
				sts = object.set_next_nodeclass();
			    }
			    animation_count = 0;
			}
		    }
		}
		else {
		    if ( animation_direction != 0) {
			// Stop and reset animation
			animation_direction = 0;
			object.set_first_nodeclass();
		    }
		}
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynAnimation : " + line);

		    switch ( key) {
		    case Dyn.eSave_Animation: 
			break;
		    case Dyn.eSave_Animation_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_Animation_sequence: 
			sequence = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynAnimation");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynAnimation");
	    }
	}

    }

    public class DynVideo extends DynElem {

	public DynVideo( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Video, 0, 0, 0, Dyn.eDynPrio_Video);
	}

	public DynVideo( DynVideo x) {
	    super(x);
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynVideo : " + line);

		    switch ( key) {
		    case Dyn.eSave_Video: 
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynVideo");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynVideo");
	    }
	}

    }

    public class DynBar extends DynElem {
	String attribute;
	String minvalue_attr;
	String maxvalue_attr;
	float maxval;
	float minval;
 	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int a_typeid;
        float old_value;
	int old_ivalue;
	int max_value_p;
	int min_value_p;
	PwrtRefId max_value_subid;
	PwrtRefId min_value_subid;
	float old_max_value;
	float old_min_value;

	public DynBar( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Bar, 0, 0, 0, Dyn.eDynPrio_Bar);
	}

	public DynBar( DynBar x) {
	    super(x);
	    attribute = x.attribute;
	    minvalue_attr = x.minvalue_attr;
	    maxvalue_attr = x.maxvalue_attr;
	}

	public int connect(GlowArrayElem o) {
	    GrowBar object = (GrowBar)o;

	    if ( attribute == null)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Bar: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    attrFound = true;

	    min_value_p = 0;
	    pname = dyn.parseAttrName(minvalue_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    min_value_p = ret.id;
		    min_value_subid = ret.refid;
		}
	    }

	    max_value_p = 0;
	    pname = dyn.parseAttrName(maxvalue_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    max_value_p = ret.id;
		    max_value_subid = ret.refid;
		}
	    }

	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	    if ( min_value_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(min_value_subid);
	    if ( max_value_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(max_value_subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowBar object = (GrowBar)o;
	    if ( !attrFound)
		return;
  
	    float minval, maxval;
	    if ( max_value_p != 0 && min_value_p != 0) {
		minval = dyn.graph.getGdh().getObjectRefInfoFloat( min_value_p);
		maxval = dyn.graph.getGdh().getObjectRefInfoFloat( max_value_p);
		if ( minval != old_min_value ||
		     maxval != old_max_value) {
		    System.out.println("Bar set range min : " + minval + "   max : " + maxval);
 		    object.set_range(minval, maxval);
		    old_min_value = minval;
		    old_max_value = maxval;
		}
	    }

	    switch (a_typeid) {
	    case Pwr.eType_Float32: {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( p);

		if ( !firstScan) {
		    if ( Math.abs( old_value - value) < Float.MIN_VALUE)
			// No change since last time
			return;
		}
		else
		    firstScan = false;

		object.set_value(value);
		old_value = value;
		break;
	    }
	    case Pwr.eType_Int32:
	    case Pwr.eType_UInt32: {
		int value = dyn.graph.getGdh().getObjectRefInfoInt( p);
		if ( !firstScan) {
		    if ( old_ivalue == value)
			// No change since last time
			return;
		}
		else
		    firstScan = false;

		object.set_value(value);
		old_ivalue = value;
		break;
	    }
	    }
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynBar : " + line);

		    switch ( key) {
		    case Dyn.eSave_Bar: 
			break;
		    case Dyn.eSave_Bar_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_Bar_minvalue_attr: 
			if ( token.hasMoreTokens())
			    minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_Bar_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynBar");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynBar");
	    }
	}

    }

    public class DynTrend extends DynElem {
	String attribute1;
	String attribute2;
	String minvalue_attr1;
	String maxvalue_attr1;
	String minvalue_attr2;
	String maxvalue_attr2;
	String hold_attr;
	String timerange_attr;
	String mark1_attr;
	String mark2_attr;
	int mark1_color;
	int mark2_color;
	int p1 = -1;
	int database1;
	boolean inverted1;
	int a_typeid1;
 	PwrtRefId subid1;
	int p2 = -1;
	int database2;
	boolean inverted2;
	int a_typeid2;
 	PwrtRefId subid2;
	boolean attrFound = false;
	boolean firstScan = true;
	int max_value1_p;
	int min_value1_p;
	PwrtRefId max_value1_subid;
	PwrtRefId min_value1_subid;
	float old_max_value1;
	float old_min_value1;
	int max_value2_p;
	int min_value2_p;
	PwrtRefId max_value2_subid;
	PwrtRefId min_value2_subid;
	float old_max_value2;
	float old_min_value2;
	double scan_time;
	double acc_time;
	int no_of_points;
	int trend_hold;
	int hold_p;
	int hold_database;
	PwrtRefId hold_subid;
	int timerange_p;
	int timerange_database;
	PwrtRefId timerange_subid;
	float old_timerange;
	int mark1_p;
	PwrtRefId mark1_subid;
	float old_mark1;
	int mark2_p;
	PwrtRefId mark2_subid;
	float old_mark2;
	double orig_graph_scan_time;
	double orig_graph_fast_scan_time;
	double orig_graph_animation_scan_time;

	public DynTrend( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Trend, 0, 0, 0, Dyn.eDynPrio_Trend);
	}

	public DynTrend( DynTrend x) {
	    super(x);
	    attribute1 = x.attribute1;
	    attribute2 = x.attribute2;
	    minvalue_attr1 = x.minvalue_attr1;
	    minvalue_attr2 = x.minvalue_attr2;
	    maxvalue_attr1 = x.maxvalue_attr1;
	    maxvalue_attr2 = x.maxvalue_attr2;
	    hold_attr = x.hold_attr;
	    timerange_attr = x.timerange_attr;
	}

	public int connect(GlowArrayElem o) {
	    GrowTrend object = (GrowTrend)o;

	    if ( attribute1 == null)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute1);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Trend: " + attribute1);
		return 1;
	    }

	    p1 = ret.id;
	    subid1 = ret.refid;
	    inverted1 = pname.inverted;
	    a_typeid1 = pname.type;
	    attrFound = true;

	    pname = dyn.parseAttrName(attribute2);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + attribute2);
		    return 1;

		}
		else {
		    p2 = ret.id;
		    subid2 = ret.refid;
		    inverted2 = pname.inverted;
		    a_typeid2 = pname.type;
		}
	    }

	    no_of_points = object.get_no_of_points();
	    scan_time = object.get_scan_time();
	    acc_time = scan_time;
	    trend_hold = 0;

	    min_value1_p = 0;
	    pname = dyn.parseAttrName(minvalue_attr1);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && pname.database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    min_value1_p = ret.id;
		    min_value1_subid = ret.refid;
		}
	    }

	    max_value1_p = 0;
	    pname = dyn.parseAttrName(maxvalue_attr1);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && pname.database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    max_value1_p = ret.id;
		    max_value1_subid = ret.refid;
		}
	    }

	    min_value2_p = 0;
	    pname = dyn.parseAttrName(minvalue_attr2);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && pname.database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    min_value2_p = ret.id;
		    min_value2_subid = ret.refid;
		}
	    }

	    max_value2_p = 0;
	    pname = dyn.parseAttrName(maxvalue_attr2);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && pname.database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    max_value2_p = ret.id;
		    max_value2_subid = ret.refid;
		}
	    }

	    hold_p = 0;
	    pname = dyn.parseAttrName(hold_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		case GraphIfc.eDatabase_Local:
		    ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		    System.out.println("Hold: " + ret + " pname " + pname.name);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + hold_attr);
		    return 1;
		}
		else {
		    hold_p = ret.id;
		    hold_subid = ret.refid;
		    hold_database = pname.database;
		}
	    }

	    timerange_p = 0;
	    pname = dyn.parseAttrName(timerange_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		case GraphIfc.eDatabase_Local:
		    ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		    System.out.println("Timerange: " + ret + " pname " + pname.name);
		    break;
		default:
		    ret = null;
		}

		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + timerange_attr);
		    return 1;
		}
		else {
		    timerange_p = ret.id;
		    timerange_subid = ret.refid;
		    timerange_database = pname.database;
		    if ( pname.database == GraphIfc.eDatabase_Local) {
			float timerange = dyn.graph.getLdb().getObjectRefInfoFloat(timerange_p);
			if ( timerange == 0)
			    dyn.graph.getLdb().setObjectInfo( graph, pname.name, 
							      (float)scan_time * no_of_points);
		    }
		    orig_graph_scan_time = dyn.graph.getScanTime();
		    orig_graph_fast_scan_time = dyn.graph.getFastScanTime();
		    orig_graph_animation_scan_time = dyn.graph.getAnimationScanTime();
		}
	    }

	    mark1_p = 0;
	    pname = dyn.parseAttrName(mark1_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + mark1_attr);
		    return 1;
		}
		else {
		    mark1_p = ret.id;
		    mark1_subid = ret.refid;
		}
	    }

	    mark2_p = 0;
	    pname = dyn.parseAttrName(mark2_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + mark2_attr);
		    return 1;
		}
		else {
		    mark2_p = ret.id;
		    mark2_subid = ret.refid;
		}
	    }

	    if ( mark1_color != Glow.eDrawType_Inherit || mark2_color != Glow.eDrawType_Inherit)
		object.set_mark_color( mark1_color, mark2_color);
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database1 == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid1);
	    if ( p2 != -1 && database2 == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid2);
	    if ( min_value1_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(min_value1_subid);
	    if ( max_value1_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(max_value1_subid);
	    if ( min_value2_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(min_value2_subid);
	    if ( max_value2_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(max_value2_subid);
	    if ( hold_p != 0 && hold_database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(hold_subid);
	    if ( timerange_p != 0 && hold_database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(timerange_subid);
	    if ( mark1_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(mark1_subid);
	    if ( mark2_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(mark2_subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowTrend object = (GrowTrend)o;

	    if ( !attrFound)
		return;
  
	    if ( hold_p != 0) {
		boolean holdval = false;
		switch ( hold_database) {
		case GraphIfc.eDatabase_Gdh:
		    holdval = dyn.graph.getGdh().getObjectRefInfoBoolean(hold_p);
		    break;
		case GraphIfc.eDatabase_Local:
		    holdval = dyn.graph.getLdb().getObjectRefInfoBoolean(hold_p);
		    break;
		}
		if ( holdval)
		    return;
	    }

	    if ( timerange_p != 0) {
		float timerangeval = 10;
		switch ( timerange_database) {
		case GraphIfc.eDatabase_Gdh:
		    timerangeval = dyn.graph.getGdh().getObjectRefInfoFloat(timerange_p);
		    break;
		case GraphIfc.eDatabase_Local:
		    timerangeval = dyn.graph.getLdb().getObjectRefInfoFloat(timerange_p);
		    break;
		}
		if ( Math.abs(timerangeval - old_timerange) > Float.MIN_VALUE) {
		    double dt = timerangeval / no_of_points;
		     
		    System.out.println("Timerange: " + timerangeval + " " + no_of_points + " " + dt);

		    if ( dt >= 0.001) {
			object.set_scan_time( dt);
			scan_time = dt;
			if ( cycle == Glow.eCycle_Slow) {
			    double current_graph_scan_time = dyn.graph.getScanTime();
			    double current_graph_fast_scan_time = dyn.graph.getFastScanTime();
			    double current_graph_animation_scan_time = dyn.graph.getAnimationScanTime();
			    if ( current_graph_scan_time > scan_time)
				dyn.graph.setScanTime(scan_time);
			    else {
				if ( scan_time > orig_graph_scan_time)
				    dyn.graph.setScanTime(orig_graph_scan_time);
				else
				    dyn.graph.setScanTime(scan_time);
			    }
			    if ( current_graph_fast_scan_time > scan_time)
				dyn.graph.setFastScanTime(scan_time);
			    else {
				if ( scan_time > orig_graph_fast_scan_time)
				    dyn.graph.setFastScanTime(orig_graph_fast_scan_time);
				else
				    dyn.graph.setFastScanTime(scan_time);
			    }
			    if ( current_graph_animation_scan_time > scan_time)
				dyn.graph.setAnimationScanTime(scan_time);
			    else {
				if ( scan_time > orig_graph_animation_scan_time)
				    dyn.graph.setAnimationScanTime(orig_graph_animation_scan_time);
				else
				    dyn.graph.setAnimationScanTime(scan_time);
			    }
			}
			else {
			    // Fast cycle
			    double current_graph_fast_scan_time = dyn.graph.getFastScanTime();
			    double current_graph_animation_scan_time = dyn.graph.getAnimationScanTime();
			    if ( current_graph_fast_scan_time > scan_time)
				dyn.graph.setFastScanTime(scan_time);
			    else {
				if ( scan_time > orig_graph_fast_scan_time)
				    dyn.graph.setFastScanTime(orig_graph_fast_scan_time);
				else
				    dyn.graph.setFastScanTime(scan_time);
			    }
			    if ( current_graph_animation_scan_time > scan_time)
				dyn.graph.setAnimationScanTime(scan_time);
			    else {
				if ( scan_time > orig_graph_animation_scan_time)
				    dyn.graph.setAnimationScanTime(orig_graph_animation_scan_time);
				else
				    dyn.graph.setAnimationScanTime(scan_time);
			    }
			}
		    }
		    old_timerange = timerangeval;
		}
	    }

	    float minval, maxval;
	    if ( max_value1_p != 0 && min_value1_p != 0) {
		minval = dyn.graph.getGdh().getObjectRefInfoFloat( min_value1_p);
		maxval = dyn.graph.getGdh().getObjectRefInfoFloat( max_value1_p);
		if ( minval != old_min_value1 ||
		     maxval != old_max_value1) {
 		    object.set_range_y(0, minval, maxval);
		    old_min_value1 = minval;
		    old_max_value1 = maxval;
		}
	    }

	    if ( mark1_p != 0) {
		float mark1val;
		mark1val = dyn.graph.getGdh().getObjectRefInfoFloat(mark1_p);
		if (firstScan || Math.abs( mark1val - old_mark1) > Float.MIN_VALUE) {
		    object.set_y_mark1( mark1val);
		    old_mark1 = mark1val;
		}
	    }
	    if ( mark2_p != 0) {
		float mark2val;
		mark2val = dyn.graph.getGdh().getObjectRefInfoFloat(mark2_p);
		if (firstScan || Math.abs( mark2val - old_mark2) > Float.MIN_VALUE) {
		    object.set_y_mark2( mark2val);
		    old_mark2 = mark2val;
		}
	    }

	    if ( firstScan)
		firstScan = false;

	    if ( cycle == Glow.eCycle_Slow)
		acc_time += dyn.graph.getScanTime();
	    else
		acc_time += dyn.graph.getFastScanTime();
	    if ( acc_time + Double.MIN_VALUE >= scan_time) {
		if ( p1 != -1) {
		    switch ( a_typeid1) {
		    case Pwr.eType_Boolean: {
			boolean value = dyn.graph.getGdh().getObjectRefInfoBoolean( p1);
			if ( value)
			    object.add_value(1, 0);
			else
			    object.add_value(0, 0);
			break;
		    }
		    case Pwr.eType_Float32: {
			float value = dyn.graph.getGdh().getObjectRefInfoFloat( p1);
			object.add_value((double)value, 0);
			break;
		    }
		    case Pwr.eType_Int32:
		    case Pwr.eType_UInt32: {
			int value = dyn.graph.getGdh().getObjectRefInfoInt( p1);
			object.add_value((double)value, 0);
			break;
		    }
		    default: ;
		    }
		}
		if ( p2 != -1) {
		    switch ( a_typeid2) {
		    case Pwr.eType_Boolean: {
			boolean value = dyn.graph.getGdh().getObjectRefInfoBoolean( p2);
			if ( value)
			    object.add_value(1, 1);
			else
			    object.add_value(0, 1);
			break;
		    }
		    case Pwr.eType_Float32: {
			float value = dyn.graph.getGdh().getObjectRefInfoFloat( p2);
			object.add_value((double)value, 1);
			break;
		    }
		    case Pwr.eType_Int32:
		    case Pwr.eType_UInt32: {
			int value = dyn.graph.getGdh().getObjectRefInfoInt( p2);
			object.add_value((double)value, 1);
			break;
		    }
		    default: ;
		    }
		}

		acc_time = 0;
	    }
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynTrend : " + line);

		    switch ( key) {
		    case Dyn.eSave_Trend: 
			break;
		    case Dyn.eSave_Trend_attribute1: 
			if ( token.hasMoreTokens())
			    attribute1 = token.nextToken();
			break;
		    case Dyn.eSave_Trend_attribute2: 
			if ( token.hasMoreTokens())
			    attribute2 = token.nextToken();
			break;
		    case Dyn.eSave_Trend_minvalue_attr1: 
			if ( token.hasMoreTokens())
			    minvalue_attr1 = token.nextToken();
			break;
		    case Dyn.eSave_Trend_maxvalue_attr1: 
			if ( token.hasMoreTokens())
			    maxvalue_attr1 = token.nextToken();
			break;
		    case Dyn.eSave_Trend_minvalue_attr2: 
			if ( token.hasMoreTokens())
			    minvalue_attr2 = token.nextToken();
			break;
		    case Dyn.eSave_Trend_maxvalue_attr2: 
			if ( token.hasMoreTokens())
			    maxvalue_attr2 = token.nextToken();
			break;
		    case Dyn.eSave_Trend_hold_attr: 
			if ( token.hasMoreTokens())
			    hold_attr = token.nextToken();
			break;
		    case Dyn.eSave_Trend_timerange_attr: 
			if ( token.hasMoreTokens())
			    timerange_attr = token.nextToken();
			break;
		    case Dyn.eSave_Trend_mark1_attr: 
			if ( token.hasMoreTokens())
			    mark1_attr = token.nextToken();
			break;
		    case Dyn.eSave_Trend_mark2_attr: 
			if ( token.hasMoreTokens())
			    mark2_attr = token.nextToken();
			break;
		    case Dyn.eSave_Trend_mark1_color: 
			mark1_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Trend_mark2_color: 
			mark2_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynTrend");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynTrend");
	    }
	}

    }

    public class DynXY_Curve extends DynElem {
	boolean firstScan = true;
	String x_attr;
	String y_attr;
	String y_minvalue_attr;
	String y_maxvalue_attr;
	String x_minvalue_attr;
	String x_maxvalue_attr;
	String noofpoints_attr;
	String update_attr;
	String x_mark1_attr;
	String x_mark2_attr;
	String y_mark1_attr;
	String y_mark2_attr;
	int mark1_color;
	int mark2_color;
	double y_min_value;
	double y_max_value;
	double x_min_value;
	double x_max_value;
	int horizontal_padding;
	int datatype;
	int curve_color;
	int fill_color;
	int noofpoints;
	int noOfPoints;
	int xAttrType;
	int yAttrType;
	public double[] curveX;
	public double[] curveY;
	boolean updateAttrFound;
	PwrtRefId updateSubid;
	int updateP;
	boolean updateOldValue;
	boolean noofpointsAttrFound;
	PwrtRefId noofpointsSubid;
	int noofpointsP;
	int noofpointsOldValue;
	boolean yMinvalueAttrFound;
	PwrtRefId yMinvalueSubid;
	int yMinvalueP;
	boolean yMaxvalueAttrFound;
	PwrtRefId yMaxvalueSubid;
	int yMaxvalueP;
	boolean xMinvalueAttrFound;
	PwrtRefId xMinvalueSubid;
	int xMinvalueP;
	boolean xMaxvalueAttrFound;
	PwrtRefId xMaxvalueSubid;
	int xMaxvalueP;
	int x_mark1_p;
	PwrtRefId x_mark1_subid;
	float old_x_mark1;
	int x_mark2_p;
	PwrtRefId x_mark2_subid;
	float old_x_mark2;
	int y_mark1_p;
	PwrtRefId y_mark1_subid;
	float old_y_mark1;
	int y_mark2_p;
	PwrtRefId y_mark2_subid;
	float old_y_mark2;
	int curve_number;

	public DynXY_Curve( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_XY_Curve, 0, 0, 0, Dyn.eDynPrio_XY_Curve);
	}

	public DynXY_Curve( DynXY_Curve x) {
	    super(x);
	    x_attr = x.x_attr;
	    y_attr = x.y_attr;
	    y_minvalue_attr = x.y_minvalue_attr;
	    y_maxvalue_attr = x.y_maxvalue_attr;
	    x_minvalue_attr = x.x_minvalue_attr;
	    x_maxvalue_attr = x.x_maxvalue_attr;
	    noofpoints_attr = x.noofpoints_attr;
	    update_attr = x.update_attr;
	    y_min_value = x.y_min_value;
	    y_max_value = x.y_max_value;
	    x_min_value = x.x_min_value;
	    x_max_value = x.x_max_value;
	    noofpoints = x.noofpoints;
	    datatype = x.datatype;
	    curve_color = x.curve_color;
	    fill_color = x.fill_color;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynXY_Curve : " + line);

		    switch ( key) {
		    case Dyn.eSave_XY_Curve: 
			break;
		    case Dyn.eSave_XY_Curve_x_attr: 
			if ( token.hasMoreTokens())
			    x_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_y_attr: 
			if ( token.hasMoreTokens())
			    y_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_y_minvalue_attr: 
			if ( token.hasMoreTokens())
			    y_minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_y_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    y_maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_x_minvalue_attr: 
			if ( token.hasMoreTokens())
			    x_minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_x_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    x_maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_noofpoints_attr: 
			if ( token.hasMoreTokens())
			    noofpoints_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_update_attr: 
			if ( token.hasMoreTokens())
			    update_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_y_min_value: 
			y_min_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_XY_Curve_y_max_value: 
			y_max_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_XY_Curve_x_min_value: 
			x_min_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_XY_Curve_x_max_value: 
			x_max_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_XY_Curve_datatype: 
			datatype = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_curve_color: 
			curve_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_fill_color: 
			fill_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_horizontal_padding: 
			horizontal_padding = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_x_mark1_attr: 
			if ( token.hasMoreTokens())
			    x_mark1_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_x_mark2_attr: 
			if ( token.hasMoreTokens())
			    x_mark2_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_y_mark1_attr: 
			if ( token.hasMoreTokens())
			    y_mark1_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_y_mark2_attr: 
			if ( token.hasMoreTokens())
			    y_mark2_attr = token.nextToken();
			break;
		    case Dyn.eSave_XY_Curve_mark1_color: 
			mark1_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_XY_Curve_mark2_color: 
			mark2_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynXY_Curve");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynXY_Curve");
	    }
	}


	public int connect(GlowArrayElem o) {
	    GrowXYCurve object = (GrowXYCurve) o;
	    GdhrRefObjectInfo ret;

	    if ( x_attr == null || y_attr == null)
		return 1;

	    DynParsedAttrName pname = dyn.parseAttrName(update_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "XYCurve: " + pname.tname);
		else {
		    updateAttrFound = true;
		    updateP = ret.id;
		    updateSubid = ret.refid;
		}
	    }

	    pname = dyn.parseAttrName( noofpoints_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "XYCurve: " + pname.tname);
		else {
		    noofpointsAttrFound = true;
		    noofpointsP = ret.id;
		    noofpointsSubid = ret.refid;
		}
	    }
	    
	    pname = dyn.parseAttrName( y_minvalue_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "XYCurve: " + pname.tname);
		else {
		    yMinvalueAttrFound = true;
		    yMinvalueP = ret.id;
		    yMinvalueSubid = ret.refid;
		}
	    }
	    
	    pname = dyn.parseAttrName( y_maxvalue_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "XYCurve: " + pname.tname);
		else {
		    yMaxvalueAttrFound = true;
		    yMaxvalueP = ret.id;
		    yMaxvalueSubid = ret.refid;
		}
	    }

	    pname = dyn.parseAttrName( x_minvalue_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "XYCurve: " + pname.tname);
		else {
		    xMinvalueAttrFound = true;
		    xMinvalueP = ret.id;
		    xMinvalueSubid = ret.refid;
		}
	    }

	    pname = dyn.parseAttrName( x_maxvalue_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "XYCurve: " + pname.tname);
		else {
		    xMaxvalueAttrFound = true;
		    xMaxvalueP = ret.id;
		    xMaxvalueSubid = ret.refid;
		}
	    }

	    x_mark1_p = 0;
	    pname = dyn.parseAttrName(x_mark1_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + x_mark1_attr);
		    return 1;
		}
		else {
		    x_mark1_p = ret.id;
		    x_mark1_subid = ret.refid;
		}
	    }

	    x_mark2_p = 0;
	    pname = dyn.parseAttrName(x_mark2_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + x_mark2_attr);
		    return 1;
		}
		else {
		    x_mark2_p = ret.id;
		    x_mark2_subid = ret.refid;
		}
	    }

	    y_mark1_p = 0;
	    pname = dyn.parseAttrName(y_mark1_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + y_mark1_attr);
		    return 1;
		}
		else {
		    y_mark1_p = ret.id;
		    y_mark1_subid = ret.refid;
		}
	    }

	    y_mark2_p = 0;
	    pname = dyn.parseAttrName(y_mark2_attr);
	    if ( pname != null && !pname.name.equals("")) {
		ret = null;

		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Trend: " + y_mark2_attr);
		    return 1;
		}
		else {
		    y_mark2_p = ret.id;
		    y_mark2_subid = ret.refid;
		}
	    }

	    // Get curve number
	    curve_number = 0;
	    int m = instance;
	    while( m != 0) {
		m = m >> 1;
		curve_number++;
	    }
	    System.out.println("Curve number " + curve_number + " color " + curve_color + " fillcolor " + fill_color);
	    // Get number of curves
	    if ( instance == mInstance_1) {
		m = instance_mask;
		int noofcurves = 0;
		while( m != 0) {
		    m = m >> 1;
		    noofcurves++;
		}
		object.set_xy_noofcurves( noofcurves);
	    }

	    noofpoints = object.get_no_of_points();
	    if ( Math.abs(y_max_value - y_min_value) > Float.MIN_VALUE)
		object.set_xy_range_y( curve_number - 1, y_min_value, y_max_value);
	    if ( Math.abs(x_max_value - x_min_value) > Float.MIN_VALUE)
		object.set_xy_range_x( curve_number - 1, x_min_value, x_max_value);
	    object.set_xy_curve_color( curve_number - 1, curve_color, fill_color);
	    if ( mark1_color != Glow.eDrawType_Inherit || mark2_color != Glow.eDrawType_Inherit)
		object.set_mark_color( mark1_color, mark2_color);
	    return 1;
	}

	public void disconnect() {
	    if ( updateAttrFound)
		dyn.graph.getGdh().unrefObjectInfo( updateSubid);
	    if ( noofpointsAttrFound)
		dyn.graph.getGdh().unrefObjectInfo( noofpointsSubid);
	    if ( yMinvalueAttrFound)
		dyn.graph.getGdh().unrefObjectInfo( yMinvalueSubid);
	    if ( yMaxvalueAttrFound)
		dyn.graph.getGdh().unrefObjectInfo( yMaxvalueSubid);
	    if ( xMinvalueAttrFound)
		dyn.graph.getGdh().unrefObjectInfo( xMinvalueSubid);
	    if ( xMaxvalueAttrFound)
		dyn.graph.getGdh().unrefObjectInfo( xMaxvalueSubid);
	    if ( x_mark1_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(x_mark1_subid);
	    if ( x_mark2_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(x_mark2_subid);
	    if ( y_mark1_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(y_mark1_subid);
	    if ( y_mark2_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(y_mark2_subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowXYCurve object = (GrowXYCurve) o;
	    DynParsedAttrName pname;
	    int attrSize;
	    boolean update = false;
	    int size = 1;
	    noOfPoints = noofpoints;

	    if ( x_attr == null || y_attr == null)
		return;

	    if ( firstScan)
		update = true;

	    if ( updateAttrFound) {
		boolean value = dyn.graph.getGdh().getObjectRefInfoBoolean( updateP);
		if ( value && !updateOldValue)
		    update = true;
		updateOldValue = value;
	    }

	    if ( noofpointsAttrFound) {
		int value = dyn.graph.getGdh().getObjectRefInfoInt( noofpointsP);
		if ( value != noofpointsOldValue) {
		    update = true;
		    noofpoints = noOfPoints = value;
		    noofpointsOldValue = value;
		}
	    }

	    if ( yMinvalueAttrFound) {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( yMinvalueP);
		if ( value != y_min_value) {
		    y_min_value = value;
		    if ( Math.abs(y_max_value - y_min_value) > Float.MIN_VALUE)
		    object.set_xy_range_y( curve_number - 1, y_min_value, y_max_value);
		    update = true;
		}
	    }
	    if ( yMaxvalueAttrFound) {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( yMaxvalueP);
		if ( value != y_max_value) {
		    y_max_value = value;
		    if ( Math.abs(y_max_value - y_min_value) > Float.MIN_VALUE)
			object.set_xy_range_y( curve_number - 1, y_min_value, y_max_value);
		    update = true;
		}
	    }

	    if ( xMinvalueAttrFound) {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( xMinvalueP);
		if ( value != x_min_value) {
		    x_min_value = value;
		    if ( Math.abs(x_max_value - x_min_value) > Float.MIN_VALUE)
			object.set_xy_range_x( curve_number - 1, x_min_value, x_max_value);
		    update = true;
		}
	    }
	    if ( xMaxvalueAttrFound) {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( xMaxvalueP);
		if ( value != x_max_value) {
		    x_max_value = value;
		    if ( Math.abs(x_max_value - x_min_value) > Float.MIN_VALUE)
			object.set_xy_range_x( curve_number - 1, x_min_value, x_max_value);
		    update = true;
		}
	    }

	    if ( x_mark1_p != 0) {
		float mark1val;
		mark1val = dyn.graph.getGdh().getObjectRefInfoFloat(x_mark1_p);
		if (firstScan || Math.abs( mark1val - old_x_mark1) > Float.MIN_VALUE) {
		    object.set_x_mark1( mark1val);
		    old_x_mark1 = mark1val;
		}
	    }
	    if ( x_mark2_p != 0) {
		float mark2val;
		mark2val = dyn.graph.getGdh().getObjectRefInfoFloat(x_mark2_p);
		if (firstScan || Math.abs( mark2val - old_x_mark2) > Float.MIN_VALUE) {
		    object.set_x_mark2( mark2val);
		    old_x_mark2 = mark2val;
		}
	    }
	    if ( y_mark1_p != 0) {
		float mark1val;
		mark1val = dyn.graph.getGdh().getObjectRefInfoFloat(y_mark1_p);
		if (firstScan || Math.abs( mark1val - old_y_mark1) > Float.MIN_VALUE) {
		    object.set_y_mark1( mark1val);
		    old_y_mark1 = mark1val;
		}
	    }
	    if ( y_mark2_p != 0) {
		float mark2val;
		mark2val = dyn.graph.getGdh().getObjectRefInfoFloat(y_mark2_p);
		if (firstScan || Math.abs( mark2val - old_y_mark2) > Float.MIN_VALUE) {
		    object.set_y_mark2( mark2val);
		    old_y_mark2 = mark2val;
		}
	    }

	    if ( update) {
	        pname = dyn.parseAttrName( x_attr);
		System.out.println("xycurve xattr: " + x_attr + " pname " + pname);
		attrSize = pname.elements;
		xAttrType = pname.type;

		switch ( datatype) {
		case eCurveDataType_XYArrays:
		    if ( attrSize < noOfPoints)
			noOfPoints = attrSize;
		    size = noOfPoints;
		    break;
		case eCurveDataType_PointArray:
		    if ( attrSize/2 < noOfPoints)
			noOfPoints = attrSize/2;
		    size = noOfPoints * 2;
		    break;
		case eCurveDataType_TableObject:
		    if ( (attrSize-1)/2 < noOfPoints)
			noOfPoints = (attrSize-1)/2;
		    size = noOfPoints * 2 + 1;
		    break;
		}
      
		// Read x-array
		CdhrFloatArray rxf;
		CdhrIntArray rxi;
		switch ( xAttrType) {
		case Pwr.eType_Float32:
		    rxf = dyn.graph.getGdh().getObjectInfoFloatArray( pname.tname, size);
		    if ( rxf.evenSts())
			return;

		    switch ( datatype) {
		    case eCurveDataType_XYArrays:
			curveX = new double[noOfPoints];
			for ( int i = 0; i < noOfPoints; i++)
			    curveX[i] = (double)rxf.value[i];
			break;
		    case eCurveDataType_PointArray:
			curveX = new double[noOfPoints];
			curveY = new double[noOfPoints];
			for ( int i = 0; i < noOfPoints; i++) {
			    curveX[i] = (double)rxf.value[2*i];
			    curveY[i] = (double)rxf.value[2*i+1];
			}
			dyn.repaintNow = true;
			break;
		    case eCurveDataType_TableObject:
			noOfPoints = (int)rxf.value[0];
			if ( noOfPoints > noofpoints)
			    noOfPoints = noofpoints;
			if ( attrSize < noOfPoints)
			    noOfPoints = attrSize;
			curveY = new double[noOfPoints];
			curveX = new double[noOfPoints];
			for ( int i = 0; i < noOfPoints; i++) {
			    curveX[i] = (double)rxf.value[2*i+1];
			    curveY[i] = (double)rxf.value[2*i+2];
			}
			dyn.repaintNow = true;
			break;
		    }
		    break;
		case Pwr.eType_Int32:
		case Pwr.eType_Int16:
		case Pwr.eType_Int8:
		case Pwr.eType_UInt32:
		case Pwr.eType_UInt16:
		case Pwr.eType_UInt8:
		    rxi = dyn.graph.getGdh().getObjectInfoIntArray( pname.tname, size);
		    if ( rxi.evenSts())
			return;

		    switch ( datatype) {
		    case eCurveDataType_XYArrays:
			curveX = new double[noOfPoints];
			for ( int i = 0; i < noOfPoints; i++)
			    curveX[i] = (double)rxi.value[i];
			break;
		    case eCurveDataType_PointArray:
			curveX = new double[noOfPoints];
			curveY = new double[noOfPoints];
			for ( int i = 0; i < noOfPoints; i++) {
			    curveX[i] = (double)rxi.value[2*i];
			    curveY[i] = (double)rxi.value[2*i+1];
			}
			dyn.repaintNow = true;
			break;
		    case eCurveDataType_TableObject:
			noOfPoints = rxi.value[0];
			if ( noOfPoints > noofpoints)
			    noOfPoints = noofpoints;
			if ( attrSize < noOfPoints)
			    noOfPoints = attrSize;
			curveY = new double[noOfPoints];
			curveX = new double[noOfPoints];
			for ( int i = 0; i < noOfPoints; i++) {
			    curveX[i] = (double)rxi.value[2*i+1];
			    curveY[i] = (double)rxi.value[2*i+2];
			}
			dyn.repaintNow = true;
			break;
		    }
		    break;
		default:
		    return;
		}

		// Read y-array
		switch ( datatype) {
		case eCurveDataType_XYArrays:
		    pname = dyn.parseAttrName( y_attr);
		    if ( pname.elements < noOfPoints)
			noOfPoints = pname.elements;
		    yAttrType = pname.type;
		    curveY = new double[noOfPoints];

		    CdhrFloatArray ryf;
		    CdhrIntArray ryi;
		    switch ( yAttrType) {
		    case Pwr.eType_Float32:
			ryf = dyn.graph.getGdh().getObjectInfoFloatArray( pname.tname, noOfPoints);
			if ( ryf.evenSts())
			    return;

			for ( int i = 0; i < noOfPoints; i++)
			    curveY[i] = (double)ryf.value[i];
			dyn.repaintNow = true;
			break;
		    case Pwr.eType_Int32:
		    case Pwr.eType_Int16:
		    case Pwr.eType_Int8:
		    case Pwr.eType_UInt32:
		    case Pwr.eType_UInt16:
		    case Pwr.eType_UInt8:
			ryi = dyn.graph.getGdh().getObjectInfoIntArray( pname.tname, noOfPoints);
			if ( ryi.evenSts())
			    return;

			for ( int i = 0; i < noOfPoints; i++)
			    curveY[i] = (double)ryi.value[i];
	  
			dyn.repaintNow = true;

			break;
		    default:
			return;
		    }
		    break;
		}

		object.set_xy_data( curveY, curveX, curve_number - 1, noOfPoints);
	    }
	    firstScan = false;
	}
    }

    public class DynTable extends DynElem {
	String[] attribute = new String[12];
	String[] format = new String[12];
	String[] sel_attribute = new String[12];
	public GlowCFormat[] cFormat;
	boolean firstScan = true;
	public boolean[][] oldValueB;
	public float[][] oldValueF;
	public int[][] oldValueI;
	public String[][] oldValueS;
	int[] p;
	int[][] hp;
	int[] db;
	int[] elements;
	int[] type_id;
	int[] size;
	boolean[] headerRef;
	PwrtRefId[] subid;
	PwrtRefId[][] hsubid;
	int columns;
	int rows;
	StringBuffer sb = new StringBuffer();
	int[] sel_p;
	int[] sel_elements;
	PwrtRefId[] sel_subid;
	int[] bitmask;

	public DynTable( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Table, 0, 0, 0, Dyn.eDynPrio_Table);
	}

	public DynTable( DynTable x) {
	    super(x);
	    attribute = x.attribute;
	    format = x.format;
	    sel_attribute = x.sel_attribute;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynTable : " + line);

		    switch ( key) {
		    case Dyn.eSave_Table: 
			break;
		    case Dyn.eSave_Table_attribute1: 
			if ( token.hasMoreTokens())
			    attribute[0] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format1: 
			if ( token.hasMoreTokens())
			    format[0] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute1: 
			if ( token.hasMoreTokens())
			    sel_attribute[0] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute2: 
			if ( token.hasMoreTokens())
			    attribute[1] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format2: 
			if ( token.hasMoreTokens())
			    format[1] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute2: 
			if ( token.hasMoreTokens())
			    sel_attribute[1] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute3: 
			if ( token.hasMoreTokens())
			    attribute[2] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format3: 
			if ( token.hasMoreTokens())
			    format[2] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute3: 
			if ( token.hasMoreTokens())
			    sel_attribute[2] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute4: 
			if ( token.hasMoreTokens())
			    attribute[3] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format4: 
			if ( token.hasMoreTokens())
			    format[3] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute4: 
			if ( token.hasMoreTokens())
			    sel_attribute[3] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute5: 
			if ( token.hasMoreTokens())
			    attribute[4] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format5: 
			if ( token.hasMoreTokens())
			    format[4] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute5: 
			if ( token.hasMoreTokens())
			    sel_attribute[4] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute6: 
			if ( token.hasMoreTokens())
			    attribute[5] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format6: 
			if ( token.hasMoreTokens())
			    format[5] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute6: 
			if ( token.hasMoreTokens())
			    sel_attribute[5] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute7: 
			if ( token.hasMoreTokens())
			    attribute[6] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format7: 
			if ( token.hasMoreTokens())
			    format[6] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute7: 
			if ( token.hasMoreTokens())
			    sel_attribute[6] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute8: 
			if ( token.hasMoreTokens())
			    attribute[7] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format8: 
			if ( token.hasMoreTokens())
			    format[7] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute8: 
			if ( token.hasMoreTokens())
			    sel_attribute[7] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute9: 
			if ( token.hasMoreTokens())
			    attribute[8] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format9: 
			if ( token.hasMoreTokens())
			    format[8] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute9: 
			if ( token.hasMoreTokens())
			    sel_attribute[8] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute10: 
			if ( token.hasMoreTokens())
			    attribute[9] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format10: 
			if ( token.hasMoreTokens())
			    format[9] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute10: 
			if ( token.hasMoreTokens())
			    sel_attribute[9] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute11: 
			if ( token.hasMoreTokens())
			    attribute[10] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format11: 
			if ( token.hasMoreTokens())
			    format[10] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute11: 
			if ( token.hasMoreTokens())
			    sel_attribute[10] = token.nextToken();
			break;
		    case Dyn.eSave_Table_attribute12: 
			if ( token.hasMoreTokens())
			    attribute[11] = token.nextToken();
			break;
		    case Dyn.eSave_Table_format12: 
			if ( token.hasMoreTokens())
			    format[11] = token.nextToken();
			break;
		    case Dyn.eSave_Table_sel_attribute12: 
			if ( token.hasMoreTokens())
			    sel_attribute[11] = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynTable");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynTable");
	    }
	}

	public int connect(GlowArrayElem o) {
	    GrowTable object = (GrowTable)o;
	    int		sts;
	    String	aname0 = null;

	    GlowTableInfo info = object.getTableInfo();
	    columns = info.columns;
	    rows = info.rows;

	    db = new int[columns];
	    size = new int[columns];
	    elements = new int[columns];
	    type_id = new int[columns];
	    subid = new PwrtRefId[columns];
	    headerRef = new boolean[columns];
	    p = new int[columns];
	    for ( int i = 0; i < columns; i++)
		p[i] = -1;
	    oldValueB = new boolean[columns][];
	    oldValueF = new float[columns][];
	    oldValueI = new int[columns][];
	    oldValueS = new String[columns][];
	    cFormat = new GlowCFormat[columns];
	    for ( int i = 0; i < columns; i++)
		cFormat[i] = new GlowCFormat( format[i]);
	    sel_p = new int[columns];
	    sel_subid = new PwrtRefId[columns];
	    sel_elements = new int[columns];
	    bitmask = new int[columns];

	    for ( int i = 0; i < columns; i++) {
		DynParsedAttrName pname = dyn.parseAttrName(attribute[i]);
		if ( pname == null || pname.name.equals("")) 
		    continue;

		if ( pname.elements == 0)
		    continue;

		db[i] = pname.database;

		GdhrRefObjectInfo ret = null;

		if ( !pname.tname.startsWith("$header")) { 
		    switch ( db[i]) {
		    case GraphIfc.eDatabase_Gdh:
			ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
			System.out.println("Table ret.sts " + ret.getSts());
			if ( i == 0)
			    aname0 = pname.name;
			break;
		    default:
			;
		    }
		    if ( ret == null || ret.evenSts())
			continue;

		    p[i] = ret.id;
		    size[i] = ret.size;
		    type_id[i] = pname.type;
		    subid[i] = ret.refid;
		    elements[i] = Math.min(ret.getElements(), rows);
		    bitmask[i] = pname.bitmask;
		    System.out.println("Table ret p: " + p[i] + " type_id: " + type_id[i]);
		}
		else {
		    headerRef[i] = true;

		    if ( aname0 == null)
			continue;
		    
		    for ( int j = 0; j < elements[0]; j++) {
			String hname = aname0 + "[" + j + "]";
			CdhrString sret = dyn.graph.getGdh().getObjectInfoString(hname);
			if ( sret.evenSts() || sret.str.equals(""))
			    continue;

			String aname = sret.str + pname.tname.substring(7);

			ret = dyn.graph.getGdh().refObjectInfo( aname);
			System.out.println("Table $header " + i + " ret.sts " + ret.getSts());

			if ( ret.evenSts())
			    continue;

			if ( hp == null) {
			    hp = new int[columns][];
			    hsubid = new PwrtRefId[columns][];
			}
			if ( hp[i] == null) {
			    hp[i] = new int[elements[0]];
			    hsubid[i] = new PwrtRefId[elements[0]];
			    for ( int k = 0; k < elements[0]; k++) 
				hp[i][k] = -1;
			}

			hp[i][j] = ret.id;
			hsubid[i][j] = ret.refid;
			if ( j == 0) {
			    size[i] = ret.size;
			    type_id[i] = pname.type;
			    elements[i] = elements[0];
			    bitmask[i] = pname.bitmask;
			}
		    }
		}

		switch ( type_id[i]) {
		case Pwr.eType_Float32:
		    oldValueF[i] = new float[rows];
		    break;
		case Pwr.eType_Boolean:
		case GraphIfc.eType_Bit:
		    oldValueB[i] = new boolean[rows];
		    break;
		case Pwr.eType_Int32:
		case Pwr.eType_Int16:
		case Pwr.eType_Int8:
		case Pwr.eType_UInt32:
		case Pwr.eType_UInt16:
		case Pwr.eType_UInt8:
		    oldValueI[i] = new int[rows];
		    break;
		case Pwr.eType_String:
		case Pwr.eType_Objid:
		case Pwr.eType_AttrRef:
		case Pwr.eType_Time:
		case Pwr.eType_DeltaTime:
		    oldValueS[i] = new String[rows];
		    break;
		}

    
		// Connect select array
		sel_p[i] = 0;
		pname = dyn.parseAttrName(sel_attribute[i]);
		if ( pname == null || pname.name.equals("")) 
		    continue;

		if ( pname.type != Pwr.eType_Boolean)
		    continue;

		switch ( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    if ( ret.oddSts()) {
			if ( ret.getElements() == 0)
			    break;
			sel_p[i] = ret.id;
			sel_subid[i] = ret.refid;
			sel_elements[i] = ret.getElements();
			if ( sel_elements[i] > elements[i])
			    sel_elements[i] = elements[i];
		    }
		    break;
		default:
		    ;
		}

	    }
	    object.setTableInfo(info);

	    return 1;
	}

	public void disconnect() {
	    for ( int i = 0; i < columns; i++) {
		if ( !headerRef[i]) {
		    if ( p[i] != -1 && db[i] == GraphIfc.eDatabase_Gdh)
			dyn.graph.getGdh().unrefObjectInfo(subid[i]);
		    p[i] = -1;
		}
		else {
		    for ( int j = 0; j < elements[i]; j++) {
			if ( hp[i][j] != -1)
			    dyn.graph.getGdh().unrefObjectInfo(hsubid[i][j]);
		    }
		}
		switch (type_id[i]) {
		case Pwr.eType_Float32:
		    if ( oldValueF[i] != null)
			oldValueF[i] = null;
		    break;
		case Pwr.eType_Boolean:
		case GraphIfc.eType_Bit:
		    if ( oldValueB[i] != null)
			oldValueB[i] = null;
		    break;
		case Pwr.eType_Int32:
		case Pwr.eType_Int16:
		case Pwr.eType_Int8:
		case Pwr.eType_UInt32:
		case Pwr.eType_UInt16:
		case Pwr.eType_UInt8:
		    if ( oldValueI[i] != null)
			oldValueI[i] = null;
		    break;
		case Pwr.eType_String:
		case Pwr.eType_Objid:
		case Pwr.eType_AttrRef:
		case Pwr.eType_Time:
		case Pwr.eType_DeltaTime:
		    if ( oldValueS[i] != null)
			oldValueS[i] = null;
		    break;
		}
		if ( sel_p[i] != 0) {
		    dyn.graph.getGdh().unrefObjectInfo(sel_subid[i]);
		    sel_p[i] = 0;
		}
	    }
	}

	public void scan( GlowArrayElem o) {
	    GrowTable object = (GrowTable)o;

	    if ( p[0] == -1)
		return;

	    for ( int i = 0; i < columns; i++) {
		if ( !headerRef[i]) {
		    if ( p[i] == -1)
			continue;
		
		    switch ( type_id[i]) {
		    case Pwr.eType_Float32: {
			float[] val = dyn.graph.getGdh().getObjectRefInfoFloatArray(p[i], elements[i]);
			if ( val == null)
			    break;
			for ( int j = 0; j < Math.min(elements[i], val.length); j++) {
			    if ( oldValueF[i][j] != val[j] || firstScan) {
				sb = cFormat[i].format( val[j], sb);
				object.setValue(new String(sb), i, j);
				oldValueF[i][j] = val[j];
			    }
			}
			break;
		    }
		    case Pwr.eType_Boolean: {
			boolean[] val = dyn.graph.getGdh().getObjectRefInfoBooleanArray(p[i], elements[i]);
			if ( val == null)
			    break;
			for ( int j = 0; j < Math.min(elements[i], val.length); j++) {
			    if ( firstScan || oldValueB[i][j] != val[j]) {
				if ( val[j])
				    object.setValue(new String("1"), i, j);
				else
				    object.setValue(new String("0"), i, j);
				//object.setValue(new String(sb), i, j);
				oldValueB[i][j] = val[j];
			    }
			}
			break;
		    }
		    case Pwr.eType_Int32:
		    case Pwr.eType_Int16:
		    case Pwr.eType_Int8:
		    case Pwr.eType_UInt32:
		    case Pwr.eType_UInt16:
		    case Pwr.eType_UInt8: {
			int[] val = dyn.graph.getGdh().getObjectRefInfoIntArray(p[i], elements[i]);
			if ( val == null)
			    break;
			for ( int j = 0; j < Math.min(elements[i], val.length); j++) {
			    if ( oldValueI[i][j] != val[j] || firstScan) {
				sb = cFormat[i].format( val[j], sb);
				object.setValue(new String(sb), i, j);
				oldValueI[i][j] = val[j];
			    }
			}
			break;
		    }
		    case Pwr.eType_String:
		    case Pwr.eType_Objid:
		    case Pwr.eType_AttrRef:
		    case Pwr.eType_Time:
		    case Pwr.eType_DeltaTime: {
			String[] val = dyn.graph.getGdh().getObjectRefInfoStringArray(p[i], type_id[i],
										      size[i], elements[i]);
			if ( val == null)
			    break;
			for ( int j = 0; j < Math.min(elements[i], val.length); j++) {
			    if ( firstScan || !oldValueS[i][j].equals(val[j])) {
				switch ( type_id[i]) {
				case Pwr.eType_AttrRef:
				case Pwr.eType_Objid: {
				    if ( format[i].equals("%1o"))
					object.setValue(val[j], i, j);
				    else {
					int idx = val[j].lastIndexOf('-');
					if ( idx == -1)
					    object.setValue(val[j], i, j);
					else
					    object.setValue(val[j].substring(idx+1), i, j);
				    }
					
				    break;
				}
				default:
				    object.setValue(val[j], i, j);
				}
				oldValueS[i][j] = val[j];
			    }
			}
			break;
		    }
		    case GraphIfc.eType_Bit: {
			int[] val = dyn.graph.getGdh().getObjectRefInfoIntArray(p[i], elements[i]);
			if ( val == null)
			    break;
			for ( int j = 0; j < Math.min(elements[i], val.length); j++) {
			    boolean bitval = ((bitmask[i] & val[j]) != 0);
			    if ( oldValueB[i][j] != bitval || firstScan) {
				if ( bitval)
				    object.setValue(new String("1"), i, j);
				else
				    object.setValue(new String("0"), i, j);
				oldValueB[i][j] = bitval;
			    }
			}
			break;
		    }

		    }
		}
		else {
		    // $header reference
		    for ( int j = 0; j < elements[i]; j++) {
			if ( hp[i][j] == -1)
			    continue;

			switch ( type_id[i]) {
			case Pwr.eType_Float32: {
			    float val = dyn.graph.getGdh().getObjectRefInfoFloat(hp[i][j]);
			    if ( oldValueF[i][j] != val || firstScan) {
				sb = cFormat[i].format( val, sb);
				object.setValue(new String(sb), i, j);
				oldValueF[i][j] = val;
			    }
			    break;
			}
			case Pwr.eType_Boolean: {
			    boolean val = dyn.graph.getGdh().getObjectRefInfoBoolean(hp[i][j]);
			    if ( firstScan || oldValueB[i][j] != val) {
				if ( val)
				    object.setValue(new String("1"), i, j);
				else
				    object.setValue(new String("0"), i, j);
				object.setValue(new String(sb), i, j);
				oldValueB[i][j] = val;
			    }
			    break;
			}
			case Pwr.eType_Int32:
			case Pwr.eType_Int16:
			case Pwr.eType_Int8:
			case Pwr.eType_UInt32:
			case Pwr.eType_UInt16:
			case Pwr.eType_UInt8: {
			    int val = dyn.graph.getGdh().getObjectRefInfoInt(hp[i][j]);
			    if ( oldValueI[i][j] != val || firstScan) {
				sb = cFormat[i].format( val, sb);
				object.setValue(new String(sb), i, j);
				oldValueI[i][j] = val;
			    }
			    break;
			}
			case Pwr.eType_String:
			case Pwr.eType_Objid:
			case Pwr.eType_AttrRef:
			case Pwr.eType_Time:
			case Pwr.eType_DeltaTime: {
			    String val = dyn.graph.getGdh().getObjectRefInfoString(hp[i][j], type_id[i]);
			    if ( firstScan || !oldValueS[i][j].equals(val)) {
				object.setValue(val, i, j);
				oldValueS[i][j] = val;
			    }
			    break;
			}
			case GraphIfc.eType_Bit: {
			    int val = dyn.graph.getGdh().getObjectRefInfoInt(hp[i][j]);

			    boolean bitval = ((bitmask[i] & val) != 0);
			    if ( oldValueB[i][j] != bitval || firstScan) {
				if ( bitval)
				    object.setValue(new String("1"), i, j);
				else
				    object.setValue(new String("0"), i, j);
				oldValueB[i][j] = bitval;
			    }
			    break;
			}			

			}
		    }
		}
	    }

	    // Examine select array
	    boolean sel_found = false;
	    for ( int i = 0; i < columns; i++) {
		if ( sel_p[i] == 0)
		    continue;
		boolean[] val = dyn.graph.getGdh().getObjectRefInfoBooleanArray(sel_p[i], sel_elements[i]);
		if ( val == null)
		    continue;
		for ( int j = 0; j < sel_elements[i]; j++) {
		    if ( val[j]) {
			sel_found = true;
			object.setSelectedCell( i, j);
		    }
		}
	    }
	    if ( !sel_found)
		object.setSelectedCell( -1, -1);

	    if ( firstScan)
		firstScan = false;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;
	    GrowTable object = (GrowTable)o;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Click:
		int column, row;
		boolean	value;

		if ( e.type != Glow.eEventType_Table)
		    break;

		GlowEventTable event = (GlowEventTable)e;
		row = object.getSelectedCellRow();
		column = object.getSelectedCellColumn();
		if ( row >= 0 && sel_p[column] != 0) {
		    // Reset previously selected
		    DynParsedAttrName pname = dyn.parseAttrName(sel_attribute[column]);
		    if ( pname == null || pname.name.equals("")) 
			break;
		    value = false;
		    String aname = pname.name + "[" + row + "]";
		    PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( aname, value);
		    if ( sts.evenSts()) System.out.println("Table error: " + pname.name);
		}
		if ( sel_p[event.column] != 0 && 
		     !(event.column == column && event.row == row)) {
		    // Set new selected, if not same as previous selected
		    DynParsedAttrName pname = dyn.parseAttrName(sel_attribute[event.column]);
		    if ( pname == null || pname.name.equals("")) 
			break;
		    value = true;
		    String aname = pname.name + "[" + event.row + "]";
		    PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( aname, value);
		    if ( sts.evenSts()) 
			System.out.println("Table error: " + pname.name);
		    else
			object.setSelectedCell( event.column, event.row);
		}
		break;
	    }
	    return 1;
	}
    }

    public class DynStatusColor extends DynElem {
	String attribute;
	int nostatus_color;
	int use_colortheme;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	int oldValue;
	boolean firstScan = true;
	int a_typeid;
	int oldStatus;
	boolean on;


	public DynStatusColor( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_StatusColor, 0, 0, 0, Dyn.eDynPrio_StatusColor);
	}

	public DynStatusColor( DynStatusColor x) {
	    super(x);
	    attribute = x.attribute;
	    nostatus_color = x.nostatus_color;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("StatusColor: " + attribute);
		return 1;
	    }

	    attrFound = true;
	    p = ret.id;
	    subid = ret.refid;
	    a_typeid = pname.type;
	    database = pname.database;

	    return 1;
	}


	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}
	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound || dyn.ignoreColor)
		return;

	    if ( database == GraphIfc.eDatabase_Gdh && a_typeid == Pwr.eType_NetStatus) {
		// TODO get subscription oldness
	    }

	    int value = dyn.graph.getGdh().getObjectRefInfoInt( p);

	    if ( !firstScan && oldStatus != Dyn.ePwrStatus_Fatal) {
		if ( oldValue == value && dyn.resetColor)
		    // No change since last time
		    return;
	    }

	    oldValue = value;

	    if ( value == 0)
		value = Dyn.ePwrStatus_No;
	    else {
		switch ( value & 7) {
		case 3:
		case 1:
		    value = Dyn.ePwrStatus_Success;
		    break;
		case 0:
		    value = Dyn.ePwrStatus_Warning;
		    break;
		case 2:
		    value = Dyn.ePwrStatus_Error;
		    break;
		case 4:
		    value = Dyn.ePwrStatus_Fatal;
		    break;
		default:
		    value = Dyn.ePwrStatus_No;
		}
	    }
	    if ( !firstScan && oldStatus == value && oldStatus != Dyn.ePwrStatus_Fatal)
		return;
	    else
		firstScan = false;

	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		switch ( value) {
		case Dyn.ePwrStatus_No:
		    if ( nostatus_color >= Glow.eDrawTone__)
			object.setFillColor( nostatus_color);
		    else
			object.setColorTone( nostatus_color);
		    break;
		case Dyn.ePwrStatus_Success:
		    if ( nostatus_color >= Glow.eDrawTone__)
			object.resetFillColor();
		    object.resetColorTone();
		    break;
		case Dyn.ePwrStatus_Warning:
		    object.setColorTone( (use_colortheme != 0) ? Glow.eDrawType_CustomColor42 : Glow.eDrawTone_Yellow);
		    break;
		case Dyn.ePwrStatus_Error:
		    object.setColorTone( (use_colortheme != 0) ? Glow.eDrawType_CustomColor11 : Glow.eDrawTone_Red);
		    break;
		case Dyn.ePwrStatus_Fatal:
		    on = !on;
		    if ( on)
			object.setColorTone( (use_colortheme != 0) ? Glow.eDrawType_CustomColor11 : Glow.eDrawTone_Red);
		    else {
			if ( nostatus_color >= Glow.eDrawTone__)
			    object.setFillColor( nostatus_color);
			else
			    object.setColorTone( nostatus_color);
		    }
		    break;
		}
		dyn.repaintNow = true;
	    }
	    else {
		switch ( value) {
		case Dyn.ePwrStatus_No:
		    object.setFillColor( nostatus_color);
		    break;
		case Dyn.ePwrStatus_Success:
		    object.resetFillColor();
		    break;
		case Dyn.ePwrStatus_Warning:
		    object.setFillColor( Glow.eDrawType_ColorYellow);
		    break;
		case Dyn.ePwrStatus_Error:
		    object.setFillColor( Glow.eDrawType_ColorRed);
		    break;
		case Dyn.ePwrStatus_Fatal:
		    on = !on;
		    if ( on)
			object.setFillColor( Glow.eDrawType_ColorRed);
		    else
			object.setFillColor( nostatus_color);
		    break;
		}
		dyn.repaintNow = true;
	    }
	    oldStatus = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynStatusColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_StatusColor: 
			break;
		    case Dyn.eSave_StatusColor_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_StatusColor_nostatus_color: 
			nostatus_color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_StatusColor_use_colortheme:
			use_colortheme = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynStatusColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynStatusColor");
	    }
	}

    }

    public class DynPie extends DynElem {
	String[] attribute = new String[GrowPie.PIE_MAX_SECTORS];
	int sectors;
	double min_value;
	double max_value;
	int fix_range;
	int attr_type;
	int p[] = new int[GrowPie.PIE_MAX_SECTORS];
	PwrtRefId[] subid = new PwrtRefId[GrowPie.PIE_MAX_SECTORS];
	boolean[] inverted = new boolean[GrowPie.PIE_MAX_SECTORS];
	int[] a_typeid = new int[GrowPie.PIE_MAX_SECTORS];
	boolean[] attrFound = new boolean[GrowPie.PIE_MAX_SECTORS];
	float[] oldValueF;
	int[] oldValueI;
	boolean firstScan = true;

	public DynPie( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_Pie, 0, 0, 0, Dyn.eDynPrio_Pie);
	}

	public DynPie( DynPie x) {
	    super(x);
	    for ( int i = 0; i < GrowPie.PIE_MAX_SECTORS; i++)
		attribute[i] = x.attribute[i];
	    sectors = x.sectors;
	    min_value = x.min_value;
	    max_value = x.max_value;
	    fix_range = x.fix_range;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynPie : " + line);

		    switch ( key) {
		    case Dyn.eSave_Pie: 
			break;
		    case Dyn.eSave_Pie_fix_range: 
			fix_range = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Pie_attribute1: 
			if ( token.hasMoreTokens())
			    attribute[0] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute2: 
			if ( token.hasMoreTokens())
			    attribute[1] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute3: 
			if ( token.hasMoreTokens())
			    attribute[2] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute4: 
			if ( token.hasMoreTokens())
			    attribute[3] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute5: 
			if ( token.hasMoreTokens())
			    attribute[4] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute6: 
			if ( token.hasMoreTokens())
			    attribute[5] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute7: 
			if ( token.hasMoreTokens())
			    attribute[6] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute8: 
			if ( token.hasMoreTokens())
			    attribute[7] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute9: 
			if ( token.hasMoreTokens())
			    attribute[8] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute10: 
			if ( token.hasMoreTokens())
			    attribute[9] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute11: 
			if ( token.hasMoreTokens())
			    attribute[10] = token.nextToken();
			break;
		    case Dyn.eSave_Pie_attribute12: 
			if ( token.hasMoreTokens())
			    attribute[11] = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynPie");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynPie");
	    }
	}

	public int connect(GlowArrayElem o) {
	    GrowPie object = (GrowPie)o;	    

	    GlowPieInfo info = object.get_conf();
	    min_value = info.min_val;
	    max_value = info.max_val;
	    sectors = info.sector_num;
	    if ( sectors > GrowPie.PIE_MAX_SECTORS)
		 sectors = GrowPie.PIE_MAX_SECTORS;
		 
	    for ( int i = 0; i < sectors; i++) {
		if ( attribute[i] == null)
		    continue;

		DynParsedAttrName pname = dyn.parseAttrName(attribute[i]);
		if ( pname == null || pname.name.equals("")) 
		    continue;

		if ( i == 0) {
		    attr_type = pname.type;
		    switch ( attr_type) {			
		    case Pwr.eType_Float32:
			oldValueF = new float[GrowPie.PIE_MAX_SECTORS];
			break;
		    case Pwr.eType_Int32:
			oldValueI = new int[GrowPie.PIE_MAX_SECTORS];
			break;
		    default:
			return 1;
		    }
		}
		else {
		    if ( attr_type != pname.type)
			continue;
		}

		
		GdhrRefObjectInfo ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}
		
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Pie: " + attribute[i]);
		    return 1;
		}
		
		p[i] = ret.id;
		subid[i] = ret.refid;
		inverted[i] = pname.inverted;
		a_typeid[i] = pname.type;
		attrFound[i] = true;
	    }
	    return 1;
	}

	public void disconnect() {
	    for ( int i = 0; i < sectors; i++) {
		if ( attrFound[i])
		    dyn.graph.getGdh().unrefObjectInfo(subid[i]);
	    }
	}
	
	public void scan( GlowArrayElem o) {
	    GrowPie object = (GrowPie)o;

	    switch ( attr_type) {
	    case Pwr.eType_Float32: {    
		float[] val = new float[GrowPie.PIE_MAX_SECTORS];
		for ( int i = 0; i < sectors; i++)
		    val[i] = dyn.graph.getGdh().getObjectRefInfoFloat( p[i]);

		if ( !firstScan) {
		    int update = 0;
		    for ( int i = 0; i < sectors; i++) {
			if ( Math.abs( oldValueF[i] - val[i]) > Float.MIN_VALUE) {
			    update = 1;
			    break;
			}
		    }
		    if ( update == 0)
			return;
		}
		else
		    firstScan = false;
		
		if ( Math.abs( max_value - min_value) < Float.MIN_VALUE)
		    return;
		
		double[] dval = new double[GrowPie.PIE_MAX_SECTORS];
		if ( fix_range != 0|| sectors == 1) {
		    for ( int i = 0; i < sectors; i++)
			dval[i] = val[i] - min_value;
		}
		else {
		    double sum = 0;
		    for ( int i = 0; i < sectors; i++)
			sum += val[i] - min_value;
		    for ( int i = 0; i < sectors; i++) {
			if ( Math.abs( sum) < Double.MIN_VALUE)
			    dval[i] = 0;
			else
			    dval[i] = (val[i] - min_value) / sum * (max_value - min_value);
		    }
		}
		
		object.set_values( dval);
		for ( int i = 0; i < sectors; i++)
		    oldValueF[i] = val[i];
		break;
	    }
	    case Pwr.eType_Int32: {
		break;
	    }
	    default: ;
	    }
	}
    }

    public class DynBarChart extends DynElem {
	String[] attribute = new String[GrowBarChart.BARCHART_MAX_BARSEGMENTS];
	int bars;
	int barsegments;
	double min_value;
	double max_value;
	int fix_range;
	float[][] valueF;
	int[][] valueI;
	float[][] oldValueF;
	int[][] oldValueI;
	int attr_type;
	int p[] = new int[GrowBarChart.BARCHART_MAX_BARSEGMENTS];
	PwrtRefId[] subid = new PwrtRefId[GrowBarChart.BARCHART_MAX_BARSEGMENTS];
	boolean[] inverted = new boolean[GrowBarChart.BARCHART_MAX_BARSEGMENTS];
	int[] a_typeid = new int[GrowBarChart.BARCHART_MAX_BARSEGMENTS];
	boolean[] attrFound = new boolean[GrowBarChart.BARCHART_MAX_BARSEGMENTS];
	boolean firstScan = true;

	public DynBarChart( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_BarChart, 0, 0, 0, Dyn.eDynPrio_BarChart);
	}

	public DynBarChart( DynBarChart x) {
	    super(x);	    
	    bars = x.bars;
	    barsegments = x.barsegments;
	    min_value = x.min_value;
	    max_value = x.max_value;
	    fix_range = x.fix_range;
	    for ( int i = 0; i < GrowBarChart.BARCHART_MAX_BARSEGMENTS; i++)
		attribute[i] = x.attribute[i];
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynBarChart : " + line);

		    switch ( key) {
		    case Dyn.eSave_BarChart: 
			break;
		    case Dyn.eSave_BarChart_fix_range: 
			fix_range = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_BarChart_attribute1: 
			if ( token.hasMoreTokens())
			    attribute[0] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute2: 
			if ( token.hasMoreTokens())
			    attribute[1] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute3: 
			if ( token.hasMoreTokens())
			    attribute[2] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute4: 
			if ( token.hasMoreTokens())
			    attribute[3] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute5: 
			if ( token.hasMoreTokens())
			    attribute[4] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute6: 
			if ( token.hasMoreTokens())
			    attribute[5] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute7: 
			if ( token.hasMoreTokens())
			    attribute[6] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute8: 
			if ( token.hasMoreTokens())
			    attribute[7] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute9: 
			if ( token.hasMoreTokens())
			    attribute[8] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute10: 
			if ( token.hasMoreTokens())
			    attribute[9] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute11: 
			if ( token.hasMoreTokens())
			    attribute[10] = token.nextToken();
			break;
		    case Dyn.eSave_BarChart_attribute12: 
			if ( token.hasMoreTokens())
			    attribute[11] = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynBarChart");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynBarChart");
	    }
	}

	public int connect(GlowArrayElem o) {
	    GrowBarChart object = (GrowBarChart)o;	    

	    GlowBarChartInfo info = object.get_conf();
	    min_value = info.min_value;
	    max_value = info.max_value;
	    bars = info.bars;
	    barsegments = info.barsegments;
		 
	    for ( int i = 0; i < barsegments; i++) {
		if ( attribute[i] == null)
		    continue;

		DynParsedAttrName pname = dyn.parseAttrName(attribute[i]);
		if ( pname == null || pname.name.equals("")) 
		    continue;

		if ( pname.elements == 0)
		    continue;

		bars = Math.min( bars, pname.elements);
		if ( i == 0) {
		    attr_type = pname.type;
		    switch ( attr_type) {			
		    case Pwr.eType_Float32:
			valueF = new float[barsegments][];
			break;
		    case Pwr.eType_Int32:
			valueI = new int[barsegments][];
			break;
		    default:
			return 1;
		    }
		}
		else {
		    if ( attr_type != pname.type)
			continue;
		}

		
		GdhrRefObjectInfo ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}
		
		if ( ret == null || ret.evenSts()) {
		    System.out.println("Pie: " + attribute[i]);
		    return 1;
		}
		
		p[i] = ret.id;
		subid[i] = ret.refid;
		inverted[i] = pname.inverted;
		a_typeid[i] = pname.type;
		attrFound[i] = true;
	    }
	    return 1;
	}

	public void disconnect() {
	    for ( int i = 0; i < barsegments; i++) {
		if ( attrFound[i])
		    dyn.graph.getGdh().unrefObjectInfo(subid[i]);
	    }
	}
	
	public void scan( GlowArrayElem o) {
	    GrowBarChart object = (GrowBarChart)o;

	    switch ( attr_type) {
	    case Pwr.eType_Float32: {    
		valueF = new float[GrowBarChart.BARCHART_MAX_BARSEGMENTS][];
		for ( int i = 0; i < barsegments; i++) {
		    valueF[i] = dyn.graph.getGdh().getObjectRefInfoFloatArray( p[i], bars);
		}

		if ( !firstScan) {
		    int update = 0;
		    if ( oldValueF != null) {
			for ( int i = 0; i < barsegments && valueF[i] != null; i++) {
			    if ( oldValueF[i] == null || valueF[i] == null)				
				break;
			    for ( int j = 0; j < bars; j++) {
				if ( Math.abs( oldValueF[i][j] - valueF[i][j]) > Float.MIN_VALUE) {
				    update = 1;
				    break;
				}
			    }
			    if ( update == 1)
				break;
			}
			if ( update == 0)
			    return;
		    }
		}
		else
		    firstScan = false;
		
		if ( Math.abs( max_value - min_value) < Float.MIN_VALUE)
		    return;
		
		object.set_values( valueF[0], valueF[1], valueF[2], valueF[3], valueF[4], 
				   valueF[5], valueF[6], valueF[7], valueF[8], valueF[9], 
				   valueF[10], valueF[11]);
		oldValueF = valueF;

		break;
	    }
	    case Pwr.eType_Int32: {
		break;
	    }
	    default: ;
	    }
	}
    }

    public class DynAxis extends DynElem {
	String minvalue_attr;
	String maxvalue_attr;
	int attr_type;
	int min_value_p;
	int max_value_p;
        float old_min_value;
	float old_max_value;
	boolean minvalueAttrFound = false;
	boolean maxvalueAttrFound = false;
	boolean firstScan = true;
	PwrtRefId minvalueSubid;
	PwrtRefId maxvalueSubid;
	int keep_settings = 0;

	public DynAxis( Dyn dyn) {
	    super(dyn, 0, Dyn.mDynType2_Axis, 0, 0, Dyn.eDynPrio_Axis);
	}

	public DynAxis( DynAxis x) {
	    super(x);
	    minvalue_attr = x.minvalue_attr;
	    maxvalue_attr = x.maxvalue_attr;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynAxis : " + line);

		    switch ( key) {
		    case Dyn.eSave_Axis: 
			break;
		    case Dyn.eSave_Axis_minvalue_attr: 
			if ( token.hasMoreTokens())
			    minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_Axis_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_Axis_keep_settings: 
			keep_settings = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynAxis");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynAxis");
	    }
	}

	public int connect(GlowArrayElem o) {
	    int attr_type_min = 0;
	    int attr_type_max = 0;

	    min_value_p = -1;
	    max_value_p = -1;

	    DynParsedAttrName pname = dyn.parseAttrName( minvalue_attr);
	    if ( pname != null && !pname.name.equals("")) {
		GdhrRefObjectInfo ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "Axis: " + pname.tname);
		else {
		    minvalueAttrFound = true;
		    min_value_p = ret.id;
		    minvalueSubid = ret.refid;
		    attr_type_min = ret.typeId;
		}
	    }
	    
	    pname = dyn.parseAttrName( maxvalue_attr);
	    if ( pname != null && !pname.name.equals("")) {
		GdhrRefObjectInfo ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret.evenSts())
		    System.out.println( "Axis: " + pname.tname);
		else {
		    maxvalueAttrFound = true;
		    max_value_p = ret.id;
		    maxvalueSubid = ret.refid;
		    attr_type_max = ret.typeId;
		}
	    }


	    if ( minvalueAttrFound && maxvalueAttrFound) {
		if ( attr_type_min != attr_type_max)
		    attr_type = 0;
		else
		    attr_type = attr_type_max;
	    }
	    else if ( maxvalueAttrFound)
		attr_type = attr_type_max;
	    else if ( minvalueAttrFound)
		attr_type = attr_type_min;
	    
	    return 1;
	}

	public void disconnect() {
	    if ( minvalueAttrFound) {
		dyn.graph.getGdh().unrefObjectInfo( minvalueSubid);
		min_value_p = -1;
	    }
	    if ( maxvalueAttrFound) {
		dyn.graph.getGdh().unrefObjectInfo( maxvalueSubid);
		max_value_p = -1;
	    }
	    return;
	}

	public void scan( GlowArrayElem o) {

	    switch ( attr_type) {
	    case Pwr.eType_Float32: {
 		if ( !maxvalueAttrFound && !minvalueAttrFound)
		    return;

		float min_value = 0;
		float max_value = 0;

		if ( minvalueAttrFound)
		    min_value = dyn.graph.getGdh().getObjectRefInfoFloat( min_value_p);
		if ( maxvalueAttrFound)
		    max_value = dyn.graph.getGdh().getObjectRefInfoFloat( max_value_p);
  
		if ( !(firstScan ||
		       (maxvalueAttrFound && ( max_value != old_max_value)) ||
		       (minvalueAttrFound && ( min_value != old_min_value))))
		    return;
	       
		if ( firstScan)
		    firstScan = true;
		if ( minvalueAttrFound)
		    old_min_value = min_value;
		if ( maxvalueAttrFound)
		    old_max_value = max_value;

		if ( o.type() == Glow.eObjectType_GrowAxis)
		    ((GrowAxis)o).set_range( min_value, max_value, keep_settings);
		else if ( o.type() == Glow.eObjectType_GrowAxisArc)
		    ((GrowAxisArc)o).set_range( min_value, max_value, keep_settings);
		break;
	    }
	    default: ;
	    }
	    return;
	}
    }

    public class DynTimeoutColor extends DynElem {
	double time;
	int color;
	
	public DynTimeoutColor( Dyn dyn) {
	    super(dyn, Dyn.mDynType2_TimeoutColor, 0, 0, 0, Dyn.eDynPrio_TimeoutColor);
	}

	public DynTimeoutColor( DynTimeoutColor x) {
	    super(x);
	    color = x.color;
	    time = x.time;
	}

	public int connect(GlowArrayElem o) {
	    return 1;
	}

	public void disconnect() {
	}

	
	public void scan( GlowArrayElem o) {
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynTimeoutColor : " + line);

		    switch ( key) {
		    case Dyn.eSave_TimeoutColor: 
			break;
		    case Dyn.eSave_TimeoutColor_time: 
			time = Double.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_TimeoutColor_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynTimeoutColor");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynTimeoutColor");
	    }
	}

    }

    public class DynHostObject extends DynElem {
	String hostobject;

	public DynHostObject( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_HostObject, 0, 0, 0, Dyn.eDynPrio_HostObject);
	}

	public DynHostObject( DynHostObject x) {
	    super(x);
	    hostobject = x.hostobject;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynHostObject : " + line);

		    switch ( key) {
		    case Dyn.eSave_HostObject: 
			break;
		    case Dyn.eSave_HostObject_object: 
			if ( token.hasMoreTokens())
			    hostobject = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynHostObject");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynHostObject");
	    }
	}

    }

    public class DynDigSound extends DynElem {
	String attribute;
	String soundobject;
	int level;
	int interval;

	public DynDigSound( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigSound, 0, 0, 0, Dyn.eDynPrio_DigSound);
	}

	public DynDigSound( DynDigSound x) {
	    super(x);
	    level = x.level;
	    interval = x.interval;
	    attribute = x.attribute;
	    soundobject = x.soundobject;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigSound : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigSound: 
			break;
		    case Dyn.eSave_DigSound_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigSound_soundobject: 
			if ( token.hasMoreTokens())
			    soundobject = token.nextToken();
			break;
		    case Dyn.eSave_DigSound_level: 
			level = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigSound_interval: 
			interval = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigSound_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigSound_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigSound");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigSound");
	    }
	}

    }

    public class DynFillLevel extends DynElem {
	String attribute;
	int color;
	int direction;
	double max_value;
	double min_value;
	String minvalue_attr;
	String maxvalue_attr;
 	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int a_typeid;
        float oldValue;
	boolean limits_found = false;
	double limit_min;
	double limit_max;
	int max_value_p;
	int min_value_p;
	PwrtRefId max_value_subid;
	PwrtRefId min_value_subid;

	public DynFillLevel( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_FillLevel, 0, 0, 0, Dyn.eDynPrio_FillLevel);
	}

	public DynFillLevel( DynFillLevel x) {
	    super(x);
	    color = x.color;
	    direction = x.direction;
	    min_value = x.min_value;
	    max_value = x.max_value;
	    attribute = x.attribute;
	    minvalue_attr = x.minvalue_attr;
	    maxvalue_attr = x.maxvalue_attr;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    color = dyn.getColor2(object, color);
	    if ( color < 0 || color >= Glow.eDrawType__)
		return 0;

	    if ( attribute == null)
		return 0;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("FillLevel: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    attrFound = true;

	    if ( (dyn.total_dyn_type1 & Dyn.mDynType1_Tone) != 0) {
		if ( color >= Glow.eDrawTone__)
		    object.setLevelFillColor(color);
		else
		    object.setLevelColorTone(color);
	    }
	    else
		object.setLevelFillColor(color);

	    GlowFillLevelLimits limits = object.getLimits();
	    if ( (limits.status & 1) != 0) {
		limits_found = true;
		limit_min = limits.min;
		limit_max = limits.max;
		direction = limits.direction;
	    }
	    object.setLevelDirection( direction);

	    min_value_p = 0;
	    pname = dyn.parseAttrName(minvalue_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    min_value_p = ret.id;
		    min_value_subid = ret.refid;
		}
	    }

	    max_value_p = 0;
	    pname = dyn.parseAttrName(maxvalue_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 && database == GraphIfc.eDatabase_Gdh) {
		
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		if ( ret != null && ret.oddSts()) {
		    max_value_p = ret.id;
		    max_value_subid = ret.refid;
		}
	    }

	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	    if ( min_value_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(min_value_subid);
	    if ( max_value_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(max_value_subid);
	}

	public void scan(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
  
	    float minval, maxval;
	    float pvalue = dyn.graph.getGdh().getObjectRefInfoFloat( p);
	    if ( max_value_p != 0 && min_value_p != 0) {
		minval = dyn.graph.getGdh().getObjectRefInfoFloat( min_value_p);
		maxval = dyn.graph.getGdh().getObjectRefInfoFloat( max_value_p);
		if ( minval != min_value ||
		     maxval != max_value) {
		    min_value = minval;
		    max_value = maxval;
		    firstScan = true;
		}
	    }

	    if ( !firstScan) {
		if ( Math.abs( oldValue - pvalue) < Float.MIN_VALUE)
		    // No change since last time
		    return;
	    }
	    else
		firstScan = false;

	    if ( max_value == min_value)
		return;

	    double value = 0;
	    if ( !limits_found)
		value = (pvalue - min_value) / (max_value - min_value);
	    else {
		GlowGeometry geom = object.measure();
    
		switch ( direction) {
		case Glow.eDirection_Right:
		    value = ((pvalue - min_value) / (max_value - min_value) * ( limit_max - limit_min) 
			     + (limit_min - geom.ll_x)) / (geom.ur_x - geom.ll_x);
		    break;
		case Glow.eDirection_Left:
		    value = ((pvalue - min_value) / (max_value - min_value) * ( limit_max - limit_min) 
			     + (geom.ur_x - limit_max)) / (geom.ur_x - geom.ll_x);
		    break;
		case Glow.eDirection_Up:
		    value = ((pvalue - min_value) / (max_value - min_value) * ( limit_max - limit_min) 
			     + (limit_min - geom.ll_y)) / (geom.ur_y - geom.ll_y);
		    break;
		case Glow.eDirection_Down:
		    value = ((pvalue - min_value) / (max_value - min_value) * ( limit_max - limit_min) 
			     + (geom.ur_y - limit_max)) / (geom.ur_y - geom.ll_y);
		    break;
		default: ;
		}
	    }
	    object.setFillLevel( value);
	    oldValue = pvalue;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynFillLevel : " + line);

		    switch ( key) {
		    case Dyn.eSave_FillLevel: 
			break;
		    case Dyn.eSave_FillLevel_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_FillLevel_color: 
			color = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_FillLevel_direction: 
			direction = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_FillLevel_min_value: 
			min_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_FillLevel_max_value: 
			max_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_FillLevel_minvalue_attr: 
			if ( token.hasMoreTokens())
			    minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_FillLevel_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynFillLevel");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynFillLevel");
	    }
	}

    }

    public class DynDigCommand extends DynElem {
	String attribute;
	String command;
	int level;
  	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	boolean oldValue;

	public DynDigCommand( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_DigCommand, 0, 0, 0, Dyn.eDynPrio_DigCommand);
	}

	public DynDigCommand( DynDigCommand x) {
	    super(x);
	    attribute = x.attribute;
	    command = x.command;
	    level = x.level;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigCommand: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;

	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( firstScan) {
		firstScan = false;
		oldValue = value;
		return;
	    }

	    if ( (level == 0 && value && !oldValue) ||
		 (level != 0 && value)) {
		String cmd = graph.getCommand(command);

		dyn.graph.command(cmd);
	    }
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigCommand : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigCommand: 
			break;
		    case Dyn.eSave_DigCommand_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigCommand_command: 
			if ( token.hasMoreTokens())
			    command = line.substring(5);
			break;
		    case Dyn.eSave_DigCommand_level: 
			level = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigCommand_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigCommand_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigCommand");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigCommand");
	    }
	}

    }

    public class DynDigScript extends DynElem {
	String attribute;
	String script;
	int script_len;
	int level;
  	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	boolean oldValue;

	public DynDigScript( Dyn dyn) {
	    super(dyn, 0, Dyn.mDynType2_DigScript, 0, 0, Dyn.eDynPrio_DigScript);
	}

	public DynDigScript( DynDigScript x) {
	    super(x);
	    attribute = x.attribute;
	    script_len = x.script_len;
	    script = x.script;
	    level = x.level;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigScript: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;

	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);

	    if ( inverted)
		value = !value;

	    if ( firstScan) {
		firstScan = false;
		oldValue = value;
		return;
	    }

	    if ( (level == 0 && value && !oldValue) ||
		 (level != 0 && value)) {

		if ( script == null)
		    return;

		dyn.graph.script(script);
	    }	
	    oldValue = value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynDigScript : " + line);

		    switch ( key) {
		    case Dyn.eSave_DigScript: 
			break;
		    case Dyn.eSave_DigScript_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_DigScript_script_len: 
			script_len = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_DigScript_script: 
			int idx;
			boolean end = false;
			script = "";
			line = reader.readLine().trim().substring(1);

			idx = 0;
			while ( line != null) {			    
			    System.out.println("Script line: " + line);
			    while ( (idx = line.indexOf('"', idx)) != -1) {
				if ( idx > 0 && (line.charAt(idx-1) == '\\')) {
				    line = new StringBuffer(line).delete(idx-1,idx).toString();
				    System.out.println("Modif  line: " + line);
				}
				else {				
				    if ( idx > 0)
					line = line.substring( 0, idx - 1);
				    else
					line = "";
				    script += line;
				    end = true;
				    break;
				}
			    }
			    if ( end)
				break;
			    script += line + "\n";
			    line = reader.readLine();
			}			
			break;
		    case Dyn.eSave_DigScript_level: 
			level = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynDigScript");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynDigScript");
	    }
	}

    }

    public class DynRefUpdate extends DynElem {
	String attribute;
	int whole_graph;

	int p[] = new int[2];
  	PwrtRefId subid[] = new PwrtRefId[2];
	int idx_p[] = new int[2];
  	PwrtRefId idx_subid[] = new PwrtRefId[2];
	int ref_size[] = new int[2];
	int ref_tid[] = new int[2];
	int ref_cnt;
	int idx_ref_size[] = new int[2];
	int idx_ref_tid[] = new int[2];
	int idx_ref_cnt;
	String old_value[] = new String[2];
	int idx_old_value[] = new int[2];
	int status;
	boolean firstScan;
	boolean attrFound[] = new boolean[] {false,false};
	boolean idxAttrFound[] = new boolean[] {false,false};

	public DynRefUpdate( Dyn dyn) {
	    super(dyn, 0, Dyn.mDynType2_RefUpdate, 0, 0, Dyn.eDynPrio_RefUpdate);
	}

	public DynRefUpdate( DynRefUpdate x) {
	    super(x);
	    attribute = x.attribute;
	    whole_graph = x.whole_graph;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    String ref_name[] = new String[2];
	    String idx_ref_name[] = new String[2];

	    attrFound[0] = false;
	    attrFound[1] = false;
	    idxAttrFound[0] = false;
	    idxAttrFound[1] = false;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute, GraphIfc.mParseOpt_KeepIndex);
	    if ( pname == null || pname.name.equals("")) 
		return 1;


	    int cnt[] = new int[2];
	    dyn.graph.getRefUpdate( pname.name, ref_name, ref_tid, ref_size, 
				    idx_ref_name, idx_ref_tid, idx_ref_size, cnt, dyn);
	    ref_cnt = cnt[0];
	    idx_ref_cnt = cnt[1];

	    for ( int i = 0; i < ref_cnt; i++) {
		GdhrRefObjectInfo ret = null;
		ret = dyn.graph.getGdh().refObjectInfo( ref_name[i]);
		if ( ret != null) {
		    p[i] = ret.id;
		    subid[i] = ret.refid;
		    attrFound[i] = true;
		}
	    }

	    for ( int i = 0; i < idx_ref_cnt; i++) {
		GdhrRefObjectInfo ret = null;
		ret = dyn.graph.getGdh().refObjectInfo( idx_ref_name[i]);
		if ( ret != null) {
		    idx_p[i] = ret.id;
		    idx_subid[i] = ret.refid;
		    idxAttrFound[i] = true;
		}
	    }

	    firstScan = true;

	    return 1;
	}

 	public int connect(GlowArrayElem o, int level) {
	    GrowNode object = (GrowNode)o;
	    String ref_name[] = new String[2];
	    String idx_ref_name[] = new String[2];

	    attrFound[0] = false;
	    attrFound[1] = false;
	    idxAttrFound[0] = false;
	    idxAttrFound[1] = false;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute, GraphIfc.mParseOpt_KeepIndex);
	    if ( pname == null || pname.name.equals("")) 
		return 1;


	    int cnt[] = new int[2];
	    dyn.graph.getRefUpdate( pname.name, ref_name, ref_tid, ref_size, 
				    idx_ref_name, idx_ref_tid, idx_ref_size, cnt, dyn);
	    ref_cnt = cnt[0];
	    idx_ref_cnt = cnt[1];

	    for ( int i = level; i < ref_cnt; i++) {
		GdhrRefObjectInfo ret = null;
		ret = dyn.graph.getGdh().refObjectInfo( ref_name[i]);
		if ( ret != null) {
		    p[i] = ret.id;
		    subid[i] = ret.refid;
		    attrFound[i] = true;
		}
	    }

	    for ( int i = 0; i < idx_ref_cnt; i++) {
		GdhrRefObjectInfo ret = null;
		ret = dyn.graph.getGdh().refObjectInfo( idx_ref_name[i]);
		if ( ret != null) {
		    idx_p[i] = ret.id;
		    idx_subid[i] = ret.refid;
		    idxAttrFound[i] = true;
		}
	    }

	    // firstScan = true;

	    return 1;
	}

	public void disconnect() {
	    for ( int i = 0; i < ref_cnt; i++) {
		if ( attrFound[i])
		    dyn.graph.getGdh().unrefObjectInfo(subid[i]);
	    }
	    for ( int i = 0; i < idx_ref_cnt; i++) {
		if ( idxAttrFound[i])
		    dyn.graph.getGdh().unrefObjectInfo(idx_subid[i]);
	    }
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    boolean update = false;
	    int level = 0;
	    String[] val = new String[2];
	    int[] idx_val = new int[2];

	    for ( int i = 0; i < idx_ref_cnt; i++) {
		if ( !idxAttrFound[i]) {
		    if ( firstScan  && i == idx_ref_cnt - 1 && ref_cnt == 0) 
			firstScan = false;
		    continue;
		}

		idx_val[i] = dyn.graph.getGdh().getObjectRefInfoInt(idx_p[i]);
		if ( firstScan) {
		    idx_old_value[i] = idx_val[i];
		    if ( i == idx_ref_cnt - 1 && ref_cnt == 0)
			firstScan = false;
		    continue;
		}
    

		if ( idx_val[i] != idx_old_value[i])
		     update = true;
	    }
	    for ( int i = 0; i < ref_cnt; i++) {
		if ( !attrFound[i]) {
		    if ( firstScan  && i == ref_cnt - 1) 
			firstScan = false;
		    continue;
		}
		
		val[i] = dyn.graph.getGdh().getObjectRefInfoString(p[i], ref_tid[i]);
		if ( firstScan) {
		    old_value[i] = val[i];
		    if ( i == ref_cnt - 1)
			firstScan = false;
		    continue;
		}
		
		if ( !val[i].equals( old_value[i])) {
		    update = true;
		    level = i;
		}
	    }

	    if ( update) {

		for ( int i = 0; i < ref_cnt; i++)
		    old_value[i] = val[i];
		for ( int i = 0; i < idx_ref_cnt; i++)
		    idx_old_value[i] = idx_val[i];

		if ( whole_graph != 0) {
		    // Todo
		    // dyn.graph.swap();
		    // return GLOW__SWAPTERMINATED;
		    return;
		}

		for ( int j = 0; j < dyn.elements.size(); j++) {
		    if ( dyn.elements.get(j) == this)
			continue;

		    dyn.elements.get(j).disconnect();
		    dyn.elements.get(j).connect( o);
		}
		if ( idx_ref_cnt > 0 || level < ref_cnt - 1) {
		    disconnect();
		    connect( o, level);
		    
		    for ( int i = 0; i < ref_cnt; i++)
			old_value[i] = val[i];
		    for ( int i = 0; i < idx_ref_cnt; i++)
			idx_old_value[i] = idx_val[i];
		}
	    }

	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynRefUpdate : " + line);

		    switch ( key) {
		    case Dyn.eSave_RefUpdate: 
			break;
		    case Dyn.eSave_RefUpdate_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_RefUpdate_whole_graph:
			whole_graph = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynRefUpdate");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynRefUpdate");
	    }
	}

    }

    public class DynPopupMenu extends DynElem {
	String ref_object;

	public DynPopupMenu( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_PopupMenu, 0, Dyn.eDynPrio_PopupMenu);
	}

	public DynPopupMenu( DynPopupMenu x) {
	    super(x);
	    ref_object = x.ref_object;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB3Press:
		dyn.graph.openPopupMenu( ref_object, e.x, e.y);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynPopupMenu : " + line);

		    switch ( key) {
		    case Dyn.eSave_PopupMenu: 
			break;
		    case Dyn.eSave_PopupMenu_ref_object: 
			if ( token.hasMoreTokens())
			    ref_object = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynPopupMenu");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynPopupMenu");
	    }
	}

    }

    public class DynSetDig extends DynElem {
	String attribute;

	public DynSetDig( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_SetDig, 0, Dyn.eDynPrio_SetDig);
	}

	public DynSetDig( DynSetDig x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		if ( pname == null)
		    return 1;
		PwrtStatus sts = null;
		switch (pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = dyn.graph.getGdh().setObjectInfo( pname.name, true);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, true);
		    break;
		}
		if ( sts.evenSts())
		    System.out.println( "SetDig: " + pname.name);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynSetDig : " + line);

		    switch ( key) {
		    case Dyn.eSave_SetDig: 
			break;
		    case Dyn.eSave_SetDig_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_SetDig_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_SetDig_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynSetDig");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynSetDig");
	    }
	}

    }

    public class DynResetDig extends DynElem {
	String attribute;

	public DynResetDig( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_ResetDig, 0, Dyn.eDynPrio_ResetDig);
	}

	public DynResetDig( DynResetDig x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		if ( pname == null)
		    return 1;
		PwrtStatus sts = null;
		switch (pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = dyn.graph.getGdh().setObjectInfo( pname.name, false);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, false);
		    break;
		}
		if ( sts.evenSts())
		    System.out.println( "ResetDig: " + pname.name);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynResetDig : " + line);

		    switch ( key) {
		    case Dyn.eSave_ResetDig: 
			break;
		    case Dyn.eSave_ResetDig_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_ResetDig_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_ResetDig_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynResetDig");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynResetDig");
	    }
	}

    }

    public class DynToggleDig extends DynElem {
	String attribute;

	public DynToggleDig( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_ToggleDig, 0, Dyn.eDynPrio_ToggleDig);
	}

	public DynToggleDig( DynToggleDig x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		dyn.graph.setClickActive(1);
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		dyn.graph.setClickActive( 0);
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		if ( pname == null)
		    return 1;
		PwrtStatus sts = null;
		switch (pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = dyn.graph.getGdh().toggleObjectInfo( pname.name);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = dyn.graph.getLdb().toggleObjectInfo( graph, pname.name);
		    break;
		}
		if ( sts.evenSts())
		    System.out.println( "ToggleDig: " + pname.name);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynToggleDig : " + line);

		    switch ( key) {
		    case Dyn.eSave_ToggleDig: 
			break;
		    case Dyn.eSave_ToggleDig_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynToggleDig");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynToggleDig");
	    }
	}

    }

    public class DynStoDig extends DynElem {
	String attribute;

	public DynStoDig( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_StoDig, 0, Dyn.eDynPrio_StoDig);
	}

	public DynStoDig( DynStoDig x) {
	    super(x);
	    attribute = x.attribute;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down: {
		object.setColorInverse( 1);
		dyn.repaintNow = true;

		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		PwrtStatus sts = null;
		switch (pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = dyn.graph.getGdh().setObjectInfo( pname.name, true);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, true);
		    break;
		}
		if ( sts.evenSts())
		    System.out.println( "StoDig: " + pname.name);
		break;
	    }
	    case Glow.eEvent_MB1Up: {
		object.setColorInverse( 0);
		dyn.repaintNow = true;

		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		PwrtStatus sts = null;
		switch (pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    sts = dyn.graph.getGdh().setObjectInfo( pname.name, false);
		    break;
		case GraphIfc.eDatabase_Local:
		    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, false);
		    break;
		}
		if ( sts.evenSts())
		    System.out.println( "StoDig: " + pname.name);
		break;
	    }
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynStoDig : " + line);

		    switch ( key) {
		    case Dyn.eSave_StoDig: 
			break;
		    case Dyn.eSave_StoDig_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynStoDig");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynStoDig");
	    }
	}

    }

    public class DynCommand extends DynElem {
	String command;

	public DynCommand( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_Command, 0, Dyn.eDynPrio_Command);
	}

	public DynCommand( DynCommand x) {
	    super(x);
	    command = x.command;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		if ( command == null)
		    return 1;

		String cmd = graph.getCommand(command);

		dyn.graph.command(cmd);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynCommand : " + line);

		    switch ( key) {
		    case Dyn.eSave_Command: 
			break;
		    case Dyn.eSave_Command_command: 
			if ( token.hasMoreTokens())
			    command = line.substring(5);
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynCommand");
			break;
		    }

		    if ( end_found)
			break;
		}		
	    } catch ( Exception e) {
		System.out.println( "IOException DynCommand");
	    }
	}

    }

    public class DynScript extends DynElem {
	String script;
	int script_len;

	public DynScript( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_Script, 0, Dyn.eDynPrio_Script);
	}

	public DynScript( DynScript x) {
	    super(x);
	    script_len = x.script_len;
	    script = x.script;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		if ( script == null)
		    return 1;

		// String cmd = graph.getCommand(command);

		dyn.graph.script(script);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynScript : " + line);

		    switch ( key) {
		    case Dyn.eSave_Script: 
			break;
		    case Dyn.eSave_Script_script_len: 
			script_len = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Script_script: 
			int idx;
			boolean end = false;
			script = "";
			line = reader.readLine().trim().substring(1);

			idx = 0;
			while ( line != null) {			    
			    System.out.println("Script line: " + line);
			    while ( (idx = line.indexOf('"', idx)) != -1) {
				if ( idx > 0 && (line.charAt(idx-1) == '\\')) {
				    line = new StringBuffer(line).delete(idx-1,idx).toString();
				    System.out.println("Modif  line: " + line);
				}
				else {				
				    if ( idx > 0)
					line = line.substring( 0, idx - 1);
				    else
					line = "";
				    script += line;
				    end = true;
				    break;
				}
			    }
			    if ( end)
				break;
			    script += line + "\n";
			    line = reader.readLine();
			}			
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynScript");
			break;
		    }

		    if ( end_found)
			break;
		}		
	    } catch ( Exception e) {
		System.out.println( "IOException DynScript");
	    }
	    System.out.println( "script : \"" + script + "\"");
	}

    }

    public class DynCommandDoubleClick extends DynElem {
	String command;

	public DynCommandDoubleClick( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_CommandDoubleClick, 0, Dyn.eDynPrio_CommandDoubleClick);
	}

	public DynCommandDoubleClick( DynCommandDoubleClick x) {
	    super(x);
	    command = x.command;
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1DoubleClick:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		String cmd = graph.getCommand(command);

		dyn.graph.command(cmd);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynCommandDoubleClick : " + line);

		    switch ( key) {
		    case Dyn.eSave_CommandDC: 
			break;
		    case Dyn.eSave_CommandDC_command: 
			if ( token.hasMoreTokens())
			    command = line.substring(5);
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynCommandDoubleClick");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynCommandDoubleClick");
	    }
	}

    }

    public class DynConfirm extends DynElem {
	String text;
	int on_set;
	int on_reset;

	public DynConfirm( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_Confirm, 0, Dyn.eDynPrio_Confirm);
	}

	public DynConfirm( DynConfirm x) {
	    super(x);
	    text = x.text;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;
	    if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) == 0)
		return 1;

	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		break;
	    case Glow.eEvent_MB1Click:
	    case Glow.eEvent_ValueChanged:

		int skip = 0;
		if ( ((on_set != 0 && on_reset == 0) || (on_reset != 0 && on_set == 0)) &&
		     (dyn.total_action_type1 & Dyn.mActionType1_ToggleDig) != 0) {
		    for ( int j = 0; j < dyn.elements.size(); j++) {
			if ( dyn.elements.get(j).action_type1 == Dyn.mActionType1_ToggleDig) {
			    DynParsedAttrName pname = dyn.parseAttrName( ((DynToggleDig)dyn.elements.get(j)).attribute);
			    if ( pname.name.startsWith("&"))
				pname.name = dyn.graph.get_reference_name( pname.name);

			    switch ( pname.database) {
			    case GraphIfc.eDatabase_Gdh:
				CdhrBoolean ret = dyn.graph.getGdh().getObjectInfoBoolean( pname.name);
				if (ret.oddSts()) {
				    if ( (on_set != 0 && ret.value) || (on_reset != 0 && !ret.value))
					skip = 1;
				}
				else
				    System.out.println("Confirm: " + ret.getSts());
				break;
			    case GraphIfc.eDatabase_Ccm:
				// TODO
				break;
			    default: ;
			    }
			    break;
			}
		    }
		}
		if ( skip != 0) {
		    dyn.confirmedAction(  e.event, o);
		    return 1;
		}

		dyn.graph.openConfirmDialog( dyn, text, object);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynConfirm : " + line);

		    switch ( key) {
		    case Dyn.eSave_Confirm: 
			break;
		    case Dyn.eSave_Confirm_text: 
			if ( token.hasMoreTokens())
			    text = line.substring(5);
			break;
		    case Dyn.eSave_Confirm_on_set: 
			on_set = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_Confirm_on_reset: 
			on_reset = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynConfirm");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynConfirm");
	    }
	}

    }

    public class DynIncrAnalog extends DynElem {
	String attribute;
	double increment;
	double min_value;
	double max_value;

	public DynIncrAnalog( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_IncrAnalog, 0, Dyn.eDynPrio_IncrAnalog);
	}

	public DynIncrAnalog( DynIncrAnalog x) {
	    super(x);
	    attribute = x.attribute;
	    increment = x.increment;
	    min_value = x.min_value;
	    max_value = x.max_value;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;

	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;

		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		if ( pname == null)
		    return 1;
		int typeId = pname.type;
		if ( pname.type < 0)
		    typeId = Pwr.eType_Float32;
		switch ( typeId) {
		case Pwr.eType_Int32: {
		    CdhrInt ret = dyn.graph.getGdh().getObjectInfoInt( pname.name);
		    if ( ret.evenSts()) {
			System.out.println( "IncrAnalog " + pname.name);
			break;
		    }
		    ret.value += (int)increment;
		    if ( !( min_value == 0 && max_value == 0)) {
			if ( ret.value < (int)min_value)
			    ret.value = (int) min_value;
			if ( ret.value > (int)max_value)
			    ret.value = (int) max_value;
		    }
		    PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( pname.name, ret.value);
		    if ( sts.evenSts())
			System.out.println( "IncrAnalog " + pname.name);
		    break;
		}
		default: {
		    CdhrFloat ret = dyn.graph.getGdh().getObjectInfoFloat( pname.name);
		    if ( ret.evenSts()) {
			System.out.println( "IncrAnalog " + pname.name);
			break;
		    }
		    ret.value += increment;
		    if ( !( min_value == 0 && max_value == 0)) {
			if ( ret.value < min_value)
			    ret.value = (float) min_value;
			if ( ret.value > max_value)
			    ret.value = (float) max_value;
		    }
		    PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( pname.name, ret.value);
		    if ( sts.evenSts())
			System.out.println( "IncrAnalog " + pname.name);
		}
		}
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynIncrAnalog : " + line);

		    switch ( key) {
		    case Dyn.eSave_IncrAnalog: 
			break;
		    case Dyn.eSave_IncrAnalog_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_IncrAnalog_increment: 
			increment = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_IncrAnalog_min_value: 
			min_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_IncrAnalog_max_value: 
			max_value = new Double(token.nextToken()).doubleValue();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynIncrAnalog");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynIncrAnalog");
	    }
	}

    }

    public class DynRadioButton extends DynElem {
	String attribute;
  	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	boolean oldValue;

	public DynRadioButton( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_RadioButton, 0, Dyn.eDynPrio_RadioButton);
	}

	public DynRadioButton( DynRadioButton x) {
	    super(x);
	    attribute = x.attribute;
	}

 	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Ccm:
		// TODO
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("DigLowColor: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    boolean value = dyn.getDig(p, a_typeid, bitmask, database);
	    if ( inverted)
		value = !value;

	    if ( !firstScan) {
		if ( oldValue == value)
		    return;
	    }
	    else
		firstScan = false;
	
	    if ( value) {
		object.set_last_nodeclass();
	    }
	    else {
		object.set_root_nodeclass();
	    }
	    oldValue = value;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;

	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click: {
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;

		boolean value;
		GrowGroup group = (GrowGroup)dyn.graph.getCtx().get_object_group(object);
		if ( group == null) break;

		Vector<GlowArrayElem> list = group.get_object_list();

		for ( int i = 0; i < list.size(); i++) {
		    GlowArrayElem oe = list.get(i);
		    if ( oe != e.object &&
			 oe.type() == Glow.eObjectType_GrowNode) {
			value = false;

			Dyn gm_dyn = (Dyn)((GrowNode)oe).getUserData();

			if ( (gm_dyn.total_action_type1 & Dyn.mActionType1_RadioButton) != 0) {
 			    for ( int j = 0; j < gm_dyn.elements.size(); j++) {
				if ( gm_dyn.elements.get(j).action_type1 == Dyn.mActionType1_RadioButton) {
				    DynParsedAttrName pname = dyn.parseAttrName(((DynRadioButton)gm_dyn.elements.get(j)).attribute);
				    if ( pname.name.startsWith("&"))
					pname.name = dyn.graph.get_reference_name( pname.name);

				    switch ( pname.database) {
				    case GraphIfc.eDatabase_Gdh:
					PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( pname.name, value);
					System.out.println("setObjectInfo: " + sts.getSts());
					break;
				    case GraphIfc.eDatabase_Ccm:
					// TODO
					break;
				    default: ;
				    }
				}
			    }
			}
		    }
		}
		
		DynParsedAttrName pname = dyn.parseAttrName(attribute);
		if ( pname.name.startsWith("&"))
		    pname.name = dyn.graph.get_reference_name( pname.name);

		value = true;
		switch ( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( pname.name, value);
		    break;
		case GraphIfc.eDatabase_Ccm:
		    // TODO
		    break;
		default: ;
		}
		break;
	    }
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynRadioButton : " + line);

		    switch ( key) {
		    case Dyn.eSave_RadioButton: 
			break;
		    case Dyn.eSave_RadioButton_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynRadioButton");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynRadioButton");
	    }
	}

    }

    public class DynTipText extends DynElem {
	String text;

	public DynTipText( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_TipText, 0, Dyn.eDynPrio_TipText);
	}

	public DynTipText( DynTipText x) {
	    super(x);
	    text = x.text;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynTipText : " + line);

		    switch ( key) {
		    case Dyn.eSave_TipText: 
			break;
		    case Dyn.eSave_TipText_text: 
			if ( token.hasMoreTokens())
			    text = line.substring(5);
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynTipText");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynTipText");
	    }
	}

    }

    public class DynHelp extends DynElem {
	String topic;
	String bookmark;

	public DynHelp( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_Help, 0, Dyn.eDynPrio_Help);
	}

	public DynHelp( DynHelp x) {
	    super(x);
	    topic = x.topic;
	    bookmark = x.bookmark;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( topic == null)
		return 1;

	    GrowNode object = (GrowNode)o;
	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		String command;
		if ( bookmark != null && !bookmark.equals(""))
		    command = new String("help " + topic + " /bookmark=" + bookmark);
		else
		    command = new String("help " + topic);

		dyn.graph.command(command);
		break;
	    }
	    return 1;
	}


	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynHelp : " + line);

		    switch ( key) {
		    case Dyn.eSave_Help: 
			break;
		    case Dyn.eSave_Help_topic: 
			if ( token.hasMoreTokens())
			    topic = token.nextToken();
			break;
		    case Dyn.eSave_Help_bookmark: 
			if ( token.hasMoreTokens())
			    bookmark = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynHelp");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynHelp");
	    }
	}

    }

    public class DynOpenGraph extends DynElem {
	String graph_object;

	public DynOpenGraph( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_OpenGraph, 0, Dyn.eDynPrio_OpenGraph);
	}

	public DynOpenGraph( DynOpenGraph x) {
	    super(x);
	    graph_object = x.graph_object;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		o.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		o.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		String command = null;
		if ( !(graph_object == null || graph_object.equals("")))
		    command = new String("open graph/object=" + graph_object);
		else {
		    // Open classgraph for popup menu object
		    if ( (dyn.total_action_type1 & Dyn.mActionType1_PopupMenu) != 0) {
			for ( int i = 0; i < dyn.elements.size(); i++) {
			    if ( dyn.elements.get(i).action_type1 == Dyn.mActionType1_PopupMenu) {
				command = new String("open graph/class/instance=" + ((DynPopupMenu)dyn.elements.get(i)).ref_object);
				break;
			    }
			}
		    }
		    else if ( (dyn.total_dyn_type1 & Dyn.mDynType1_HostObject) != 0) {
			for ( int i = 0; i < dyn.elements.size(); i++) {
			    if ( dyn.elements.get(i).dyn_type1 == Dyn.mDynType1_HostObject) {
				command = new String("open graph/class/instance=" + ((DynHostObject)dyn.elements.get(i)).hostobject);
				break;
			    }
			}
		    }
		}

		dyn.graph.command(command);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynOpenGraph : " + line);

		    switch ( key) {
		    case Dyn.eSave_OpenGraph: 
			break;
		    case Dyn.eSave_OpenGraph_graph_object: 
			if ( token.hasMoreTokens())
			    graph_object = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynOpenGraph");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynOpenGraph");
	    }
	}

    }

    public class DynOpenURL extends DynElem {
	String url;

	public DynOpenURL( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_OpenURL, 0, Dyn.eDynPrio_OpenURL);
	}

	public DynOpenURL( DynOpenURL x) {
	    super(x);
	    url = x.url;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    GrowNode object = (GrowNode)o;
	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;
		
		String command = new String("open url \"" + url + "\"");

		dyn.graph.command(command);
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynOpenURL : " + line);

		    switch ( key) {
		    case Dyn.eSave_OpenURL: 
			break;
		    case Dyn.eSave_OpenURL_url: 
			if ( token.hasMoreTokens())
			    url = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynOpenURL");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynOpenURL");
	    }
	}

    }

    public class DynInputFocus extends DynElem {
	int initial_focus;
	String next_horizontal;
	String next_vertical;
	String next_tab;

	public DynInputFocus( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_InputFocus, 0, Dyn.eDynPrio_InputFocus);
	}

	public DynInputFocus( DynInputFocus x) {
	    super(x);
	    initial_focus = x.initial_focus;
	    next_horizontal = x.next_horizontal;
	    next_vertical = x.next_vertical;
	    next_tab = x.next_tab;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynInputFocus : " + line);

		    switch ( key) {
		    case Dyn.eSave_InputFocus: 
			break;
		    case Dyn.eSave_InputFocus_initial_focus: 
			initial_focus = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_InputFocus_next_horizontal: 
			if ( token.hasMoreTokens())
			    next_horizontal = token.nextToken();
			break;
		    case Dyn.eSave_InputFocus_next_vertical: 
			if ( token.hasMoreTokens())
			    next_vertical = token.nextToken();
			break;
		    case Dyn.eSave_InputFocus_next_tab: 
			if ( token.hasMoreTokens())
			    next_tab = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynInputFocus");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynInputFocus");
	    }
	}

    }

    public class DynCloseGraph extends DynElem {

	public DynCloseGraph( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_CloseGraph, 0, Dyn.eDynPrio_CloseGraph);
	}

	public DynCloseGraph( DynCloseGraph x) {
	    super(x);
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;

		dyn.graph.closeGraph();
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynCloseGraph : " + line);

		    switch ( key) {
		    case Dyn.eSave_CloseGraph: 
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynCloseGraph");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynCloseGraph");
	    }
	}

    }


    public class DynSlider extends DynElem {
	String attribute;
	String minvalue_attr;
	String maxvalue_attr;
	String insensitive_attr;
	String release_attr;
	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	float old_value;
	int old_ivalue;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
	int max_value_p;
	PwrtRefId max_value_subid;
	int min_value_p;
	PwrtRefId min_value_subid;
	int insensitive_p;
	PwrtRefId insensitive_subid;
	int insensitive_db;
	boolean insensitive_inverted;
	float min_value;
	float max_value;
	float old_min_value;
	float old_max_value;
	boolean slider_disabled = true;
	int direction;

	public DynSlider( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_Slider, 0, Dyn.eDynPrio_Slider);
	}

	public DynSlider( DynSlider x) {
	    super(x);
	    attribute = x.attribute;
	    minvalue_attr = x.minvalue_attr;
	    maxvalue_attr = x.maxvalue_attr;
	    insensitive_attr = x.insensitive_attr;
	    release_attr = x.release_attr;
	}

	public int connect(GlowArrayElem o) {
	    GrowSlider object = (GrowSlider)o;
	    System.out.println("Slider connect");
	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("Slider: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;

	    // Get min and max position from slider background
	    double max_value, min_value, max_pos, min_pos;
	    Object background;
	    double origo;

	    if ( !object.transformIsStored()) {
		object.storeTransform();
		GlowGeometry g = object.measure();
		System.out.println("Slider measure: (" + g.ll_x + "," + g.ll_y + ") (" +  g.ur_x + "," + g.ur_y + ")");
		GlowSliderInfo info = object.get_info();
		GlowBackgroundObject b = dyn.graph.getCtx().getBackgroundObjectLimits(Dyn.mDynType1_SliderBackground,
								 (g.ll_x + g.ur_x) / 2, (g.ll_y + g.ur_y) / 2);
		System.out.println("Slider background sts: " + b.sts + " direction " + b.direction);
		if ( (b.sts & 1) != 0) {
		    direction = b.direction;
		    origo = object.get_origo(info.direction);

		    switch( direction) {
		    case Glow.eDirection_Down:
			info.max_position = b.max - origo;
			info.min_position = b.min - origo;
			object.set_info(info);

			object.move_to(g.ll_x, info.min_position);
			break;
		    case Glow.eDirection_Up:
			info.max_position = b.max - (g.ur_y - g.ll_y - origo);
			info.min_position = b.min - (g.ur_y - g.ll_y - origo);
			object.set_info(info);
			object.move_to(g.ll_x, info.min_position);
			break;
		    case Glow.eDirection_Left:
			info.max_position = b.max - (g.ur_x - g.ll_x - origo);
			info.min_position = b.min - (g.ur_x - g.ll_x - origo);
			object.set_info(info);
			object.move_to(info.min_position, g.ll_y);
			break;
		    case Glow.eDirection_Right:
			info.max_position = b.max - origo;
			info.min_position = b.min - origo;
			object.set_info(info);
			object.move_to(info.min_position, g.ll_y);
			break;
		    default:
			;
		    }
		}
		else
		    direction = info.direction;

		object.storeTransform();
	    }
	    
	    max_value_p = 0;
	    pname = dyn.parseAttrName(maxvalue_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 ) {
		ret = null;
		
		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}
		if ( ret != null) {
		    max_value_p = ret.id;
		    max_value_subid = ret.refid;		    
		}
	    }

	    min_value_p = 0;
	    pname = dyn.parseAttrName(minvalue_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Float32 ) {
		ret = null;

		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		default:
		    ret = null;
		}
		if ( ret != null) {
		    min_value_p = ret.id;
		    min_value_subid = ret.refid;
		}
	    }

	    insensitive_p = 0;
	    pname = dyn.parseAttrName(insensitive_attr);
	    if ( pname != null && !pname.name.equals("") && pname.type == Pwr.eType_Boolean) {
		System.out.println("Slider insensitive " + pname.name + " type : " + pname.type);
		ret = null;
		
		switch( pname.database) {
		case GraphIfc.eDatabase_Gdh:
		    ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		    break;
		case GraphIfc.eDatabase_Local:
		    ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		    System.out.println("Slider insensitive " + pname.name + " ret : " + ret);
		    break;
		default:
		    ret = null;
		}
		if ( ret != null) {
		    insensitive_p = ret.id;
		    insensitive_subid = ret.refid;
		    insensitive_inverted = pname.inverted;
		    insensitive_db = pname.database;
		}
	    }
	    System.out.println("Slider connect end");
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	    if ( min_value_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(min_value_subid);
	    if ( max_value_p != 0)
		dyn.graph.getGdh().unrefObjectInfo(max_value_subid);
	    if ( insensitive_p != 0 && insensitive_db == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(insensitive_subid);
	}
	
	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;
	    
	    float value = 0;
	    int ivalue = 0;

	    switch ( a_typeid) {
	    case Pwr.eType_Float32:
		value = dyn.graph.getGdh().getObjectRefInfoFloat( p);
		break;
	    case Pwr.eType_Int32:
		ivalue = dyn.graph.getGdh().getObjectRefInfoInt( p);
		break;
	    case Pwr.eType_Boolean: {
		boolean b;
		b = dyn.graph.getGdh().getObjectRefInfoBoolean( p);
		ivalue = b ? 1 : 0;
		break;
	    }
	    }

	    if ( insensitive_p != 0) {
		switch ( insensitive_db) {
		case GraphIfc.eDatabase_Gdh:
		    slider_disabled = dyn.graph.getGdh().getObjectRefInfoBoolean( insensitive_p);
		    break;
		case GraphIfc.eDatabase_Local:
		    slider_disabled = dyn.graph.getLdb().getObjectRefInfoBoolean( insensitive_p);
		    break;
		}
		if ( insensitive_inverted)
		    slider_disabled = !slider_disabled;
	    }
	    else
		slider_disabled = false;
	    
	    if ( max_value_p != 0 && min_value_p != 0) {
		max_value = dyn.graph.getGdh().getObjectRefInfoFloat( max_value_p);
		min_value = dyn.graph.getGdh().getObjectRefInfoFloat( min_value_p);
		if ( max_value != old_max_value ||
		     min_value != old_min_value) {
		    if ( Math.abs( max_value - min_value) > Double.MIN_VALUE)
			firstScan = true;
		}
		old_min_value = min_value;
		old_max_value = max_value;
	    }      
	    
	    if ( !firstScan) {
		switch ( a_typeid) {
		case Pwr.eType_Float32:
		    if ( Math.abs( old_value - value) < Double.MIN_VALUE)
			// No change since last time
			return;
		    break;
		case Pwr.eType_Int32:
		case Pwr.eType_Boolean:
		    if ( ivalue == old_ivalue)
			return;
		    break;
		default: ;
		}
	    }
	    else
		firstScan = false;

	    switch ( a_typeid) {
	    case Pwr.eType_Float32:
		old_value = value;
		break;
	    case Pwr.eType_Int32:
	    case Pwr.eType_Boolean:
		old_ivalue = ivalue;
		break;
	    default: ;
	    }

	    GlowSliderInfo info = ((GrowSlider)object).get_info();

	    if ( !(max_value_p != 0 && min_value_p != 0 && max_value != min_value)) {
		max_value = (float)info.max_value;
		min_value = (float)info.min_value;
	    }
	    if ( info.min_position != info.max_position) {
		if ( dyn.graph.getCurrentSlider() != object &&
		     max_value != min_value) {
		    double pos_x, pos_y;

		    switch ( a_typeid) {
		    case Pwr.eType_Float32:
			break;
		    default:
			value = (float) (ivalue);
			break;
		    }
          
		    switch ( direction) {
		    case Glow.eDirection_Down:
			pos_y = (max_value - value) / (max_value - min_value) *
			    (info.max_position - info.min_position);
			if ( pos_y < 0)
			    pos_y = 0;
			else if ( pos_y > info.max_position - info.min_position)
			    pos_y = info.max_position - info.min_position;
			pos_x = 0;
			break;
		    case Glow.eDirection_Right:
			pos_x = info.max_position - info.min_position - 
			    (value - min_value) / (max_value - min_value) *
			    (info.max_position - info.min_position);
			if ( pos_x < 0)
			    pos_x = 0;
			else if ( pos_x > info.max_position - info.min_position)
			    pos_x = info.max_position - info.min_position;
			pos_y = 0;
			break;
		    case Glow.eDirection_Left:
			pos_x = info.max_position - info.min_position - 
			    (max_value - value) / (max_value - min_value) *
			    (info.max_position - info.min_position);
			if ( pos_x < 0)
			    pos_x = 0;
			else if ( pos_x > info.max_position - info.min_position)
			    pos_x = info.max_position - info.min_position;
			pos_y = 0;
			break;
		    default:   // Up
			pos_y = (value - min_value) / (max_value - min_value) *
			    (info.max_position - info.min_position);
			if ( pos_y < 0)
			    pos_y = 0;
			else if ( pos_y > info.max_position - info.min_position)
			    pos_y = info.max_position - info.min_position;
			pos_x = 0;
		    }
		    object.set_position(pos_x, pos_y);
		}
	    }

	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;
	    if ( slider_disabled)
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_SliderMoveEnd: {
		DynParsedAttrName pname = dyn.parseAttrName(release_attr);
		if ( !(pname == null || pname.name.equals(""))) {
		    switch ( pname.type) {
		    case Pwr.eType_Boolean: {
			PwrtStatus sts = dyn.graph.getGdh().setObjectInfo( pname.name, 1);
			break;
		    }
		    default: ;
		    }
		}
		if ( dyn.graph.getCurrentSlider() == object)
		    dyn.graph.setCurrentSlider(null);
		break;
	    }
	    case Glow.eEvent_SliderMoveStart: {
		if ( !dyn.graph.isAuthorized( dyn.access) ||
		     slider_disabled) {
		    dyn.graph.getCtx().setMoveRestrictions(Glow.eMoveRestriction_Disable, 0, 0, null);
		    dyn.graph.setCurrentSlider(null);
		    break;
		}
		GlowSliderInfo info = ((GrowSlider)object).get_info();
		if ( direction == Glow.eDirection_Right || 
		     direction == Glow.eDirection_Left)
		    dyn.graph.getCtx().setMoveRestrictions( Glow.eMoveRestriction_HorizontalSlider,
							    info.max_position, info.min_position, (GlowArrayElem)e.object);
		else
		    dyn.graph.getCtx().setMoveRestrictions( Glow.eMoveRestriction_VerticalSlider,
							    info.max_position, info.min_position, (GlowArrayElem)e.object);

		dyn.graph.setCurrentSlider((GrowSlider)object);
		break;
	    }
	    case Glow.eEvent_SliderMoved: {
		float 		value;
    
		GlowSliderInfo info = ((GrowSlider)object).get_info();
		if ( info.min_position != info.max_position) {
		    if ( !(max_value_p != 0 && min_value_p != 0 && max_value != min_value)) {
			max_value = (float)info.max_value;
			min_value = (float)info.min_value;
		    }
		    GlowGeometry g = object.measure();
        
		    switch ( direction) {
		    case Glow.eDirection_Down:
			value = (float)( (info.max_position - g.ll_y) / (info.max_position - info.min_position) *
				       (max_value - min_value) + min_value);
			break;
		    case Glow.eDirection_Right:
			value = (float)( (info.max_position - g.ll_x) / (info.max_position - info.min_position) *
				       (max_value - min_value) + min_value);
			break;
		    case Glow.eDirection_Left:
			value = (float)( (g.ll_x - info.min_position) / (info.max_position - info.min_position) *
				       (max_value - min_value) + min_value);
			break;
		    default:
			value = (float)( (g.ll_y - info.min_position) / (info.max_position - info.min_position) *
				       (max_value - min_value) + min_value);
		    }
		    if ( value > max_value)
			value = max_value;
		    if ( value < min_value)
			value = min_value;
      
		    DynParsedAttrName pname = dyn.parseAttrName(attribute);
		    if ( pname == null || pname.name.equals("")) 
			return 1;

		    PwrtStatus sts;

		    switch ( pname.type) {
		    case Pwr.eType_Float32:
			sts = dyn.graph.getGdh().setObjectInfo( pname.name, value);
			break;
		    case Pwr.eType_Boolean: {
			boolean bvalue = (value > 0.5 ? true : false);
			sts = dyn.graph.getGdh().setObjectInfo( pname.name, bvalue);
			break;
		    }
		    default: {
			int ivalue = (int) (value > 0 ? value + 0.5 : value - 0.5);
			sts = dyn.graph.getGdh().setObjectInfo( pname.name, ivalue);
		    }
		    }
		    if ( sts.evenSts()) System.out.println("Slider error: " + attribute);
		}
		break;
	    }
	    default: ;    
	    }
	    return 1;
	}


	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynSlider : " + line);

		    switch ( key) {
		    case Dyn.eSave_Slider: 
			break;
		    case Dyn.eSave_Slider_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_Slider_minvalue_attr: 
			if ( token.hasMoreTokens())
			    minvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_Slider_maxvalue_attr: 
			if ( token.hasMoreTokens())
			    maxvalue_attr = token.nextToken();
			break;
		    case Dyn.eSave_Slider_insensitive_attr: 
			if ( token.hasMoreTokens())
			    insensitive_attr = token.nextToken();
			break;
		    case Dyn.eSave_Slider_release_attr: 
			if ( token.hasMoreTokens())
			    release_attr = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynSlider");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynSlider");
	    }
	}

    }

    public class DynFastCurve extends DynElem {
	String fast_object;
	int curve_index1;
	int curve_index2;

	public DynFastCurve( Dyn dyn) {
	    super(dyn, Dyn.mDynType1_FastCurve, 0, 0, 0, Dyn.eDynPrio_FastCurve);
	}

	public DynFastCurve( DynFastCurve x) {
	    super(x);
	    curve_index1 = x.curve_index1;
	    curve_index2 = x.curve_index2;
	    fast_object = x.fast_object;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynFastCurve : " + line);

		    switch ( key) {
		    case Dyn.eSave_FastCurve: 
			break;
		    case Dyn.eSave_FastCurve_fast_object: 
			if ( token.hasMoreTokens())
			    fast_object = token.nextToken();
			break;
		    case Dyn.eSave_FastCurve_curve_index1: 
			curve_index1 = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_FastCurve_curve_index2: 
			curve_index2 = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynFastCurve");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynFastCurve");
	    }
	}

    }

    public class DynPulldownMenu extends DynElem {
	int button_mask;
	String[] items_text = new String[32];
	Dyn[] items_dyn = new Dyn[32];
	GrowMenu menu_object;
	int text_size;

	public DynPulldownMenu( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_PulldownMenu, 0, Dyn.eDynPrio_PulldownMenu);
	}

	public DynPulldownMenu( DynPulldownMenu x) {
	    super(x);
	    button_mask = x.button_mask;
	    items_text = x.items_text;
	    for ( int i = 0; i < 32; i++) {
		items_dyn[i] = new Dyn(x.items_dyn[i]);
	    }
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    GrowNode object = (GrowNode)o;
	    switch ( e.event) {
	    case Glow.eEvent_MB1Click:
		if ( menu_object != null) {
		    // Close, delete this menu and all childmenues
		    for ( int j = 0; j < 32; j++) {
			if ( items_dyn[j]  != null &&
			     (items_dyn[j].action_type1 & Dyn.mActionType1_PulldownMenu) != 0)
			    items_dyn[j].action( null, e);
		    }
		    dyn.graph.getCtx().remove(menu_object);
		    menu_object = null;
		}
		else if ( object != null) {
		    double	ll_x, ll_y, ur_x, ur_y;
		    GlowMenuInfo info = new GlowMenuInfo();

		    int b_mask = 1;
		    for ( int i = 0; i < 32; i++) {
			if ( (b_mask & button_mask) != 0) {
			    info.item[i].occupied = true;
			    info.item[i].text = new String(items_text[i]);
			    
			    // Check access
			    if ( (items_dyn[i].action_type1 & Dyn.mActionType1_PulldownMenu) != 0)
				info.item[i].type = Glow.eMenuItem_PulldownMenu;
			    else {
				// Check access
				if ( dyn.graph.isAuthorized( items_dyn[i].access)) {
				    info.item[i].type = Glow.eMenuItem_Button;
				    if ( (items_dyn[i].dyn_type1 & Dyn.mDynType1_Invisible) != 0) {
					int		sts;
					DynInvisible 	invis_element = null;
					String 		command;

					for ( int j = 0; j < dyn.elements.size(); j++) {
					    if ( dyn.elements.get(j).dyn_type1 == Dyn.mDynType1_Invisible) {
						invis_element = (DynInvisible)dyn.elements.get(j);
					    }
					}
					if ( invis_element != null) {
					    DynParsedAttrName pname = dyn.parseAttrName(invis_element.attribute);
					    if ( (pname != null) && !pname.name.equals("")) {
						if ( pname.name.startsWith("$cmd(")) {
						    int idx = pname.name.lastIndexOf(")");
						    if ( idx != -1) {
							command = pname.name.substring(5, idx);
							command = dyn.graph.getCommand(command);
							sts = dyn.graph.command(command);
							if ( (sts & 1) == 0)
							    info.item[i].type = Glow.eMenuItem_ButtonDisabled;
						    }
						}
					    }
					    else {
						CdhrBoolean ret = dyn.graph.getGdh().getObjectInfoBoolean( pname.name);
						if (ret.oddSts()) {
						    if ( (!pname.inverted && ret.value) || (pname.inverted && !ret.value)) {
							if ( invis_element.dimmed != 0) 
							    info.item[i].type = Glow.eMenuItem_ButtonDisabled;
							else
							    info.item[i].occupied = false;
						    }		      
						}
					    }
					}
				    }
				}
				else
				    info.item[i].type = Glow.eMenuItem_ButtonDisabled;
			    }
			}
			else
			    info.item[i].occupied = false;
			b_mask = b_mask << 1;
		    }

		    // Get fillcolor, and textattributes from object
		    int text_drawtype = 0, text_color = 0, bg_color = 0;
		    int text_size = 0;
		    int sts;
		    double scale = 1;
		    int text_font = 0;
		    
		    sts = 0; // TODO sts = grow_GetObjectAnnotInfo( object, 1, &text_size, &text_drawtype, &text_color, &bg_color, &scale, &text_font);
		    if ( (sts & 1) == 0) {
			text_size = 3;
			text_drawtype = Glow.eDrawType_TextHelvetica;
			text_font = Glow.eFont_LucidaSans;
			text_color = Glow.eDrawType_Line;
			bg_color = Glow.eDrawType_LightGray;
		    }
		    else if ( bg_color == Glow.eDrawType_No || bg_color == Glow.eDrawType_Inherit)
			bg_color = Glow.eDrawType_LightGray;
		    
		    GlowGeometry g = object.measure();
		    menu_object = new GrowMenu( dyn.graph.getCtx().cmn, "__Menu", info, g.ll_x, g.ur_y, g.ur_x - g.ll_x,
						Glow.eDrawType_Line, 0, 1, 1, bg_color, text_size,
						text_drawtype, text_color,
						Glow.eDrawType_MediumGray, text_font);
		    menu_object.set_scale( scale, scale, 0, 0, Glow.eScaleType_LowerLeft);
		    System.out.println("Insert menu" + menu_object);
		    dyn.graph.getCtx().insert(menu_object);

		    // grow_SetMenuInputFocus( menu_object, 1);
		}

		break;
	    case Glow.eEvent_MenuActivated:
		if ( menu_object == null)
		    break;
		if ( e.object == menu_object) {
		    if ( items_dyn[((GlowEventMenu)e).item] != null) {
			GlowEvent event = new GlowEvent();
			event.event = Glow.eEvent_MB1Click;
			return items_dyn[((GlowEventMenu)e).item].action( (GlowArrayElem)e.object, event);
		    }
		}
		else {
		    for ( int j = 0; j < 32; j++) {
			if ( items_dyn[j] != null && 
			     (items_dyn[j].action_type1 & Dyn.mActionType1_PulldownMenu) != 0)
			    items_dyn[j].action( null, e);
		    }
		}
		break;
	    case Glow.eEvent_MenuDelete:
		if ( menu_object == null)
		    break;
		if ( e.object == null || e.object == menu_object) {
		    // Delete this menu
		    dyn.graph.getCtx().remove(menu_object);
		    menu_object = null;
		}
		break;

	    default: ;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynPulldownMenu : " + line);

		    switch ( key) {
		    case Dyn.eSave_PulldownMenu: 
			break;
		    case Dyn.eSave_PulldownMenu_button_mask: 
			button_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_PulldownMenu_items_text0: 
			if ( token.hasMoreTokens())
			    items_text[0] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text1: 
			if ( token.hasMoreTokens())
			    items_text[1] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text2: 
			if ( token.hasMoreTokens())
			    items_text[2] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text3: 
			if ( token.hasMoreTokens())
			    items_text[3] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text4: 
			if ( token.hasMoreTokens())
			    items_text[4] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text5: 
			if ( token.hasMoreTokens())
			    items_text[5] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text6: 
			if ( token.hasMoreTokens())
			    items_text[6] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text7: 
			if ( token.hasMoreTokens())
			    items_text[7] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text8: 
			if ( token.hasMoreTokens())
			    items_text[8] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text9: 
			if ( token.hasMoreTokens())
			    items_text[9] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text10: 
			if ( token.hasMoreTokens())
			    items_text[10] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text11: 
			if ( token.hasMoreTokens())
			    items_text[11] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text12: 
			if ( token.hasMoreTokens())
			    items_text[12] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text13: 
			if ( token.hasMoreTokens())
			    items_text[13] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text14: 
			if ( token.hasMoreTokens())
			    items_text[14] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text15: 
			if ( token.hasMoreTokens())
			    items_text[15] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text16: 
			if ( token.hasMoreTokens())
			    items_text[16] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text17: 
			if ( token.hasMoreTokens())
			    items_text[17] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text18: 
			if ( token.hasMoreTokens())
			    items_text[18] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text19: 
			if ( token.hasMoreTokens())
			    items_text[19] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text20: 
			if ( token.hasMoreTokens())
			    items_text[20] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text21: 
			if ( token.hasMoreTokens())
			    items_text[21] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text22: 
			if ( token.hasMoreTokens())
			    items_text[22] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text23: 
			if ( token.hasMoreTokens())
			    items_text[23] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text24: 
			if ( token.hasMoreTokens())
			    items_text[24] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text25: 
			if ( token.hasMoreTokens())
			    items_text[25] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text26: 
			if ( token.hasMoreTokens())
			    items_text[26] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text27: 
			if ( token.hasMoreTokens())
			    items_text[27] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text28: 
			if ( token.hasMoreTokens())
			    items_text[28] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text29: 
			if ( token.hasMoreTokens())
			    items_text[29] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text30: 
			if ( token.hasMoreTokens())
			    items_text[30] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_text31: 
			if ( token.hasMoreTokens())
			    items_text[31] = token.nextToken();
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn0: 
			items_dyn[0] = new Dyn(dyn.graph);
			items_dyn[0].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn1: 
			items_dyn[1] = new Dyn(dyn.graph);
			items_dyn[1].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn2:
			items_dyn[2] = new Dyn(dyn.graph);
			items_dyn[2].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn3: 
			items_dyn[3] = new Dyn(dyn.graph);
			items_dyn[3].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn4: 
			items_dyn[4] = new Dyn(dyn.graph);
			items_dyn[4].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn5: 
			items_dyn[5] = new Dyn(dyn.graph);
			items_dyn[5].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn6: 
			items_dyn[6] = new Dyn(dyn.graph);
			items_dyn[6].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn7: 
			items_dyn[7] = new Dyn(dyn.graph);
			items_dyn[7].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn8: 
			items_dyn[8] = new Dyn(dyn.graph);
			items_dyn[8].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn9: 
			items_dyn[9] = new Dyn(dyn.graph);
			items_dyn[9].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn10: 
			items_dyn[10] = new Dyn(dyn.graph);
			items_dyn[10].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn11: 
			items_dyn[11] = new Dyn(dyn.graph);
			items_dyn[11].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn12: 
			items_dyn[12] = new Dyn(dyn.graph);
			items_dyn[12].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn13: 
			items_dyn[13] = new Dyn(dyn.graph);
			items_dyn[13].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn14: 
			items_dyn[14] = new Dyn(dyn.graph);
			items_dyn[14].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn15: 
			items_dyn[15] = new Dyn(dyn.graph);
			items_dyn[15].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn16: 
			items_dyn[16] = new Dyn(dyn.graph);
			items_dyn[16].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn17: 
			items_dyn[17] = new Dyn(dyn.graph);
			items_dyn[17].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn18: 
			items_dyn[18] = new Dyn(dyn.graph);
			items_dyn[18].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn19: 
			items_dyn[19] = new Dyn(dyn.graph);
			items_dyn[19].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn20: 
			items_dyn[20] = new Dyn(dyn.graph);
			items_dyn[20].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn21: 
			items_dyn[21] = new Dyn(dyn.graph);
			items_dyn[21].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn22: 
			items_dyn[22] = new Dyn(dyn.graph);
			items_dyn[22].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn23: 
			items_dyn[23] = new Dyn(dyn.graph);
			items_dyn[23].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn24: 
			items_dyn[24] = new Dyn(dyn.graph);
			items_dyn[24].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn25: 
			items_dyn[25] = new Dyn(dyn.graph);
			items_dyn[25].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn26: 
			items_dyn[26] = new Dyn(dyn.graph);
			items_dyn[26].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn27: 
			items_dyn[27] = new Dyn(dyn.graph);
			items_dyn[27].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn28: 
			items_dyn[28] = new Dyn(dyn.graph);
			items_dyn[28].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn29: 
			items_dyn[29] = new Dyn(dyn.graph);
			items_dyn[29].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn30: 
			items_dyn[30] = new Dyn(dyn.graph);
			items_dyn[30].open(reader);
			break;
		    case Dyn.eSave_PulldownMenu_items_dyn31: 
			items_dyn[31] = new Dyn(dyn.graph);
			items_dyn[31].open(reader);
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynPulldownMenu");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynPulldownMenu");
	    }
	}

    }

    public class DynOptionMenu extends DynElem {
	String attribute;
	String text_attribute;
	String size_attribute;
	String update_attribute;
	int optionmenu_type;
	int button_mask;
	String[] items_text = new String[32];
	int[] items_enum = new int[32];
 	PwrtRefId subid;
	int p;
	int database;
	boolean inverted;
	boolean attrFound = false;
	boolean firstScan = true;
	int bitmask;
	int a_typeid;
        float oldValueF;
	int oldValueI;
 	PwrtRefId update_subid;
	int update_p;
	int update_database;
	boolean update_inverted;
	boolean update_attrFound = false;
	int update_bitmask;
	int update_a_typeid;
        boolean update_oldValue;
	GrowMenu menu_object;
	int text_size;

	public DynOptionMenu( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_OptionMenu, 0, Dyn.eDynPrio_OptionMenu);
	}

	public DynOptionMenu( DynOptionMenu x) {
	    super(x);
	    attribute = x.attribute;
	    text_attribute = x.text_attribute;
	    size_attribute = x.size_attribute;
	    update_attribute = x.update_attribute;
	    items_text = x.items_text;
	    items_enum = x.items_enum;
	    button_mask = x.button_mask;
	    optionmenu_type = x.optionmenu_type;
	}

	public int connect(GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;

	    DynParsedAttrName pname = dyn.parseAttrName(attribute);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    GdhrRefObjectInfo ret = null;

	    switch( pname.database) {
	    case GraphIfc.eDatabase_Gdh:
		ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
		break;
	    case GraphIfc.eDatabase_Local:
		ret = dyn.graph.getLdb().refObjectInfo( graph, pname.name);
		break;
	    default:
		ret = null;
	    }

	    if ( ret == null || ret.evenSts()) {
		System.out.println("OptionMenu: " + attribute);
		return 1;
	    }

	    p = ret.id;
	    subid = ret.refid;
	    inverted = pname.inverted;
	    a_typeid = pname.type;
	    bitmask = pname.bitmask;
	    database = pname.database;
	    attrFound = true;

	    if ( text_attribute != null && !text_attribute.equals("") && 
		 update_attribute != null && !update_attribute.equals("")) {

		pname = dyn.parseAttrName(update_attribute);
		if ( pname != null && !pname.name.equals("")) {
		    ret = null;

		    switch( pname.database) {
		    case GraphIfc.eDatabase_Gdh:
			ret = dyn.graph.getGdh().refObjectInfo( pname.tname);
			break;
		    default:
			ret = null;
		    }

		    if ( ret == null || ret.evenSts()) {
			System.out.println("OptionsMenu: " + update_attribute);
			return 1;
		    }

		    update_p = ret.id;
		    update_subid = ret.refid;
		    update_inverted = pname.inverted;
		    update_a_typeid = pname.type;
		    update_bitmask = pname.bitmask;
		    update_database = pname.database;
		}
	    }
	    return 1;
	}

	public void disconnect() {
	    if ( attrFound && database == GraphIfc.eDatabase_Gdh)
		dyn.graph.getGdh().unrefObjectInfo(subid);
	}

	public void scan( GlowArrayElem o) {
	    GrowNode object = (GrowNode)o;
	    if ( !attrFound)
		return;

	    boolean update_texts = false;
	    if ( update_p != 0) {

		boolean value = dyn.getDig(p, update_a_typeid, update_bitmask, update_database);

		if (update_inverted)
		    value = !value;

		if ( !firstScan) {
		    if ( update_oldValue != value)
			update_texts = true;
		}
		else {
		    firstScan = false;
		    update_texts = false;
		}
		update_oldValue = value;
	    }


	    if ( update_texts) {
	    }

	    int enum_value = 0;
	    switch ( a_typeid) {
	    case Pwr.eType_Float32: {
		float value = dyn.graph.getGdh().getObjectRefInfoFloat( p);
		int i;

		if ( !firstScan) {
		    if ( value == oldValueF) {
			return;
		    }
		}
		else
		    firstScan = false;

		enum_value = (int)( value + 0.5);
		oldValueF = value;

		break;
	    }
	    case Pwr.eType_UInt32:
	    case Pwr.eType_Int32: {
		int value = dyn.graph.getGdh().getObjectRefInfoInt( p);
		int i;

		if ( !firstScan) {
		    if ( value == oldValueI) {
			return;
		    }
		}
		else
		    firstScan = false;

		enum_value = value;
		oldValueI = value;

		break;
	    }
	    default:
		return;
	    }
	    
	    if ( update_p == 0) {
		    boolean found = false;
		    for ( int i = 0; i < 32; i++) {
			if ( items_enum[i] == enum_value) {
			    object.setAnnotation(1, items_text[i]);
			    found = true;
			    break;
			}
		    }
		    if ( !found)
			object.setAnnotation(1, "");
	    }
	    else {
	    }

	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;

	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Click:
		if ( menu_object != null) {
		    // Close, delete this menu
		    System.out.println("Remove menu" + menu_object);
		    dyn.graph.getCtx().remove(menu_object);
		    menu_object = null;
		}
		else {
		    double	ll_x, ll_y, ur_x, ur_y;
		    GlowMenuInfo info = new GlowMenuInfo();

		    if ( update_p == 0) {
			int b_mask = 1;
			for ( int i = 0; i < 32; i++) {
			    if ( (b_mask & button_mask) != 0) {
				info.item[i].occupied = true;
				info.item[i].text = new String(items_text[i]);
	    
				// Check access
				info.item[i].type = Glow.eMenuItem_Button;
			    }
			    else
				info.item[i].occupied = false;
			    b_mask = b_mask << 1;
			}
		    }
		    else {
			for ( int i = 0; i < 32; i++) {
			    if ( i < text_size) {
			        info.item[i].text = new String(items_text[i]);
				info.item[i].type = Glow.eMenuItem_Button;
				info.item[i].occupied = true;
			    }
			    else
				info.item[i].occupied = false;
			}
		    }

		    // Get fillcolor, and textattributes from object
		    int text_drawtype = 4, text_color = Glow.eDrawType_Line, bg_color = Glow.eDrawType_Color32;
		    int tsize = 2;
		    int sts;
		    double scale = 1;
		    int text_font = Glow.eFont_Helvetica;

		    sts = 0; //grow_GetObjectAnnotInfo( object, 1, &tsize, &text_drawtype, &text_color, &bg_color, &scale, &text_font);
		    if ( (sts & 1) == 0) {
			tsize = 2;
			text_drawtype = Glow.eDrawType_TextHelveticaBold;
			text_color = Glow.eDrawType_Line;
			bg_color = Glow.eDrawType_LightGray;
		    }
		    else if ( bg_color == Glow.eDrawType_No || bg_color == Glow.eDrawType_Inherit)
			bg_color = Glow.eDrawType_LightGray;
	
		    GlowGeometry g = object.measure();
		    menu_object = new GrowMenu( dyn.graph.getCtx().cmn, "__Menu", info, g.ll_x, g.ur_y, g.ur_x - g.ll_x,
						Glow.eDrawType_Line, 0, 1, 1, bg_color, tsize,
						text_drawtype, text_color,
						Glow.eDrawType_MediumGray, text_font);
		    menu_object.set_scale( scale, scale, 0, 0, Glow.eScaleType_LowerLeft);
		    System.out.println("Insert menu" + menu_object);
		    dyn.graph.getCtx().insert(menu_object);
		}
		break;
	    case Glow.eEvent_MenuActivated:
		if ( menu_object == null)
		    break;
		if ( e.object == menu_object) {
		    // Set enum value to attribute
      
		    DynParsedAttrName pname = dyn.parseAttrName(attribute);
		    if ( pname == null || pname.name.equals("")) 
			return 1;

		    PwrtStatus sts = null;

		    switch ( pname.database) {
		    case GraphIfc.eDatabase_Gdh:
			switch ( pname.type) {
			case Pwr.eType_Float32: {
			    float value = items_enum[((GlowEventMenu)e).item];
			    sts = dyn.graph.getGdh().setObjectInfo( pname.name, value);
			    break;
			}
			case Pwr.eType_Int32:
			case Pwr.eType_UInt32:
			case Pwr.eType_Int16:
			case Pwr.eType_UInt16:
			case Pwr.eType_Int8:
			case Pwr.eType_UInt8: {
			    int value = items_enum[((GlowEventMenu)e).item];
			    sts = dyn.graph.getGdh().setObjectInfo( pname.name, value);
			    break;
			}
			default: ;
			}
			break;
		    case GraphIfc.eDatabase_Ccm: {
			/* TODO
			pwr_tInt32 value = items_enum[event->menu.item];
			sts = dyn->graph->ccm_set_variable( parsed_name, type_id, &value);
			*/
			break;
		    }
		    default : ;
		    }

		    if ( sts == null || sts.evenSts()) System.out.println("Option menu error: " + pname.name);
		}
		break;
	    case Glow.eEvent_MenuDelete:
		if ( menu_object == null)
		    break;
		if ( e.object == null || e.object == menu_object) {
		    // Delete this menu
		    dyn.graph.getCtx().remove(menu_object);
		    menu_object = null;
		}
		break;
	    default: ;
	    }

	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynOptionMenu : " + line);

		    switch ( key) {
		    case Dyn.eSave_OptionMenu: 
			break;
		    case Dyn.eSave_OptionMenu_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_OptionMenu_text_attribute: 
			if ( token.hasMoreTokens())
			    text_attribute = token.nextToken();
			break;
		    case Dyn.eSave_OptionMenu_size_attribute: 
			if ( token.hasMoreTokens())
			    size_attribute = token.nextToken();
			break;
		    case Dyn.eSave_OptionMenu_update_attribute: 
			if ( token.hasMoreTokens())
			    update_attribute = token.nextToken();
			break;
		    case Dyn.eSave_OptionMenu_optionmenu_type: 
			optionmenu_type = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_button_mask: 
			button_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_text0: 
			if ( token.hasMoreTokens())
			    items_text[0] = token.nextToken();
			break;
		    case Dyn.eSave_OptionMenu_items_text1: 
			if ( token.hasMoreTokens())
			    items_text[1] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text2: 
			if ( token.hasMoreTokens())
			    items_text[2] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text3: 
			if ( token.hasMoreTokens())
			    items_text[3] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text4: 
			if ( token.hasMoreTokens())
			    items_text[4] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text5: 
			if ( token.hasMoreTokens())
			    items_text[5] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text6: 
			if ( token.hasMoreTokens())
			    items_text[6] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text7: 
			if ( token.hasMoreTokens())
			    items_text[7] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text8: 
			if ( token.hasMoreTokens())
			    items_text[8] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text9: 
			if ( token.hasMoreTokens())
			    items_text[9] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text10: 
			if ( token.hasMoreTokens())
			    items_text[10] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text11: 
			if ( token.hasMoreTokens())
			    items_text[11] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text12: 
			if ( token.hasMoreTokens())
			    items_text[12] = token.nextToken();
			break;
		    case Dyn.eSave_OptionMenu_items_text13: 
			if ( token.hasMoreTokens())
			    items_text[13] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text14: 
			if ( token.hasMoreTokens())
			    items_text[14] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text15: 
			if ( token.hasMoreTokens())
			    items_text[15] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text16: 
			if ( token.hasMoreTokens())
			    items_text[16] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text17: 
			if ( token.hasMoreTokens())
			    items_text[17] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text18: 
			if ( token.hasMoreTokens())
			    items_text[18] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text19: 
			if ( token.hasMoreTokens())
			    items_text[19] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text20: 
			if ( token.hasMoreTokens())
			    items_text[20] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text21: 
			if ( token.hasMoreTokens())
			    items_text[21] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text22: 
			if ( token.hasMoreTokens())
			    items_text[22] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text23: 
			if ( token.hasMoreTokens())
			    items_text[23] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text24: 
			if ( token.hasMoreTokens())
			    items_text[24] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text25: 
			if ( token.hasMoreTokens())
			    items_text[25] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text26: 
			if ( token.hasMoreTokens())
			    items_text[26] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text27: 
			if ( token.hasMoreTokens())
			    items_text[27] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text28: 
			if ( token.hasMoreTokens())
			    items_text[28] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text29: 
			if ( token.hasMoreTokens())
			    items_text[29] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text30: 
			if ( token.hasMoreTokens())
			    items_text[30] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_text31: 
			if ( token.hasMoreTokens())
			    items_text[31] = line.substring(5);
			break;
		    case Dyn.eSave_OptionMenu_items_enum0: 
			items_enum[0] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum1: 
			items_enum[1] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum2: 
			items_enum[2] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum3: 
			items_enum[3] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum4: 
			items_enum[4] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum5: 
			items_enum[5] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum6: 
			items_enum[6] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum7: 
			items_enum[7] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum8: 
			items_enum[8] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum9: 
			items_enum[9] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum10: 
			items_enum[10] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum11: 
			items_enum[11] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum12: 
			items_enum[12] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum13: 
			items_enum[13] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum14: 
			items_enum[14] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum15: 
			items_enum[15] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum16: 
			items_enum[16] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum17: 
			items_enum[17] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum18: 
			items_enum[18] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum19: 
			items_enum[19] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum20: 
			items_enum[20] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum21: 
			items_enum[21] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum22: 
			items_enum[22] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum23: 
			items_enum[23] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum24: 
			items_enum[24] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum25: 
			items_enum[25] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum26: 
			items_enum[26] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum27: 
			items_enum[27] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum28: 
			items_enum[28] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum29: 
			items_enum[29] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum30: 
			items_enum[30] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_OptionMenu_items_enum31: 
			items_enum[31] = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynOptionMenu");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynOptionMenu");
	    }
	}

    }

    public class DynAnalogText extends DynOptionMenu {

	public DynAnalogText( Dyn dyn) {
	    super(dyn);
	    dyn_type1 = Dyn.mDynType1_AnalogText; 
	    prio = Dyn.eDynPrio_AnalogText;
	}

	public DynAnalogText( DynAnalogText x) {
	    super(x);
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynAnalogText : " + line);

		    switch ( key) {
		    case Dyn.eSave_AnalogText: 
			break;
		    case Dyn.eSave_AnalogText_super: 
			super.open(reader);
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynAnalogText");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynAnalogText");
	    }
	}

    }

    public class DynSetValue extends DynElem {
	String attribute;
	String value;

	public DynSetValue( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_SetValue, 0, Dyn.eDynPrio_SetValue);
	}

	public DynSetValue( DynSetValue x) {
	    super(x);
	    attribute = x.attribute;
	    value = x.value;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynSetValue : " + line);

		    switch ( key) {
		    case Dyn.eSave_SetValue: 
			break;
		    case Dyn.eSave_SetValue_attribute: 
			if ( token.hasMoreTokens())
			    attribute = token.nextToken();
			break;
		    case Dyn.eSave_SetValue_value: 
			if ( token.hasMoreTokens())
			    value = token.nextToken();
			break;
		    case Dyn.eSave_SetValue_instance: 
			instance = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_SetValue_instance_mask: 
			instance_mask = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynSetValue");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynSetValue");
	    }
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;

	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		break;
	    case Glow.eEvent_MB1Click: {
		PwrtStatus sts = null;
		
		try {

		    if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
			break;
		
		    DynParsedAttrName pname = dyn.parseAttrName(attribute);
		
		    switch ( pname.type) {
		    case Pwr.eType_Float32: {
			float inputValue = Float.parseFloat( value.trim());
		    
			switch ( pname.database) {
			case GraphIfc.eDatabase_Gdh:
			    sts = dyn.graph.getGdh().setObjectInfo( pname.name, inputValue);
			    break;
			case GraphIfc.eDatabase_Local:
			    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, inputValue);
			    break;
			default: 
			    return 0;
			}
			if ( sts.evenSts()) {			
			    System.out.println( "setObjectInfoError " + sts);
			    return 0;
			}
			break;
		    }
		    case Pwr.eType_Int32:
		    case Pwr.eType_UInt32:
		    case Pwr.eType_Int16:
		    case Pwr.eType_UInt16:
		    case Pwr.eType_Int8:
		    case Pwr.eType_UInt8: {
			int inputValue = Integer.parseInt( value.trim(), 10);
		    
			switch ( pname.database) {
			case GraphIfc.eDatabase_Gdh:
			    sts = dyn.graph.getGdh().setObjectInfo( pname.name, inputValue);
			    break;
			case GraphIfc.eDatabase_Local:
			    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, inputValue);
			    break;
			default: 
			    return 0;
			}
			if ( sts.evenSts()) {
			    System.out.println( "setObjectInfoError " + sts);
			    return 0;
			}		
			break;
		    }
		    case Pwr.eType_Boolean: {
			int inputValueInt = Integer.parseInt( value.trim(), 10);
			boolean inputValue;
			if ( inputValueInt == 0)
			    inputValue = false;
			else if ( inputValueInt == 1)
			    inputValue = true;
			else
			    break;
		    
			switch ( pname.database) {
			case GraphIfc.eDatabase_Gdh:
			    sts = dyn.graph.getGdh().setObjectInfo( pname.name, inputValue);
			    break;
			case GraphIfc.eDatabase_Local:
			    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, inputValue);
			    break;
			default:
			    return 0;
			}
			if ( sts.evenSts()) {
			    System.out.println( "setObjectInfoError " + sts);
			    return 0;
			}
			break;
		    }
		    case Pwr.eType_String: {
			switch ( pname.database) {
			case GraphIfc.eDatabase_Gdh:
			    sts = dyn.graph.getGdh().setObjectInfo( pname.name, value);
			    break;
			case GraphIfc.eDatabase_Local:
			    sts = dyn.graph.getLdb().setObjectInfo( graph, pname.name, value);
			    break;
			default:
			    return 0;
			}
			if ( sts.evenSts()) {
			    System.out.println( "setObjectInfoError " + sts);
			    return 0;
			}
			break;
		    }		    
		    default:
			;
		    }
		}
		catch(NumberFormatException ex) {
		    System.out.println( ex.toString() );
		    return 0;
		}	    
	       
		break;
	    }
	    default:
		return 0;
	    }
	    return 1;
	}
    }

    public static final int method_toolbar_op_cnt = 12;
    public static final int method_toolbar_op_helpmask = 1 << 8;
    public final String[] method_toolbar_op_subgraph = {
	"pwr_mb2opengraph",
	"pwr_mb2openobjectgraph",
	"pwr_mb2trend",
	"pwr_mb2history",
	"pwr_mb2fast",
	"pwr_mb2camera",
	"pwr_mb2histevent",
	"pwr_mb2blockevents",
	"pwr_mb2help",
	"pwr_mb2photo",
	"pwr_mb2note",
	"pwr_mb2parentgraph",
    };

    public static final int method_toolbar_mnt_cnt = 32;
    public static final int method_toolbar_mnt_helpmask = 1 << 4;
    public static  final String[] method_toolbar_mnt_subgraph = {
	"pwr_mb2openobject",
	"pwr_mb2openplc",
	"pwr_mb2rtnavigator",
	"pwr_mb2crossreferences",
	"pwr_mb2helpclass",
	"pwr_mb2datasheet",
	"pwr_mb2circuitdiagram",
	"", "","","","","","","","","","","","","","","","","","","","","","","",
	"pwr_mb2simulate"
    };

    public static final String[] method_toolbar_op_methods = {
	"Graph", 
	"Object Graph",
	"Trend",
	"History",
	"Fast", 
	"Camera",
	"Event Log...",
	"Block Events...", 
	"Help",
	"Photo", 
	"Note",
	"Parent Object Graph",};
  
    public static final String[] method_toolbar_mnt_methods = {
	"Open Object",
	"Open Plc",
	"RtNavigator", 
	"Crossreferences", 
	"Help Class", 
	"DataSheet", 
	"CircuitDiagram", 
	"","","","","","","","","","","","","","","","","","","","","","","","",
	"Simulate"};

    public static final String[] method_toolbar_op_tooltip = {
	"Graph", 
	"Object graph",
	"Trend", 
	"History", 
	"Fast curve", 
	"Camera", 
	"Event log", 
	"Block events", 
	"Help", 
	"Photo", 
	"Note",
	"Open parent object graph",   
    };

    public static final String[] method_toolbar_mnt_tooltip = {
	"Open object",
	"Open plc",
	"Navigator", 
	"CrossReferences", 
	"Help class", 
	"Datasheet",
	"CircuitDiagram", 
	"", "","","","","","","","","","","","","","","","","","","","","","","",
	"Simulate"};


    public class DynMethodToolbar extends DynElem {
	String method_object;
	int toolbar_type;

	public DynMethodToolbar( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_MethodToolbar, 0, Dyn.eDynPrio_MethodToolbar);
	}

	public DynMethodToolbar( DynMethodToolbar x) {
	    super(x);
	    method_object = x.method_object;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynMethodToolbar : " + line);

		    switch ( key) {
		    case Dyn.eSave_MethodToolbar: 
			break;
		    case Dyn.eSave_MethodToolbar_method_object: 
			if ( token.hasMoreTokens())
			    method_object = token.nextToken();
			break;
		    case Dyn.eSave_MethodToolbar_toolbar_type: 
			toolbar_type = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynMethodToolbar");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynMethodToolbar");
	    }
	}

	public int connect(GlowArrayElem o) {
	    GrowToolbar object = (GrowToolbar)o;

	    int      	sts;
	    String     	cmd, command;
	    String    	parsed_name;
	    int 	xm_mask_flags = 0;
	    int		xm_mask_opmethods = 0;
	    int		xm_mask_mntmethods = 0;
	    int       	mask_configure = 0;
	    int	        mask_store = 0;
    
	    DynParsedAttrName pname = dyn.parseAttrName(method_object);
	    if ( pname == null || pname.name.equals("")) 
		return 1;

	    parsed_name = pname.name + ".XttMethodsMask.Flags";
	    CdhrInt ret = dyn.graph.getGdh().getObjectInfoInt( parsed_name);
	    if ( ret.oddSts()) {
		xm_mask_flags = ret.value;

		if ( (xm_mask_flags & Pwrb.mXttMethodsFlagsMask_IsConfigured) == 0) {		    
		    mask_configure = 1;
		    mask_store = 1;
		}      
		else {
		    parsed_name = pname.name + ".XttMethodsMask.OpMethods";
		    ret = dyn.graph.getGdh().getObjectInfoInt( parsed_name);
		    if ( ret.evenSts()) {
			System.out.println("DynMethodToolbar: " + parsed_name);
			mask_configure = 1;
		    }
		    else
			xm_mask_opmethods = ret.value;
		    parsed_name = pname.name + ".XttMethodsMask.MntMethods";
		    ret = dyn.graph.getGdh().getObjectInfoInt( parsed_name);
		    if ( ret.evenSts()) {
			System.out.println("DynMethodToolbar: " + parsed_name);
			mask_configure = 1;
		    }
		    else
			xm_mask_mntmethods = ret.value;
		}
	    }
	    else {
		mask_configure = 1;
	    }
  

	    if ( mask_configure != 0) {
		xm_mask_opmethods = 0;
		for ( int i = 0; i < method_toolbar_op_cnt; i++) {
		    if ( method_toolbar_op_methods[i].equals("Parent Object Graph")) {
			if ( method_object.indexOf('.') != -1)
			    xm_mask_opmethods |= 1 << i;
		    }
		    else {
			command = "check method/method=\"" + method_toolbar_op_methods[i] + "\"/object=" +
			    method_object;

			command = dyn.graph.getCommand(command);
			sts = dyn.graph.command(command);
			if ( (sts & 1) != 0)
			    xm_mask_opmethods |= 1 << i;
		    }
		}
		xm_mask_mntmethods = 0;
		for ( int i = 0; i < method_toolbar_mnt_cnt; i++) {
		    command = "check method/method=\"" + method_toolbar_mnt_methods[i] + "\"/object=" +
			method_object;
	
		    command = dyn.graph.getCommand(command);
		    sts = dyn.graph.command(command);
		    if ( (sts & 1) != 0)
			xm_mask_mntmethods |= 1 << i;
		}
		xm_mask_flags |= Pwrb.mXttMethodsFlagsMask_IsConfigured;
	    }
	    System.out.println("Method mask: " + xm_mask_opmethods + " " + xm_mask_mntmethods);

	    int opmask = xm_mask_opmethods;
	    int mntmask = xm_mask_mntmethods;
	    int insensitive_opmask = 0;
	    int insensitive_mntmask = 0;

	    opmask &= ~Pwrb.mXttOpMethodsMask_OpenObjectGraph;
	    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtEventsBlock | Pwr.mAccess_System))
		insensitive_opmask |= Pwrb.mXttOpMethodsMask_BlockEvents;
	    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtNavigator | Pwr.mAccess_System | Pwr.mAccess_RtWrite | 
					  Pwr.mAccess_Maintenance | Pwr.mAccess_Process | Pwr.mAccess_Instrument))
		insensitive_opmask |= Pwrb.mXttOpMethodsMask_Note;
	    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtNavigator | Pwr.mAccess_System))
		insensitive_mntmask |= Pwrb.mXttMntMethodsMask_RtNavigator;
	    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtPlc | Pwr.mAccess_System))
		insensitive_mntmask |= Pwrb.mXttMntMethodsMask_OpenTrace;  

	    if ( toolbar_type == eMethodToolbarType_Simulate)
		opmask = 0;

	    object.configure( method_toolbar_op_subgraph, method_toolbar_mnt_subgraph,
			      method_toolbar_op_cnt, method_toolbar_mnt_cnt, opmask, mntmask,
			      insensitive_opmask, insensitive_mntmask);

	    mask_store = 0; // Check call is not universal
	    if ( mask_store != 0) {
		PwrtStatus psts;

		parsed_name = pname.name + ".XttMethodsMask.OpMethods";
		psts = dyn.graph.getGdh().setObjectInfo( parsed_name, xm_mask_opmethods);
		if ( psts.evenSts())
		    System.out.println( "Set mask error " + parsed_name);

		parsed_name = pname.name + ".XttMethodsMask.MntMethods";
		psts = dyn.graph.getGdh().setObjectInfo( parsed_name, xm_mask_mntmethods);
		if ( psts.evenSts())
		    System.out.println( "Set mask error " + parsed_name);

		parsed_name = pname.name + ".XttMethodsMask.Flags";
		psts = dyn.graph.getGdh().setObjectInfo( parsed_name, xm_mask_flags);
		if ( psts.evenSts())
		    System.out.println( "Set mask error " + parsed_name);

	    }

	    return 1;
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    GrowNode object = (GrowNode)o;

	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		break;
	    case Glow.eEvent_MB1Click: {
		int sts;
		String command;
		int idx = ((GlowEventToolbar)e).idx;
		int category = ((GlowEventToolbar)e).category;
		System.out.println( "Toolbar action " + category + " " + idx);

		if ( category == 1) {
		    if ( method_toolbar_op_methods[idx].equals( "Parent Object Graph"))
			command = "open graph/class/parent/instance=" + method_object;
		    else
			command = "call method/method=\"" + method_toolbar_op_methods[idx] + 
			    "\"/object=" +  method_object;
		}
		else {
		    command = "call method/method=\"" + method_toolbar_mnt_methods[idx] + 
			"\"/object=" +  method_object;
		}

		command = dyn.graph.getCommand(command);
		sts = dyn.graph.command(command);
		
		break;
	    }
	    default:
		return 0;
	    }
	    return 1;
	}
    }


    public class DynMethodPulldownMenu extends DynElem {
	String method_object;
	int menu_type;
	int opmask;
	int mntmask;
	GrowMenu menu_object;
	int text_size;

	public DynMethodPulldownMenu( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_MethodPulldownMenu, 0, Dyn.eDynPrio_MethodPulldownMenu);
	}

	public DynMethodPulldownMenu( DynMethodPulldownMenu x) {
	    super(x);
	    method_object = x.method_object;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynMethodPulldownMenu : " + line);

		    switch ( key) {
		    case Dyn.eSave_MethodPulldownMenu: 
			break;
		    case Dyn.eSave_MethodPulldownMenu_method_object: 
			if ( token.hasMoreTokens())
			    method_object = token.nextToken();
			break;
		    case Dyn.eSave_MethodPulldownMenu_menu_type: 
			menu_type = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynMethodPulldownMenu");
			break;
		    }

		    if ( end_found)
			break;
		}
		
	    } catch ( Exception e) {
		System.out.println( "IOException DynMethodPulldownMenu");
	    }
	}

	public int action( GlowArrayElem o, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    GrowNode object = (GrowNode)o;
	    switch ( e.event) {
	    case Glow.eEvent_MB1Click:
		if ( menu_object != null) {
		    // Close, delete this menu
		    dyn.graph.getCtx().remove(menu_object);
		    menu_object = null;
		}
		else if ( object != null) {
		    double	ll_x, ll_y, ur_x, ur_y;
		    GlowMenuInfo info = new GlowMenuInfo();

		    int 		sts;
		    String 		command;
		    String         	parsed_name;
		    int 	       	mask_configure = 0;
		    int		        mask_store = 0;
		    int			xm_mask_flags = 0;
		    int			xm_mask_opmethods = 0;
		    int			xm_mask_mntmethods = 0;
    
		    DynParsedAttrName pname = dyn.parseAttrName(method_object);
		    if ( pname == null || pname.name.equals("")) 
			return 1;

		    parsed_name = pname.name + ".XttMethodsMask.Flags";
		    CdhrInt ret = dyn.graph.getGdh().getObjectInfoInt( parsed_name);
		    if ( ret.oddSts()) {
			xm_mask_flags = ret.value;

			if ( (xm_mask_flags & Pwrb.mXttMethodsFlagsMask_IsConfigured) == 0) {		    
			    mask_configure = 1;
			    mask_store = 1;
			}      
			else {
			    parsed_name = pname.name + ".XttMethodsMask.OpMethods";
			    ret = dyn.graph.getGdh().getObjectInfoInt( parsed_name);
			    if ( ret.evenSts()) {
				System.out.println("DynMethodToolbar: " + parsed_name);
				mask_configure = 1;
			    }
			    else
				xm_mask_opmethods = ret.value;
			    parsed_name = pname.name + ".XttMethodsMask.MntMethods";
			    ret = dyn.graph.getGdh().getObjectInfoInt( parsed_name);
			    if ( ret.evenSts()) {
				System.out.println("DynMethodToolbar: " + parsed_name);
				mask_configure = 1;
			    }
			    else
				xm_mask_mntmethods = ret.value;
			}
		    }
		    else {
			mask_configure = 1;
		    }
  

		    if ( mask_configure != 0) {
			xm_mask_opmethods = 0;
			for ( int i = 0; i < Dyn.method_toolbar_op_cnt; i++) {
			    if ( Dyn.method_toolbar_op_methods[i].equals("Parent Object Graph")) {
				if ( method_object.indexOf('.') != -1)
				    xm_mask_opmethods |= 1 << i;
			    }
			    else {
				command = "check method/method=\"" + Dyn.method_toolbar_op_methods[i] + "\"/object=" +
				    method_object;

				command = dyn.graph.getCommand(command);
				sts = dyn.graph.command(command);
				if ( (sts & 1) != 0)
				    xm_mask_opmethods |= 1 << i;
			    }
			}
			xm_mask_mntmethods = 0;
			for ( int i = 0; i < Dyn.method_toolbar_mnt_cnt; i++) {
			    command = "check method/method=\"" + Dyn.method_toolbar_mnt_methods[i] + "\"/object=" +
				method_object;
	
			    command = dyn.graph.getCommand(command);
			    sts = dyn.graph.command(command);
			    if ( (sts & 1) != 0)
				xm_mask_mntmethods |= 1 << i;
			}
			xm_mask_flags |= Pwrb.mXttMethodsFlagsMask_IsConfigured;
		    }

		    opmask = xm_mask_opmethods;
		    mntmask = xm_mask_mntmethods;
		    int insensitive_opmask = 0;
		    int insensitive_mntmask = 0;

		    opmask &= ~Pwrb.mXttOpMethodsMask_OpenObjectGraph;
		    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtEventsBlock | Pwr.mAccess_System))
			insensitive_opmask |= Pwrb.mXttOpMethodsMask_BlockEvents;
		    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtNavigator | Pwr.mAccess_System | Pwr.mAccess_RtWrite | 
						  Pwr.mAccess_Maintenance | Pwr.mAccess_Process | Pwr.mAccess_Instrument))
			insensitive_opmask |= Pwrb.mXttOpMethodsMask_Note;
		    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtNavigator | Pwr.mAccess_System))
			insensitive_mntmask |= Pwrb.mXttMntMethodsMask_RtNavigator;
		    if ( !dyn.graph.isAuthorized( Pwr.mAccess_RtPlc | Pwr.mAccess_System))
			insensitive_mntmask |= Pwrb.mXttMntMethodsMask_OpenTrace;    


		    int menu_idx = 0;
		    for ( int i = 0; i < 32; i++)
			info.item[i].occupied = false;

		    for ( int i = 0; i < Dyn.method_toolbar_op_cnt; i++) {
			if ( menu_idx >= 32)
			    break;

			if ( menu_type == eMethodsMenuType_Help && (Dyn.method_toolbar_op_helpmask & (1 << i)) == 0)
			    continue;
			if ( menu_type == eMethodsMenuType_Simulate)
			    continue;
  
			if ( (opmask & (1 << i)) != 0) {
			    info.item[menu_idx].type = Glow.eMenuItem_Button;
			    info.item[menu_idx].text = new String(Dyn.method_toolbar_op_methods[i]);
			    info.item[menu_idx].occupied = true;
			    if ( (insensitive_opmask & (1 << i)) != 0)
				info.item[menu_idx].type = Glow.eMenuItem_ButtonDisabled;
			    menu_idx++;
			}
		    }
		    for ( int i = 0; i < Dyn.method_toolbar_mnt_cnt; i++) {
			if ( menu_idx >= 32)
			    break;

			if ( menu_type == eMethodsMenuType_Help && (Dyn.method_toolbar_mnt_helpmask & (1 << i)) == 0)
			    continue;

			if ( (mntmask & (1 << i)) != 0) {
			    info.item[menu_idx].type = Glow.eMenuItem_Button;
			    info.item[menu_idx].text = new String(Dyn.method_toolbar_mnt_methods[i]);
			    info.item[menu_idx].occupied = true;
			    if ( (insensitive_mntmask & (1 << i)) != 0)
				info.item[menu_idx].type = Glow.eMenuItem_ButtonDisabled;
			    menu_idx++;
			}
		    }

		    // Get fillcolor, and textattributes from object
		    int text_drawtype = 0, text_color = 0, bg_color = 0;
		    int text_size = 0;
		    double scale = 1;
		    int text_font = 0;
		    
		    sts = 0; // TODO sts = grow_GetObjectAnnotInfo( object, 1, &text_size, &text_drawtype, &text_color, &bg_color, &scale, &text_font);
		    if ( (sts & 1) == 0) {
			text_size = 3;
			text_drawtype = Glow.eDrawType_TextHelvetica;
			text_font = Glow.eFont_LucidaSans;
			text_color = Glow.eDrawType_Line;
			bg_color = Glow.eDrawType_LightGray;
		    }
		    else if ( bg_color == Glow.eDrawType_No || bg_color == Glow.eDrawType_Inherit)
			bg_color = Glow.eDrawType_LightGray;
		    
		    GlowGeometry g = object.measure();
		    menu_object = new GrowMenu( dyn.graph.getCtx().cmn, "__Menu", info, g.ll_x, g.ur_y, g.ur_x - g.ll_x,
						Glow.eDrawType_Line, 0, 1, 1, bg_color, text_size,
						text_drawtype, text_color,
						Glow.eDrawType_MediumGray, text_font);
		    menu_object.set_scale( scale, scale, 0, 0, Glow.eScaleType_LowerLeft);
		    dyn.graph.getCtx().insert(menu_object);

		    // grow_SetMenuInputFocus( menu_object, 1);
		}

		break;
	    case Glow.eEvent_MenuActivated:
		if ( menu_object == null)
		    break;
		if ( e.object == menu_object) {
      
		    int sts;
		    String command;
		    int idx = 0;
		    int found = 0;

		    for ( int i = 0; i < Dyn.method_toolbar_op_cnt; i++) {
			if ( menu_type != eMethodsMenuType_Help && (Dyn.method_toolbar_op_helpmask & (1 << i)) == 0)
			    continue;
			if ( menu_type != eMethodsMenuType_Simulate)
			    continue;

			if ( (opmask & (1 << i)) != 0)
			    idx++;
			if ( ((GlowEventMenu)e).item + 1 == idx) {
			    command = "call method/method=\"" + Dyn.method_toolbar_op_methods[i] +
				     "\"/object=" + method_object;
			    command = dyn.graph.getCommand(command);
			    sts = dyn.graph.command(command);
			    found = 1;
			    break;
			}
		    }

		    if ( found == 0) {
			for ( int i = 0; i < Dyn.method_toolbar_mnt_cnt; i++) {
			    if ( menu_type == eMethodsMenuType_Help && (Dyn.method_toolbar_mnt_helpmask & (1 << i)) == 0)
				continue;

			    if ( (mntmask & (1 << i)) != 0)
				idx++;
			    if ( ((GlowEventMenu)e).item + 1 == idx) {
				command = "call method/method=\"" + Dyn.method_toolbar_mnt_methods[i] +
				    "\"/object=" + method_object;
				command = dyn.graph.getCommand(command);
				sts = dyn.graph.command(command);
				found = 1;
				break;
			    }
			}
		    }
		}
		break;
	    case Glow.eEvent_MenuDelete:
		if ( menu_object == null)
		    break;
		if ( e.object == null || e.object == menu_object) {
		    // Delete this menu
		    dyn.graph.getCtx().remove(menu_object);
		    menu_object = null;
		}
		break;

	    default: ;
	    }
	    return 1;
	}

    }

    public class DynCatchSignal extends DynElem {
	String signal_name;

	public DynCatchSignal( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_CatchSignal, 0, Dyn.eDynPrio_CatchSignal);
	}

	public DynCatchSignal( DynCatchSignal x) {
	    super(x);
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_Signal:
		if ( signal_name.equals( ((GlowEventSignal)e).signal_name)) {
		    GlowEvent ce = new GlowEvent();
		    ce.event = Glow.eEvent_MB1Click;
		    dyn.action( object, ce);		    
		}
		break;
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynCatchSignal : " + line);

		    switch ( key) {
		    case Dyn.eSave_CatchSignal: 
			break;
		    case Dyn.eSave_CatchSignal_signal_name: 
			if ( token.hasMoreTokens())
			    signal_name = token.nextToken();
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynCatchSignal");
			break;
		    }

		    if ( end_found)
			break;
		}		
	    } catch ( Exception e) {
		System.out.println( "IOException DynCatchSignal");
	    }
	}

    }


    public class DynEmitSignal extends DynElem {
	String signal_name;
	int global;

	public DynEmitSignal( Dyn dyn) {
	    super(dyn, 0, 0, Dyn.mActionType1_EmitSignal, 0, Dyn.eDynPrio_EmitSignal);
	}

	public DynEmitSignal( DynEmitSignal x) {
	    super(x);
	}

	public int action( GlowArrayElem object, GlowEvent e) {
	    if ( !dyn.graph.isAuthorized( dyn.access))
		return 1;

	    switch ( e.event) {
	    case Glow.eEvent_MB1Down:
		object.setColorInverse( 1);
		dyn.repaintNow = true;
		dyn.graph.setClickActive(1);
		break;
	    case Glow.eEvent_MB1Up:
		object.setColorInverse( 0);
		dyn.repaintNow = true;
		dyn.graph.setClickActive( 0);
		break;
	    case Glow.eEvent_MB1Click:
		if ( (dyn.action_type1 & Dyn.mActionType1_Confirm) != 0)
		    break;

		if ( global != 0) {
		    int sts;	    
		    String command = "emit signal /signalname=" + signal_name;
		    command = dyn.graph.getCommand(command);
		    sts = dyn.graph.command(command);
		}
		else
		    dyn.graph.signalSend(signal_name);
	    }
	    return 1;
	}

	public void open( BufferedReader reader) {
	    String line;
	    StringTokenizer token;
	    boolean end_found = false;

	    try {
		while( (line = reader.readLine()) != null) {
		    token = new StringTokenizer(line);
		    int key = Integer.valueOf(token.nextToken());
		    if ( Dyn.debug) System.out.println( "DynEmitSignal : " + line);

		    switch ( key) {
		    case Dyn.eSave_EmitSignal: 
			break;
		    case Dyn.eSave_EmitSignal_signal_name: 
			if ( token.hasMoreTokens())
			    signal_name = token.nextToken();
			break;
		    case Dyn.eSave_EmitSignal_global: 
			global = Integer.valueOf(token.nextToken());
			break;
		    case Dyn.eSave_End:
			end_found = true;
			break;
		    default:
			System.out.println( "Syntax error in DynEmitSignal");
			break;
		    }

		    if ( end_found)
			break;
		}		
	    } catch ( Exception e) {
		System.out.println( "IOException DynEmitSignal");
	    }
	}

    }


}
